trials=10;
testpair=7;
tau=5;
regpar=10;

tcut_vec=1:0.5:2.5;
T2=1.5;
dmp=exp(-2*(tcut_vec+0.4)/T2);
dmp=dmp/dmp(1);
noiselev0=0.005;

rmean_vs_tcut=zeros(1,length(tcut_vec));
sigr_vs_tcut=zeros(1,length(tcut_vec));
rmsd_vs_tcut=zeros(1,length(tcut_vec));
rmean_sdev_vs_tcut=zeros(1,length(tcut_vec));
sigr_sdev_vs_tcut=zeros(1,length(tcut_vec));

for k=1:length(tcut_vec),
    tcut=tcut_vec(k);
    rmean_vec=zeros(1,trials);
    sigr_vec=zeros(1,trials);
    regpar_vec=zeros(1,trials);
    rmsd_vec=zeros(1,trials);
    noiselev=noiselev0/dmp(k);
    for kk=1:trials,
        [min_rmsd,regpar,rmean,sigr,rmean_found,sigr_found,ff,ff1,best_sim,deer,bckg]=reanalyze_DEER(testpair,noiselev,tcut,tau,regpar);
        rmean_vec(kk)=rmean_found;
        sigr_vec(kk)=sigr_found;
        rmsd_vec(kk)=min_rmsd;
    end;
    rmean_vs_tcut(k)=mean(rmean_vec);
    rmean_sdev_vs_tcut(k)=std(rmean_vec);
    sigr_vs_tcut(k)=mean(sigr_vec);
    sigr_sdev_vs_tcut(k)=std(sigr_vec);
    rmsd_vs_tcut(k)=sqrt(sum(rmsd_vec.^2)/length(rmsd_vec));
end;

figure(1); clf;
