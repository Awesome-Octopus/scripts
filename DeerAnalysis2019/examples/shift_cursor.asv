function v=shift_cursor(handles,hObject,vmin,vmax,fstr,increment),
% Shifts a cursor by increment
% with check whether value stays in proper range (vmin,vmax) format string fstr for sprintf
% determines appearance in associated edit f
% if intgflag=1, value is an integer and is rounded
% the corrected value is the output parameter
%

set(handles.status_line,'String','Value edited.');
set(handles.status_line,'ForegroundColor','b');
v=str2double(get(hObject,'String'));
if intgflag, v=round(v); end;
% Protect against wrong inputs
if isnan(v),
    v=vdef;
    set(handles.status_line,'String','### Not a number. Resetting to default value. ###');
    set(handles.status_line,'ForegroundColor','r');
end;
if v<vmin, 
    v=vmin;
    set(handles.status_line,'String','### Smaller than lower limit. Resetting to default value. ###');
    set(handles.status_line,'ForegroundColor','r');
end;
if v>vmax, 
    v=vmax;
    set(handles.status_line,'String','### Larger than upper limit. Resetting to default value. ###');
    set(handles.status_line,'ForegroundColor','r');
end;
pstr=sprintf(fstr,v);
set(hObject,'String',pstr);
% Update handles structure
guidata(hObject, handles);
