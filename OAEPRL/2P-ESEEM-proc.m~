clear all
[b spec params] = eprload()
[shift ns] = strread(params.FTEzDelay1,'%f %s');
b = (b' + shift);
spec = real(spec'/max(spec));
[x,fval] = fminsearch(@t2decay,[max(spec)/2,max(b)/4],[],b,spec,params);
exponfit = x(1)*exp(-b/x(2));
sub = spec-exponfit;
[inc ns] = strread(params.FTEzDeltaX,'%f %s');
xf = fdaxis(inc*0.000001,params.XPTS*2);
ft = ctafft(sub,params.XPTS-1,params.XPTS*2);
subplot(2,1,1)
plot(b,sub)
subplot(2,1,2)
plot(xf,ft)
axis(0 max(xf) 0 max(ft)*1.2)
