function tm = t2fit-2(name)
[b spec params] = eprload(name);
[b] = real(b);
[spec] = real(spec);
[shift ns] = strread(params.FTEzDelay1,'%f %s');
b = b + shift;
b = b';
spec = spec';
[x,fval] = fminsearch(@t2decay-2,[max(spec)/2,max(b)/4,max(spec)/2,max(b)/4],[],name);
xfit = linspace(min(b),max(b),params.XPTS);
yfit = x(1)*exp(-(1/x(2)).*xfit);

xrounda = round(x(2))
xroundb = round(x(4))
tmlabela = sprintf('T2a = %i ns',xrounda);
tmlabelb = sprintf('T2b = %i ns',xroundb);

plot(b,spec,xfit,yfit);
xlabel('time(ns))','FontSize',18), ylabel('intensity','FontSize',18);
title('T2 Determination','FontSize',20);
text(x(2)+100,max(spec)*0.8,tmlabela,'FontSize',18)
text(x(4)+100,max(spec)*0.9,tmlabelb,'FontSize',18)
line([x(2);x(2)],[0;max(spec)],'Color','r','LineWidth',2);
line([x(4);x(4)],[0;max(spec)],'Color','r','LineWidth',2);