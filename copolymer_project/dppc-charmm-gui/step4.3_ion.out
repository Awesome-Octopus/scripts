1
                 Chemistry at HARvard Macromolecular Mechanics
           (CHARMM) - Developmental Version 47a2   February 15, 2021            
                                Revision unknown                                
       Copyright(c) 1984-2020  President and Fellows of Harvard College
                              All Rights Reserved
      Current operating system: Linux-3.10.0-1160.80.1.el7.x86_64(x86_64)       
                 Created on  8/4/24 at  1:39:06 by user: apache      

            Maximum number of ATOMS:    360720, and RESidues:      120240
 RDTITL> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON AUG, 04. 2024. JOBID=2274976975
 RDTITL> * GENERATES ION CONFORMATION USING MONTE-CARLO SIMULATION
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    DIMENS CHSIZE 5000000 MAXRES 3000000
Size      Original         New
MAXA        360720     5000000
MAXB        360720     5000000
MAXT        721440    10000000
MAXP       1082160    15000000
MAXIMP      180360     2500000
MAXNB        90180     1250000
MAXPAD      360720     5000000
MAXRES      120240     3000000
MAXSEG       45090      625000
MAXATC        1400
MAXCB         3000
MAXCT        50000
MAXCP        50000
MAXCI         1200
MAXCH         6400
MAXCN       502503
MAXCRT      120240     1666666
  
 CHARMM>     
  
 CHARMM>    ! Read topology and parameter files
 CHARMM>    stream martini_toppar.str
 VOPEN> Attempting to open::martini_toppar.str::
 OPNLGU> Unit 99 opened for READONLY access to martini_toppar.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON AUG, 04. 2024. JOBID=2274976975
 RDTITL> * MARTINI FF
 RDTITL> * MARTINI22
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    open read card unit 10 name toppar/martini_v2.0_lipids_all_201506.rtf
 VOPEN> Attempting to open::toppar/martini_v2.0_lipids_all_201506.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/martini_v2.0_lipids_all_201506.rtf
  
 CHARMM>    read  rtf card unit 10
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *MARTINI FF PARAMETER IN CHARMM FORMAT
 TITLE> 36   1
  
 CHARMM>     
  
 CHARMM>    open read card unit 10 name toppar/martini_v2.0_ions.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/martini_v2.0_ions.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/martini_v2.0_ions.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *MARTINI FF PARAMETER IN CHARMM FORMAT
 TITLE> 36   1
  
 CHARMM>     
  
 CHARMM>    open read card unit 10 name toppar/martini_v2.2_aminoacids.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/martini_v2.2_aminoacids.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/martini_v2.2_aminoacids.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *MARTINI FF PARAMETER IN CHARMM FORMAT
 TITLE> 36   1
  
 CHARMM>     
  
 CHARMM>    open read card unit 10 name toppar/martini_v2.2_aminoacids.patch
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/martini_v2.2_aminoacids.patch::
 OPNLGU> Unit 10 opened for READONLY access to toppar/martini_v2.2_aminoacids.patch
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *MARTINI FF PARAMETER IN CHARMM FORMAT
 TITLE> 36   1
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/martini_v2.2.prm
 VOPEN> Attempting to open::toppar/martini_v2.2.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/martini_v2.2.prm
  
 CHARMM>    read para card unit 20 flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> *MARTINI FF PARAMETER IN CHARMM FORMAT
 TITLE> *
 PARRDR> Error: Repeated BOND parameter (     2): NA    C1   is replaced
 PARRDR> Error: Repeated BOND parameter (     6): C1    C1   is replaced
 PARRDR> Error: Repeated BOND parameter (     9): C3    C1   is replaced
 PARRDR> Error: Repeated BOND parameter (    29): QA    Q0   is replaced
*****  WARNING  ***** PARRDR no nonbond parameters for atom type: 115  DUM 
 NO nonbond interactions will be computed for this atom type.
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/martini_v2.2_aminoacids.auto.cons.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   20 with status "KEEP"
 VOPEN> Attempting to open::toppar/martini_v2.2_aminoacids.auto.cons.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/martini_v2.2_aminoacids.auto.cons.prm
  
 CHARMM>    read para card unit 20 append flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> *MARTINI FF PARAMETER IN CHARMM FORMAT
 TITLE> *
 PARRDR> Error: Repeated ANGLE parameter (     4): C1    C3    C1   is replaced
 PARRDR> Error: Repeated ANGLE parameter (     6): C3    C1    C1   is replaced
PARRDR> **** NEGATIVE ANGLE MINIMA FOUND!
GROMACS style angle energy function used for angles with negative minima.
*****  WARNING  ***** PARRDR no nonbond parameters for atom type: 115  DUM 
 NO nonbond interactions will be computed for this atom type.
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>     
  
 CHARMM>    define PROT sele none end
 SELRPN>      0 atoms have been selected out of      0
  
 CHARMM>     
  
 CHARMM>    !Read the system information
 CHARMM>    stream step3_size.str
 VOPEN> Attempting to open::step3_size.str::
 OPNLGU> Unit 99 opened for READONLY access to step3_size.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> SET BOXTYPE  = RECT
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     SET BOXTYPE  = RECT
 Parameter: BOXTYPE <- "RECT"
  
 CHARMM>     SET XTLTYPE  = TETRAGONAL
 Parameter: XTLTYPE <- "TETRAGONAL"
  
 CHARMM>     SET A        = 120.112447
 Parameter: A <- "120.112447"
  
 CHARMM>     SET B        = 120.112447
 Parameter: B <- "120.112447"
  
 CHARMM>     SET C        = 85
 Parameter: C <- "85"
  
 CHARMM>     SET ALPHA    = 90.0
 Parameter: ALPHA <- "90.0"
  
 CHARMM>     SET BETA     = 90.0
 Parameter: BETA <- "90.0"
  
 CHARMM>     SET GAMMA    = 90.0
 Parameter: GAMMA <- "90.0"
  
 CHARMM>     SET ZCEN     = 0
 Parameter: ZCEN <- "0"
  
 CHARMM>     SET NLIPTOP  = 229
 Parameter: NLIPTOP <- "229"
  
 CHARMM>     SET NLIPBOT  = 229
 Parameter: NLIPBOT <- "229"
  
 CHARMM>     SET WBOXZ    = 22.5
 Parameter: WBOXZ <- "22.5"
  
 CHARMM>     SET WATBOXZ  = 22.5
 Parameter: WATBOXZ <- "22.5"
  
 CHARMM>     SET NCHARGE  = 0
 Parameter: NCHARGE <- "0"
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>    stream step4_components.str
 VOPEN> Attempting to open::step4_components.str::
 OPNLGU> Unit 99 opened for READONLY access to step4_components.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> SET NWATER = 0
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     SET NWATER = 0
 Parameter: NWATER <- "0"
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>    if islconj .eq. YES stream step3_lipid_conjugate.str
 Comparing "ISLCONJ" and "YES".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    ! Read Lipids
 CHARMM>    open read unit 10 card name step4_lipid_lipid.psf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step4_lipid_lipid.psf::
 OPNLGU> Unit 10 opened for READONLY access to step4_lipid_lipid.psf
  
 CHARMM>    read psf  unit 10 card append
 MAINIO> Protein structure file being appended from unit  10.
 psf_read_formatted: Reading PSF in the expanded format.
 TITLE>  * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON AUG, 04. 2024. JOB
 TITLE>  * GET A DIFFERENT CONFORMATION FOR LIPIDS PENETRATING PROTEIN / CHOL
 TITLE>  *  DATE:     8/ 4/24      1:38:47      CREATED BY USER: apache
 TITLE>  *
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        1   Number of residues   =      458
         Number of atoms         =     5496   Number of groups     =      458
         Number of bonds         =     5038   Number of angles     =     3664
         Number of dihedrals     =        0   Number of impropers  =        0
         Number of cross-terms   =        0   Number of autogens   =     3664
         Number of HB acceptors  =        0   Number of HB donors  =        0
         Number of NB exclusions =        0   Total charge =    0.00000
  
 CHARMM>     
  
 CHARMM>    open read unit 10 card name step4_lipid_lipid.crd
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step4_lipid_lipid.crd::
 OPNLGU> Unit 10 opened for READONLY access to step4_lipid_lipid.crd
  
 CHARMM>    read coor unit 10 card append
          SPATIAL COORDINATES BEING READ FROM UNIT 10
 TITLE> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON AUG, 04. 2024. JOB
 TITLE> * GET A DIFFERENT CONFORMATION FOR LIPIDS PENETRATING PROTEIN / CHOL
 TITLE> *  DATE:     8/ 4/24      1:38:47      CREATED BY USER: APACHE
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    define LPSION sele none end
 SELRPN>      0 atoms have been selected out of   5496
  
 CHARMM>     
  
 CHARMM>    !
 CHARMM>    ! conc    : concentration (M)
 CHARMM>    ! volumn  : ion accessible volume (Ang**3)
 CHARMM>    ! npos    : number of positive ions
 CHARMM>    ! nneg    : number of negative ions
 CHARMM>    ! nion    : number of positive and negative ions of a particular compound
 CHARMM>    ! npostot : total number of all positive ions
 CHARMM>    ! nnegtot : total number of all negative ions
 CHARMM>    ! niontot : total number of all ions
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    set zmemb =  20.0           ! ion exclusion membrane region
 Parameter: ZMEMB <- "20.0"
  
 CHARMM>     
  
 CHARMM>    ! protein volume, calculation with a grid spacing of 0.5
 CHARMM>    coor stat
 STATISTICS FOR      5496 SELECTED ATOMS:
    XMIN =  -63.664157 XMAX =   63.438421 XAVE =   -0.472389
    YMIN =  -63.184952 YMAX =   64.014529 YAVE =    0.249445
    ZMIN =  -21.624335 ZMAX =   21.797325 ZAVE =    0.046592
    WMIN =    0.001710 WMAX =    3.150180 WAVE =    1.903008
  
 CHARMM>     
  
 CHARMM>    calc dcel = 0.5
Evaluating: 0.5
 Parameter: DCEL <- "0.5"
  
 CHARMM>    calc xdim = int ( ( ?xmax - ?xmin + 5.0 ) / @dcel ) + 1
 Parameter: DCEL -> "0.5"
 RDCMND substituted energy or value "?XMAX" to "63.4384213"
 RDCMND substituted energy or value "?XMIN" to "-63.6641575"
Evaluating: INT((63.4384213--63.6641575+5.0)/0.5)+1
 Parameter: XDIM <- "265"
  
 CHARMM>    calc ydim = int ( ( ?ymax - ?ymin + 5.0 ) / @dcel ) + 1
 Parameter: DCEL -> "0.5"
 RDCMND substituted energy or value "?YMAX" to "64.0145291"
 RDCMND substituted energy or value "?YMIN" to "-63.1849521"
Evaluating: INT((64.0145291--63.1849521+5.0)/0.5)+1
 Parameter: YDIM <- "265"
  
 CHARMM>    calc zdim = int ( ( ?zmax - ?zmin + 5.0 ) / @dcel ) + 1
 Parameter: DCEL -> "0.5"
 RDCMND substituted energy or value "?ZMAX" to "21.797325"
 RDCMND substituted energy or value "?ZMIN" to "-21.624335"
Evaluating: INT((21.797325--21.624335+5.0)/0.5)+1
 Parameter: ZDIM <- "97"
  
 CHARMM>    calc space = @xdim * @ydim * @zdim
 Parameter: XDIM -> "265"
 Parameter: YDIM -> "265"
 Parameter: ZDIM -> "97"
Evaluating: 265*265*97
 Parameter: SPACE <- "6811825"
  
 CHARMM>     
  
 CHARMM>    ! prevent overflow on integer conversion
 CHARMM>    calc maxint = 2**32 / 2 - 1
Evaluating: 2**32/2-1
 Parameter: MAXINT <- "2.147483647E+09"
  
 CHARMM>    if space .gt. @maxint calc space = @maxint
 Parameter: MAXINT -> "2.147483647E+09"
 Parameter: MAXINT -> "2.147483647E+09"
 Comparing "6811825" and "2.147483647E+09".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    scalar wmain = radius
  
 CHARMM>    scalar wmain add 1.4    ! use solvent accessible surface for molecular volume
  
 CHARMM>    scalar 1 = wmain
  
 CHARMM>    scalar 2 set 6.0
  
 CHARMM>    coor volume hole space @space sele .not. resname W end
 Parameter: SPACE -> "6811825"
 SELRPN>   5496 atoms have been selected out of   5496
 COMPUTING VOLUME PER ATOM WITH:
   XMIN=    -67.7019 XMAX=     67.4762 NX= 261
   YMIN=    -67.2227 YMAX=     68.0523 NY= 261
   ZMIN=    -25.6621 ZMAX=     25.8351 NZ=  99


 A TOTAL OF     9461   VACUUM POINTS WERE FOUND
 A TOTAL OF  4547042 OCCUPIED POINTS WERE FOUND
 A TOTAL OF  2187476 EXTERNAL POINTS WERE FOUND
 A TOTAL OF  6734518 SELECTED POINTS WERE FOUND
 TOTAL OCCUPIED  VOLUME =  634922.877494
 TOTAL SELECTED  VOLUME =  940369.485722
 TOTAL FREE      VOLUME =    1321.079802
 FRACTIONAL FREE VOLUME =       0.207637
  
 CHARMM>     
  
 CHARMM>    set sysvol = ?volume
 RDCMND substituted energy or value "?VOLUME" to "634922.877"
 Parameter: SYSVOL <- "634922.877"
  
 CHARMM>     
  
 CHARMM>    IF BOXTYPE .ne. HEXA then
 Comparing "RECT" and "HEXA".
 IF test evaluated as true.  Performing command
  
 CHARMM>       calc volumn = ( @A * @B * @C ) - @sysvol
 Parameter: A -> "120.112447"
 Parameter: B -> "120.112447"
 Parameter: C -> "85"
 Parameter: SYSVOL -> "634922.877"
Evaluating: (120.112447*120.112447*85)-634922.877
 Parameter: VOLUMN <- "591372.117"
  
 CHARMM>    ENDIF
  
 CHARMM>     
  
 CHARMM>    IF BOXTYPE .eq. HEXA THEN
 Comparing "RECT" and "HEXA".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>    if @?nlipaion  .eq. 0 set nlipaion  = 0
 Comparing "0" and "0".
 IF test evaluated as true.  Performing command
 Parameter: NLIPAION <- "0"
  
 CHARMM>    if @?ncoreion  .eq. 0 set ncoreion  = 0
 Comparing "0" and "0".
 IF test evaluated as true.  Performing command
 Parameter: NCOREION <- "0"
  
 CHARMM>    if @?noantiion .eq. 0 set noantiion = 0
 Comparing "0" and "0".
 IF test evaluated as true.  Performing command
 Parameter: NOANTIION <- "0"
  
 CHARMM>     
  
 CHARMM>    calc npostot = @nlipaion + @ncoreion + @noantiion
 Parameter: NLIPAION -> "0"
 Parameter: NCOREION -> "0"
 Parameter: NOANTIION -> "0"
Evaluating: 0+0+0
 Parameter: NPOSTOT <- "0"
  
 CHARMM>    calc nnegtot = 0
Evaluating: 0
 Parameter: NNEGTOT <- "0"
  
 CHARMM>    calc niontot = @npostot
 Parameter: NPOSTOT -> "0"
Evaluating: 0
 Parameter: NIONTOT <- "0"
  
 CHARMM>     
  
 CHARMM>    define ALLIONS sele none end
 SELRPN>      0 atoms have been selected out of   5496
  
 CHARMM>     
  
 CHARMM>    set ionind = 1
 Parameter: IONIND <- "1"
  
 CHARMM>    label do_ion
  
 CHARMM>        define POS sele none end
 SELRPN>      0 atoms have been selected out of   5496
  
 CHARMM>        define NEG sele none end
 SELRPN>      0 atoms have been selected out of   5496
  
 CHARMM>     
  
 CHARMM>        stream step2.2_ions_count.str @ionind
 Parameter: IONIND -> "1"
 VOPEN> Attempting to open::step2.2_ions_count.str::
 OPNLGU> Unit 99 opened for READONLY access to step2.2_ions_count.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> * NUMBER OF EACH ION STRUCTURE, AS CHOSEN BY USER;
 RDTITL> * USAGE: STREAM STEP2_IONS_COUNT.STR INDEX
 RDTITL> *
 Parameter: IN1 <- "1"
  
 CHARMM>     
  
 CHARMM>    if @?IN1 .eq. 0 stop ! ABNORMAL TERMINATION: missing index
 Comparing "1" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    set isusercation = 0
 Parameter: ISUSERCATION <- "0"
  
 CHARMM>    set isuseranion  = 0
 Parameter: ISUSERANION <- "0"
  
 CHARMM>    if @IN1 .eq. 1 set pos = NA
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: POS <- "NA"
  
 CHARMM>    if @IN1 .eq. 1 set neg = CL
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NEG <- "CL"
  
 CHARMM>    if @IN1 .eq. 1 set poscharge = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: POSCHARGE <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set negcharge = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NEGCHARGE <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set posval = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: POSVAL <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set negval = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NEGVAL <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set conc = 0.15
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: CONC <- "0.15"
  
 CHARMM>    if @IN1 .eq. 1 set natompos = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NATOMPOS <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set natomneg = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NATOMNEG <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set isusercation = 0
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: ISUSERCATION <- "0"
  
 CHARMM>    if @IN1 .eq. 1 set isuseranion  = 0
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: ISUSERANION <- "0"
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    set neutral_index = 1
 Parameter: NEUTRAL_INDEX <- "1"
  
 CHARMM>    set niontypes = 1
 Parameter: NIONTYPES <- "1"
  
 CHARMM>     
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>     
  
 CHARMM>        calc ncharge = int( ?cgtot )
 RDCMND substituted energy or value "?CGTOT" to "0"
Evaluating: INT(0)
 Parameter: NCHARGE <- "0"
  
 CHARMM>        calc cgtot = ?cgtot
 RDCMND substituted energy or value "?CGTOT" to "0"
Evaluating: 0
 Parameter: CGTOT <- "0"
  
 CHARMM>     
  
 CHARMM>        calc npos = 0
Evaluating: 0
 Parameter: NPOS <- "0"
  
 CHARMM>        calc nneg = 0
Evaluating: 0
 Parameter: NNEG <- "0"
  
 CHARMM>        if neutral_index .eq. @ionind then
 Parameter: IONIND -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>            if ncharge .lt. 0 calc npos = int( abs( @cgtot ) / @poscharge )
 Parameter: CGTOT -> "0"
 Parameter: POSCHARGE -> "1"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            if ncharge .gt. 0 calc nneg = int( abs( @cgtot ) / @negcharge )
 Parameter: CGTOT -> "0"
 Parameter: NEGCHARGE -> "1"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        calc diff   = int ( @cgtot + @npos*@poscharge - @nneg*@negcharge )
 Parameter: CGTOT -> "0"
 Parameter: NPOS -> "0"
 Parameter: POSCHARGE -> "1"
 Parameter: NNEG -> "0"
 Parameter: NEGCHARGE -> "1"
Evaluating: INT(0+0*1-0*1)
 Parameter: DIFF <- "0"
  
 CHARMM>     
  
 CHARMM>        if neutral_index .eq. @ionind then
 Parameter: IONIND -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>            set ntries = 0
 Parameter: NTRIES <- "0"
  
 CHARMM>            label neutral
  
 CHARMM>                if diff .gt. 0 calc nneg = @nneg + 1
 Parameter: NNEG -> "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                if diff .lt. 0 calc npos = @npos + 1
 Parameter: NPOS -> "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                calc diff   = int ( @cgtot + @npos*@poscharge - @nneg*@negcharge )
 Parameter: CGTOT -> "0"
 Parameter: NPOS -> "0"
 Parameter: POSCHARGE -> "1"
 Parameter: NNEG -> "0"
 Parameter: NEGCHARGE -> "1"
Evaluating: INT(0+0*1-0*1)
 Parameter: DIFF <- "0"
  
 CHARMM>                incr ntries
 Parameter: NTRIES <- "1"
  
 CHARMM>                if ntries .ge. 10 stop ! ABNORMAL TERMINATION: can't neutralize this system
 Comparing "1" and "10".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                if diff .ne. 0 goto neutral
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        calc npos = @npos + int ( @conc * 6.021 * 0.0001 * @volumn ) * @negval
 Parameter: NPOS -> "0"
 Parameter: CONC -> "0.15"
 Parameter: VOLUMN -> "591372.117"
 Parameter: NEGVAL -> "1"
Evaluating: 0+INT(0.15*6.021*0.0001*591372.117)*1
 Parameter: NPOS <- "53"
  
 CHARMM>        calc nneg = @nneg + int ( @conc * 6.021 * 0.0001 * @volumn ) * @posval
 Parameter: NNEG -> "0"
 Parameter: CONC -> "0.15"
 Parameter: VOLUMN -> "591372.117"
 Parameter: POSVAL -> "1"
Evaluating: 0+INT(0.15*6.021*0.0001*591372.117)*1
 Parameter: NNEG <- "53"
  
 CHARMM>     
  
 CHARMM>        if npos .lt. 0 stop ! ABNORMAL TERMINATION: something wrong
 Comparing "53" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>        if nneg .lt. 0 stop ! ABNORMAL TERMINATION: something wrong
 Comparing "53" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>        !
  
 CHARMM>        ! Randomly place the ions
  
 CHARMM>        !
  
 CHARMM>     
  
 CHARMM>        ! Generate positive ion
  
 CHARMM>        if npos .gt. 0 then
 Comparing "53" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>            if isusercation .eq. 1 then
 Comparing "0" and "1".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                read sequence @pos @npos
 Parameter: POS -> "NA"
 Parameter: NPOS -> "53"
  
 CHARMM>                generate POS warn
 NO PATCHING WILL BE DONE ON THE FIRST RESIDUE
 NO PATCHING WILL BE DONE ON THE LAST  RESIDUE
 AUTGEN: Autogenerating specified angles and dihedrals.
 GENPSF> Segment   2 has been generated. Its identifier is POS.
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        2   Number of residues   =      511
         Number of atoms         =     5549   Number of groups     =      511
         Number of bonds         =     5038   Number of angles     =     3664
         Number of dihedrals     =        0   Number of impropers  =        0
         Number of cross-terms   =        0   Number of autogens   =     3664
         Number of HB acceptors  =        0   Number of HB donors  =        0
         Number of NB exclusions =        0   Total charge =   53.00000
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define POS sele segid POS end
 SELRPN>     53 atoms have been selected out of   5549
  
 CHARMM>     
  
 CHARMM>            if natompos .gt. 1 then
 Comparing "1" and "1".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                ! move ion to origin
  
 CHARMM>                coor set sele POS end
 SELRPN>     53 atoms have been selected out of   5549
 SELECTED COORDINATES SET IN THE MAIN SET.

  
 CHARMM>            endif
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        ! Generate negative ion
  
 CHARMM>        if nneg .gt. 0 then
 Comparing "53" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>            if isuseranion .eq. 1 then
 Comparing "0" and "1".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                read sequence @neg @nneg
 Parameter: NEG -> "CL"
 Parameter: NNEG -> "53"
  
 CHARMM>                generate NEG warn
 NO PATCHING WILL BE DONE ON THE FIRST RESIDUE
 NO PATCHING WILL BE DONE ON THE LAST  RESIDUE
 AUTGEN: Autogenerating specified angles and dihedrals.
 GENPSF> Segment   3 has been generated. Its identifier is NEG.
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        3   Number of residues   =      564
         Number of atoms         =     5602   Number of groups     =      564
         Number of bonds         =     5038   Number of angles     =     3664
         Number of dihedrals     =        0   Number of impropers  =        0
         Number of cross-terms   =        0   Number of autogens   =     3664
         Number of HB acceptors  =        0   Number of HB donors  =        0
         Number of NB exclusions =        0   Total charge =    0.00000
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define NEG sele segid NEG end
 SELRPN>     53 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            if natomneg .gt. 1 then
 Comparing "1" and "1".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                ! move ion to origin
  
 CHARMM>                coor set sele NEG end
 SELRPN>     53 atoms have been selected out of   5602
 SELECTED COORDINATES SET IN THE MAIN SET.

  
 CHARMM>            endif
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        define IONS sele POS .or. NEG end
 SELRPN>    106 atoms have been selected out of   5602
  
 CHARMM>        define ALLIONS sele segid IONS .or. IONS end
 SELRPN>    106 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>        calc nion = @npos + @nneg
 Parameter: NPOS -> "53"
 Parameter: NNEG -> "53"
Evaluating: 53+53
 Parameter: NION <- "106"
  
 CHARMM>     
  
 CHARMM>        incr npostot by @npos
 Parameter: NPOS -> "53"
 Parameter: NPOSTOT <- "53"
  
 CHARMM>        incr nnegtot by @nneg
 Parameter: NNEG -> "53"
 Parameter: NNEGTOT <- "53"
  
 CHARMM>        incr niontot by @nion
 Parameter: NION -> "106"
 Parameter: NIONTOT <- "106"
  
 CHARMM>     
  
 CHARMM>        if nion .eq. 0 goto continue
 Comparing "106" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>        !
  
 CHARMM>        ! Initial placement of ions
  
 CHARMM>        !
  
 CHARMM>     
  
 CHARMM>        calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>     
  
 CHARMM>        calc i   = 1
Evaluating: 1
 Parameter: I <- "1"
  
 CHARMM>        label doinit
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "1"
Evaluating: 1
 Parameter: J <- "1"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "1" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "1"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.96179916"
Evaluating: 120.112447*(0.96179916-0.5)
 Parameter: XPOS <- "55.4678271"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.636611959"
Evaluating: 120.112447*(0.636611959-0.5)
 Parameter: YPOS <- "16.4087967"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.89950013"
Evaluating: 85*(0.89950013-0.5)+0
 Parameter: ZPOS <- "33.9575111"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "33.9575111" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "33.9575111" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "55.4678271"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 55.4678271-0
 Parameter: XTRAN <- "55.4678271"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "16.4087967"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 16.4087967-0
 Parameter: YTRAN <- "16.4087967"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "33.9575111"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 33.9575111-0
 Parameter: ZTRAN <- "33.9575111"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "55.4678271"
 Parameter: YTRAN -> "16.4087967"
 Parameter: ZTRAN -> "33.9575111"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    55.467827   16.408797   33.957511
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.986567602"
Evaluating: 0.986567602*360.0
 Parameter: XPHI <- "355.164337"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.143581536"
Evaluating: 0.143581536*360.0
 Parameter: YPHI <- "51.689353"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.257138588"
Evaluating: 0.257138588*360.0
 Parameter: ZPHI <- "92.5698917"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "55.4678271"
 Parameter: YPOS -> "16.4087967"
 Parameter: ZPOS -> "33.9575111"
 Parameter: XPHI -> "355.164337"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.996441   -0.084298
    0.000000    0.084298    0.996441

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    4.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "55.4678271"
 Parameter: YPOS -> "16.4087967"
 Parameter: ZPOS -> "33.9575111"
 Parameter: YPHI -> "51.689353"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.619925    0.000000   -0.784661
    0.000000    1.000000    0.000000
    0.784661    0.000000    0.619925

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   51.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "55.4678271"
 Parameter: YPOS -> "16.4087967"
 Parameter: ZPOS -> "33.9575111"
 Parameter: ZPHI -> "92.5698917"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.044838    0.998994    0.000000
   -0.998994   -0.044838    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   92.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   55.467827 XMAX =   55.467827 XAVE =   55.467827
    YMIN =   16.408797 YMAX =   16.408797 YAVE =   16.408797
    ZMIN =   33.957511 ZMAX =   33.957511 ZAVE =   33.957511
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "55.4678271"
Evaluating: 55.4678271+3.5
 Parameter: XMAX <- "58.9678271"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "16.4087967"
Evaluating: 16.4087967+3.5
 Parameter: YMAX <- "19.9087967"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "33.9575111"
Evaluating: 33.9575111+3.5
 Parameter: ZMAX <- "37.4575111"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "55.4678271"
Evaluating: 55.4678271-3.5
 Parameter: XMIN <- "51.9678271"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "16.4087967"
Evaluating: 16.4087967-3.5
 Parameter: YMIN <- "12.9087967"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "33.9575111"
Evaluating: 33.9575111-3.5
 Parameter: ZMIN <- "30.4575111"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "58.9678271"
 Parameter: XMIN -> "51.9678271"
 Parameter: YMAX -> "19.9087967"
 Parameter: YMIN -> "12.9087967"
 Parameter: ZMAX -> "37.4575111"
 Parameter: ZMIN -> "30.4575111"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "2"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "2" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "2"
Evaluating: 2
 Parameter: J <- "2"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "2" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "2"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.677321612"
Evaluating: 120.112447*(0.677321612-0.5)
 Parameter: XPOS <- "21.2985327"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.753259846"
Evaluating: 120.112447*(0.753259846-0.5)
 Parameter: YPOS <- "30.4196598"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.431958764"
Evaluating: 85*(0.431958764-0.5)+0
 Parameter: ZPOS <- "-5.78350506"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-5.78350506" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-5.78350506" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "2"
Evaluating: 2
 Parameter: J <- "2"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "2" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "2"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.412114409"
Evaluating: 120.112447*(0.412114409-0.5)
 Parameter: XPOS <- "-10.5561534"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.539784555"
Evaluating: 120.112447*(0.539784555-0.5)
 Parameter: YPOS <- "4.77862025"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.150740253"
Evaluating: 85*(0.150740253-0.5)+0
 Parameter: ZPOS <- "-29.6870785"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-29.6870785" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-10.5561534"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -10.5561534-0
 Parameter: XTRAN <- "-10.5561534"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "4.77862025"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 4.77862025-0
 Parameter: YTRAN <- "4.77862025"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-29.6870785"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -29.6870785-0
 Parameter: ZTRAN <- "-29.6870785"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-10.5561534"
 Parameter: YTRAN -> "4.77862025"
 Parameter: ZTRAN -> "-29.6870785"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR   -10.556153    4.778620  -29.687078
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.950318"
Evaluating: 0.950318*360.0
 Parameter: XPHI <- "342.11448"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.476789655"
Evaluating: 0.476789655*360.0
 Parameter: YPHI <- "171.644276"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.614902848"
Evaluating: 0.614902848*360.0
 Parameter: ZPHI <- "221.365025"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-10.5561534"
 Parameter: YPOS -> "4.77862025"
 Parameter: ZPOS -> "-29.6870785"
 Parameter: XPHI -> "342.11448"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.951672   -0.307116
    0.000000    0.307116    0.951672

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   17.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-10.5561534"
 Parameter: YPOS -> "4.77862025"
 Parameter: ZPOS -> "-29.6870785"
 Parameter: YPHI -> "171.644276"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.989385    0.000000   -0.145319
    0.000000    1.000000    0.000000
    0.145319    0.000000   -0.989385

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  171.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-10.5561534"
 Parameter: YPOS -> "4.77862025"
 Parameter: ZPOS -> "-29.6870785"
 Parameter: ZPHI -> "221.365025"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.750515   -0.660854    0.000000
    0.660854   -0.750515    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  138.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -10.556153 XMAX =  -10.556153 XAVE =  -10.556153
    YMIN =    4.778620 YMAX =    4.778620 YAVE =    4.778620
    ZMIN =  -29.687078 ZMAX =  -29.687078 ZAVE =  -29.687078
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-10.5561534"
Evaluating: -10.5561534+3.5
 Parameter: XMAX <- "-7.0561534"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "4.77862025"
Evaluating: 4.77862025+3.5
 Parameter: YMAX <- "8.27862025"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-29.6870785"
Evaluating: -29.6870785+3.5
 Parameter: ZMAX <- "-26.1870785"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-10.5561534"
Evaluating: -10.5561534-3.5
 Parameter: XMIN <- "-14.0561534"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "4.77862025"
Evaluating: 4.77862025-3.5
 Parameter: YMIN <- "1.27862025"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-29.6870785"
Evaluating: -29.6870785-3.5
 Parameter: ZMIN <- "-33.1870785"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-7.0561534"
 Parameter: XMIN -> "-14.0561534"
 Parameter: YMAX -> "8.27862025"
 Parameter: YMIN -> "1.27862025"
 Parameter: ZMAX -> "-26.1870785"
 Parameter: ZMIN -> "-33.1870785"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "3"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "3" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "3"
Evaluating: 3
 Parameter: J <- "3"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "3" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "3"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.690763037"
Evaluating: 120.112447*(0.690763037-0.5)
 Parameter: XPOS <- "22.9130152"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.57272206"
Evaluating: 120.112447*(0.57272206-0.5)
 Parameter: YPOS <- "8.73482458"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.636334817"
Evaluating: 85*(0.636334817-0.5)+0
 Parameter: ZPOS <- "11.5884594"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "11.5884594" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "11.5884594" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "3"
Evaluating: 3
 Parameter: J <- "3"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "3" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "3"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.766508488"
Evaluating: 120.112447*(0.766508488-0.5)
 Parameter: XPOS <- "32.0109866"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.360939908"
Evaluating: 120.112447*(0.360939908-0.5)
 Parameter: YPOS <- "-16.7028479"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.888466044"
Evaluating: 85*(0.888466044-0.5)+0
 Parameter: ZPOS <- "33.0196137"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "33.0196137" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "33.0196137" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "32.0109866"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 32.0109866-0
 Parameter: XTRAN <- "32.0109866"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-16.7028479"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -16.7028479-0
 Parameter: YTRAN <- "-16.7028479"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "33.0196137"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 33.0196137-0
 Parameter: ZTRAN <- "33.0196137"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "32.0109866"
 Parameter: YTRAN -> "-16.7028479"
 Parameter: ZTRAN -> "33.0196137"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    32.010987  -16.702848   33.019614
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.010411532E-02"
Evaluating: 9.010411532E-02*360.0
 Parameter: XPHI <- "32.4374815"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.753360109"
Evaluating: 0.753360109*360.0
 Parameter: YPHI <- "271.209639"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.193811093"
Evaluating: 0.193811093*360.0
 Parameter: ZPHI <- "69.7719935"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "32.0109866"
 Parameter: YPOS -> "-16.7028479"
 Parameter: ZPOS -> "33.0196137"
 Parameter: XPHI -> "32.4374815"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.843977    0.536379
    0.000000   -0.536379    0.843977

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   32.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "32.0109866"
 Parameter: YPOS -> "-16.7028479"
 Parameter: ZPOS -> "33.0196137"
 Parameter: YPHI -> "271.209639"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.021111    0.000000    0.999777
    0.000000    1.000000    0.000000
   -0.999777    0.000000    0.021111

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   88.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "32.0109866"
 Parameter: YPOS -> "-16.7028479"
 Parameter: ZPOS -> "33.0196137"
 Parameter: ZPHI -> "69.7719935"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.345757    0.938324    0.000000
   -0.938324    0.345757    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   69.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   32.010987 XMAX =   32.010987 XAVE =   32.010987
    YMIN =  -16.702848 YMAX =  -16.702848 YAVE =  -16.702848
    ZMIN =   33.019614 ZMAX =   33.019614 ZAVE =   33.019614
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "32.0109866"
Evaluating: 32.0109866+3.5
 Parameter: XMAX <- "35.5109866"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-16.7028479"
Evaluating: -16.7028479+3.5
 Parameter: YMAX <- "-13.2028479"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "33.0196137"
Evaluating: 33.0196137+3.5
 Parameter: ZMAX <- "36.5196137"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "32.0109866"
Evaluating: 32.0109866-3.5
 Parameter: XMIN <- "28.5109866"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-16.7028479"
Evaluating: -16.7028479-3.5
 Parameter: YMIN <- "-20.2028479"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "33.0196137"
Evaluating: 33.0196137-3.5
 Parameter: ZMIN <- "29.5196137"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "35.5109866"
 Parameter: XMIN -> "28.5109866"
 Parameter: YMAX -> "-13.2028479"
 Parameter: YMIN -> "-20.2028479"
 Parameter: ZMAX -> "36.5196137"
 Parameter: ZMIN -> "29.5196137"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "4"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "4" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "4"
Evaluating: 4
 Parameter: J <- "4"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "4" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "4"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.991107079"
Evaluating: 120.112447*(0.991107079-0.5)
 Parameter: XPOS <- "58.988073"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.292587531"
Evaluating: 120.112447*(0.292587531-0.5)
 Parameter: YPOS <- "-24.9128192"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "8.60227694E-02"
Evaluating: 85*(8.60227694E-02-0.5)+0
 Parameter: ZPOS <- "-35.1880646"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-35.1880646" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "58.988073"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 58.988073-0
 Parameter: XTRAN <- "58.988073"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-24.9128192"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -24.9128192-0
 Parameter: YTRAN <- "-24.9128192"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-35.1880646"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -35.1880646-0
 Parameter: ZTRAN <- "-35.1880646"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "58.988073"
 Parameter: YTRAN -> "-24.9128192"
 Parameter: ZTRAN -> "-35.1880646"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    58.988073  -24.912819  -35.188065
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.688582696"
Evaluating: 0.688582696*360.0
 Parameter: XPHI <- "247.889771"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.191154559"
Evaluating: 0.191154559*360.0
 Parameter: YPHI <- "68.8156412"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.338289254"
Evaluating: 0.338289254*360.0
 Parameter: ZPHI <- "121.784131"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "58.988073"
 Parameter: YPOS -> "-24.9128192"
 Parameter: ZPOS -> "-35.1880646"
 Parameter: XPHI -> "247.889771"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.376390   -0.926461
    0.000000    0.926461   -0.376390

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  112.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "58.988073"
 Parameter: YPOS -> "-24.9128192"
 Parameter: ZPOS -> "-35.1880646"
 Parameter: YPHI -> "68.8156412"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.361370    0.000000   -0.932422
    0.000000    1.000000    0.000000
    0.932422    0.000000    0.361370

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   68.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "58.988073"
 Parameter: YPOS -> "-24.9128192"
 Parameter: ZPOS -> "-35.1880646"
 Parameter: ZPHI -> "121.784131"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.526720    0.850039    0.000000
   -0.850039   -0.526720    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  121.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   58.988073 XMAX =   58.988073 XAVE =   58.988073
    YMIN =  -24.912819 YMAX =  -24.912819 YAVE =  -24.912819
    ZMIN =  -35.188065 ZMAX =  -35.188065 ZAVE =  -35.188065
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "58.988073"
Evaluating: 58.988073+3.5
 Parameter: XMAX <- "62.488073"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-24.9128192"
Evaluating: -24.9128192+3.5
 Parameter: YMAX <- "-21.4128192"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-35.1880646"
Evaluating: -35.1880646+3.5
 Parameter: ZMAX <- "-31.6880646"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "58.988073"
Evaluating: 58.988073-3.5
 Parameter: XMIN <- "55.488073"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-24.9128192"
Evaluating: -24.9128192-3.5
 Parameter: YMIN <- "-28.4128192"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-35.1880646"
Evaluating: -35.1880646-3.5
 Parameter: ZMIN <- "-38.6880646"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "62.488073"
 Parameter: XMIN -> "55.488073"
 Parameter: YMAX -> "-21.4128192"
 Parameter: YMIN -> "-28.4128192"
 Parameter: ZMAX -> "-31.6880646"
 Parameter: ZMIN -> "-38.6880646"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "5"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "5" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "5"
Evaluating: 5
 Parameter: J <- "5"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "5" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "5"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.983807451"
Evaluating: 120.112447*(0.983807451-0.5)
 Parameter: XPOS <- "58.1112968"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.872292255"
Evaluating: 120.112447*(0.872292255-0.5)
 Parameter: YPOS <- "44.7169337"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.106801556"
Evaluating: 85*(0.106801556-0.5)+0
 Parameter: ZPOS <- "-33.4218677"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-33.4218677" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "58.1112968"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 58.1112968-0
 Parameter: XTRAN <- "58.1112968"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "44.7169337"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 44.7169337-0
 Parameter: YTRAN <- "44.7169337"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-33.4218677"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -33.4218677-0
 Parameter: ZTRAN <- "-33.4218677"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "58.1112968"
 Parameter: YTRAN -> "44.7169337"
 Parameter: ZTRAN -> "-33.4218677"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    58.111297   44.716934  -33.421868
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.990571799"
Evaluating: 0.990571799*360.0
 Parameter: XPHI <- "356.605848"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.381302086"
Evaluating: 0.381302086*360.0
 Parameter: YPHI <- "137.268751"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.955610619"
Evaluating: 0.955610619*360.0
 Parameter: ZPHI <- "344.019823"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "58.1112968"
 Parameter: YPOS -> "44.7169337"
 Parameter: ZPOS -> "-33.4218677"
 Parameter: XPHI -> "356.605848"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.998246   -0.059204
    0.000000    0.059204    0.998246

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    3.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "58.1112968"
 Parameter: YPOS -> "44.7169337"
 Parameter: ZPOS -> "-33.4218677"
 Parameter: YPHI -> "137.268751"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.734545    0.000000   -0.678560
    0.000000    1.000000    0.000000
    0.678560    0.000000   -0.734545

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  137.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "58.1112968"
 Parameter: YPOS -> "44.7169337"
 Parameter: ZPOS -> "-33.4218677"
 Parameter: ZPHI -> "344.019823"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.961357   -0.275305    0.000000
    0.275305    0.961357    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   15.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   58.111297 XMAX =   58.111297 XAVE =   58.111297
    YMIN =   44.716934 YMAX =   44.716934 YAVE =   44.716934
    ZMIN =  -33.421868 ZMAX =  -33.421868 ZAVE =  -33.421868
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "58.1112968"
Evaluating: 58.1112968+3.5
 Parameter: XMAX <- "61.6112968"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "44.7169337"
Evaluating: 44.7169337+3.5
 Parameter: YMAX <- "48.2169337"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-33.4218677"
Evaluating: -33.4218677+3.5
 Parameter: ZMAX <- "-29.9218677"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "58.1112968"
Evaluating: 58.1112968-3.5
 Parameter: XMIN <- "54.6112968"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "44.7169337"
Evaluating: 44.7169337-3.5
 Parameter: YMIN <- "41.2169337"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-33.4218677"
Evaluating: -33.4218677-3.5
 Parameter: ZMIN <- "-36.9218677"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "61.6112968"
 Parameter: XMIN -> "54.6112968"
 Parameter: YMAX -> "48.2169337"
 Parameter: YMIN -> "41.2169337"
 Parameter: ZMAX -> "-29.9218677"
 Parameter: ZMIN -> "-36.9218677"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "6"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "6" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "6"
Evaluating: 6
 Parameter: J <- "6"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "6" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "6"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.320419164"
Evaluating: 120.112447*(0.320419164-0.5)
 Parameter: XPOS <- "-21.5698936"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.471089378"
Evaluating: 120.112447*(0.471089378-0.5)
 Parameter: YPOS <- "-3.47252555"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "9.169754104E-02"
Evaluating: 85*(9.169754104E-02-0.5)+0
 Parameter: ZPOS <- "-34.705709"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-34.705709" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-21.5698936"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -21.5698936-0
 Parameter: XTRAN <- "-21.5698936"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-3.47252555"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -3.47252555-0
 Parameter: YTRAN <- "-3.47252555"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-34.705709"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -34.705709-0
 Parameter: ZTRAN <- "-34.705709"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-21.5698936"
 Parameter: YTRAN -> "-3.47252555"
 Parameter: ZTRAN -> "-34.705709"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR   -21.569894   -3.472526  -34.705709
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.887540841"
Evaluating: 0.887540841*360.0
 Parameter: XPHI <- "319.514703"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.625237709"
Evaluating: 0.625237709*360.0
 Parameter: YPHI <- "225.085575"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.237179087"
Evaluating: 0.237179087*360.0
 Parameter: ZPHI <- "85.3844713"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-21.5698936"
 Parameter: YPOS -> "-3.47252555"
 Parameter: ZPOS -> "-34.705709"
 Parameter: XPHI -> "319.514703"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.760573   -0.649253
    0.000000    0.649253    0.760573

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   40.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-21.5698936"
 Parameter: YPOS -> "-3.47252555"
 Parameter: ZPOS -> "-34.705709"
 Parameter: YPHI -> "225.085575"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.706050    0.000000    0.708162
    0.000000    1.000000    0.000000
   -0.708162    0.000000   -0.706050

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  134.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-21.5698936"
 Parameter: YPOS -> "-3.47252555"
 Parameter: ZPOS -> "-34.705709"
 Parameter: ZPHI -> "85.3844713"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.080469    0.996757    0.000000
   -0.996757    0.080469    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   85.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -21.569894 XMAX =  -21.569894 XAVE =  -21.569894
    YMIN =   -3.472526 YMAX =   -3.472526 YAVE =   -3.472526
    ZMIN =  -34.705709 ZMAX =  -34.705709 ZAVE =  -34.705709
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-21.5698936"
Evaluating: -21.5698936+3.5
 Parameter: XMAX <- "-18.0698936"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-3.47252555"
Evaluating: -3.47252555+3.5
 Parameter: YMAX <- "2.747445E-02"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-34.705709"
Evaluating: -34.705709+3.5
 Parameter: ZMAX <- "-31.205709"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-21.5698936"
Evaluating: -21.5698936-3.5
 Parameter: XMIN <- "-25.0698936"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-3.47252555"
Evaluating: -3.47252555-3.5
 Parameter: YMIN <- "-6.97252555"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-34.705709"
Evaluating: -34.705709-3.5
 Parameter: ZMIN <- "-38.205709"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-18.0698936"
 Parameter: XMIN -> "-25.0698936"
 Parameter: YMAX -> "2.747445E-02"
 Parameter: YMIN -> "-6.97252555"
 Parameter: ZMAX -> "-31.205709"
 Parameter: ZMIN -> "-38.205709"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "7"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "7" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "7"
Evaluating: 7
 Parameter: J <- "7"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "7" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "7"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.842610336"
Evaluating: 120.112447*(0.842610336-0.5)
 Parameter: XPOS <- "41.1517658"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.114493439"
Evaluating: 120.112447*(0.114493439-0.5)
 Parameter: YPOS <- "-46.3041364"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.809089527"
Evaluating: 85*(0.809089527-0.5)+0
 Parameter: ZPOS <- "26.2726098"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "26.2726098" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "26.2726098" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "41.1517658"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 41.1517658-0
 Parameter: XTRAN <- "41.1517658"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-46.3041364"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -46.3041364-0
 Parameter: YTRAN <- "-46.3041364"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "26.2726098"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 26.2726098-0
 Parameter: ZTRAN <- "26.2726098"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "41.1517658"
 Parameter: YTRAN -> "-46.3041364"
 Parameter: ZTRAN -> "26.2726098"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    41.151766  -46.304136   26.272610
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.122689042"
Evaluating: 0.122689042*360.0
 Parameter: XPHI <- "44.1680551"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.405088879E-02"
Evaluating: 1.405088879E-02*360.0
 Parameter: YPHI <- "5.05831996"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.577836907"
Evaluating: 0.577836907*360.0
 Parameter: ZPHI <- "208.021287"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "41.1517658"
 Parameter: YPOS -> "-46.3041364"
 Parameter: ZPOS -> "26.2726098"
 Parameter: XPHI -> "44.1680551"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.717299    0.696765
    0.000000   -0.696765    0.717299

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   44.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "41.1517658"
 Parameter: YPOS -> "-46.3041364"
 Parameter: ZPOS -> "26.2726098"
 Parameter: YPHI -> "5.05831996"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.996105    0.000000   -0.088170
    0.000000    1.000000    0.000000
    0.088170    0.000000    0.996105

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    5.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "41.1517658"
 Parameter: YPOS -> "-46.3041364"
 Parameter: ZPOS -> "26.2726098"
 Parameter: ZPHI -> "208.021287"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.882773   -0.469800    0.000000
    0.469800   -0.882773    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  151.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   41.151766 XMAX =   41.151766 XAVE =   41.151766
    YMIN =  -46.304136 YMAX =  -46.304136 YAVE =  -46.304136
    ZMIN =   26.272610 ZMAX =   26.272610 ZAVE =   26.272610
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "41.1517658"
Evaluating: 41.1517658+3.5
 Parameter: XMAX <- "44.6517658"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-46.3041364"
Evaluating: -46.3041364+3.5
 Parameter: YMAX <- "-42.8041364"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "26.2726098"
Evaluating: 26.2726098+3.5
 Parameter: ZMAX <- "29.7726098"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "41.1517658"
Evaluating: 41.1517658-3.5
 Parameter: XMIN <- "37.6517658"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-46.3041364"
Evaluating: -46.3041364-3.5
 Parameter: YMIN <- "-49.8041364"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "26.2726098"
Evaluating: 26.2726098-3.5
 Parameter: ZMIN <- "22.7726098"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "44.6517658"
 Parameter: XMIN -> "37.6517658"
 Parameter: YMAX -> "-42.8041364"
 Parameter: YMIN -> "-49.8041364"
 Parameter: ZMAX -> "29.7726098"
 Parameter: ZMIN -> "22.7726098"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "8"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "8" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "8"
Evaluating: 8
 Parameter: J <- "8"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "8" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "8"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.169899975"
Evaluating: 120.112447*(0.169899975-0.5)
 Parameter: XPOS <- "-39.6491218"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.659792854"
Evaluating: 120.112447*(0.659792854-0.5)
 Parameter: YPOS <- "19.1931107"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.358709333"
Evaluating: 85*(0.358709333-0.5)+0
 Parameter: ZPOS <- "-12.0097067"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-12.0097067" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-12.0097067" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "8"
Evaluating: 8
 Parameter: J <- "8"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "8" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "8"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.265816579"
Evaluating: 120.112447*(0.265816579-0.5)
 Parameter: XPOS <- "-28.1283437"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.99186608"
Evaluating: 120.112447*(0.99186608-0.5)
 Parameter: YPOS <- "59.0792385"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "9.606678533E-02"
Evaluating: 85*(9.606678533E-02-0.5)+0
 Parameter: ZPOS <- "-34.3343232"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-34.3343232" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-28.1283437"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -28.1283437-0
 Parameter: XTRAN <- "-28.1283437"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "59.0792385"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 59.0792385-0
 Parameter: YTRAN <- "59.0792385"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-34.3343232"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -34.3343232-0
 Parameter: ZTRAN <- "-34.3343232"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-28.1283437"
 Parameter: YTRAN -> "59.0792385"
 Parameter: ZTRAN -> "-34.3343232"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR   -28.128344   59.079239  -34.334323
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.324387867"
Evaluating: 0.324387867*360.0
 Parameter: XPHI <- "116.779632"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.587692249"
Evaluating: 0.587692249*360.0
 Parameter: YPHI <- "211.56921"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.732346434"
Evaluating: 0.732346434*360.0
 Parameter: ZPHI <- "263.644716"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-28.1283437"
 Parameter: YPOS -> "59.0792385"
 Parameter: ZPOS -> "-34.3343232"
 Parameter: XPHI -> "116.779632"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.450560    0.892746
    0.000000   -0.892746   -0.450560

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  116.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-28.1283437"
 Parameter: YPOS -> "59.0792385"
 Parameter: ZPOS -> "-34.3343232"
 Parameter: YPHI -> "211.56921"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.852008    0.000000    0.523528
    0.000000    1.000000    0.000000
   -0.523528    0.000000   -0.852008

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  148.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-28.1283437"
 Parameter: YPOS -> "59.0792385"
 Parameter: ZPOS -> "-34.3343232"
 Parameter: ZPHI -> "263.644716"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.110693   -0.993855    0.000000
    0.993855   -0.110693    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   96.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -28.128344 XMAX =  -28.128344 XAVE =  -28.128344
    YMIN =   59.079239 YMAX =   59.079239 YAVE =   59.079239
    ZMIN =  -34.334323 ZMAX =  -34.334323 ZAVE =  -34.334323
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-28.1283437"
Evaluating: -28.1283437+3.5
 Parameter: XMAX <- "-24.6283437"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "59.0792385"
Evaluating: 59.0792385+3.5
 Parameter: YMAX <- "62.5792385"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-34.3343232"
Evaluating: -34.3343232+3.5
 Parameter: ZMAX <- "-30.8343232"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-28.1283437"
Evaluating: -28.1283437-3.5
 Parameter: XMIN <- "-31.6283437"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "59.0792385"
Evaluating: 59.0792385-3.5
 Parameter: YMIN <- "55.5792385"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-34.3343232"
Evaluating: -34.3343232-3.5
 Parameter: ZMIN <- "-37.8343232"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-24.6283437"
 Parameter: XMIN -> "-31.6283437"
 Parameter: YMAX -> "62.5792385"
 Parameter: YMIN -> "55.5792385"
 Parameter: ZMAX -> "-30.8343232"
 Parameter: ZMIN -> "-37.8343232"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "9"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "9" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "9"
Evaluating: 9
 Parameter: J <- "9"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "9" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "9"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.422993035"
Evaluating: 120.112447*(0.422993035-0.5)
 Parameter: XPOS <- "-9.249495"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.939444412"
Evaluating: 120.112447*(0.939444412-0.5)
 Parameter: YPOS <- "52.7827436"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.689723514"
Evaluating: 85*(0.689723514-0.5)+0
 Parameter: ZPOS <- "16.1264987"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "16.1264987" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "16.1264987" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-9.249495"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -9.249495-0
 Parameter: XTRAN <- "-9.249495"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "52.7827436"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 52.7827436-0
 Parameter: YTRAN <- "52.7827436"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "16.1264987"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 16.1264987-0
 Parameter: ZTRAN <- "16.1264987"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-9.249495"
 Parameter: YTRAN -> "52.7827436"
 Parameter: ZTRAN -> "16.1264987"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    -9.249495   52.782744   16.126499
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.377770033E-02"
Evaluating: 7.377770033E-02*360.0
 Parameter: XPHI <- "26.5599721"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.192109207"
Evaluating: 0.192109207*360.0
 Parameter: YPHI <- "69.1593145"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.536888079"
Evaluating: 0.536888079*360.0
 Parameter: ZPHI <- "193.279708"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-9.249495"
 Parameter: YPOS -> "52.7827436"
 Parameter: ZPOS -> "16.1264987"
 Parameter: XPHI -> "26.5599721"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.894467    0.447134
    0.000000   -0.447134    0.894467

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   26.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-9.249495"
 Parameter: YPOS -> "52.7827436"
 Parameter: ZPOS -> "16.1264987"
 Parameter: YPHI -> "69.1593145"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.355771    0.000000   -0.934573
    0.000000    1.000000    0.000000
    0.934573    0.000000    0.355771

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   69.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-9.249495"
 Parameter: YPOS -> "52.7827436"
 Parameter: ZPOS -> "16.1264987"
 Parameter: ZPHI -> "193.279708"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.973260   -0.229705    0.000000
    0.229705   -0.973260    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  166.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -9.249495 XMAX =   -9.249495 XAVE =   -9.249495
    YMIN =   52.782744 YMAX =   52.782744 YAVE =   52.782744
    ZMIN =   16.126499 ZMAX =   16.126499 ZAVE =   16.126499
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-9.249495"
Evaluating: -9.249495+3.5
 Parameter: XMAX <- "-5.749495"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "52.7827436"
Evaluating: 52.7827436+3.5
 Parameter: YMAX <- "56.2827436"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "16.1264987"
Evaluating: 16.1264987+3.5
 Parameter: ZMAX <- "19.6264987"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-9.249495"
Evaluating: -9.249495-3.5
 Parameter: XMIN <- "-12.749495"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "52.7827436"
Evaluating: 52.7827436-3.5
 Parameter: YMIN <- "49.2827436"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "16.1264987"
Evaluating: 16.1264987-3.5
 Parameter: ZMIN <- "12.6264987"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-5.749495"
 Parameter: XMIN -> "-12.749495"
 Parameter: YMAX -> "56.2827436"
 Parameter: YMIN -> "49.2827436"
 Parameter: ZMAX -> "19.6264987"
 Parameter: ZMIN -> "12.6264987"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      1 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
 5505 POS      NA       9        NA      -1730 MEMB     DPPC     145      PO4           0.8073
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "9"
Evaluating: 9
 Parameter: J <- "9"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "9" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "9"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.919853772"
Evaluating: 120.112447*(0.919853772-0.5)
 Parameter: XPOS <- "50.4296639"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "1.884532264E-03"
Evaluating: 120.112447*(1.884532264E-03-0.5)
 Parameter: YPOS <- "-59.8298677"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.567895742"
Evaluating: 85*(0.567895742-0.5)+0
 Parameter: ZPOS <- "5.77113807"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "5.77113807" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "5.77113807" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "9"
Evaluating: 9
 Parameter: J <- "9"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "9" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "9"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.791210798"
Evaluating: 120.112447*(0.791210798-0.5)
 Parameter: XPOS <- "34.9780415"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.848057182"
Evaluating: 120.112447*(0.848057182-0.5)
 Parameter: YPOS <- "41.8059998"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.503676647"
Evaluating: 85*(0.503676647-0.5)+0
 Parameter: ZPOS <- "0.312514995"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "0.312514995" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "0.312514995" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "9"
Evaluating: 9
 Parameter: J <- "9"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "9" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "9"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.853276446"
Evaluating: 120.112447*(0.853276446-0.5)
 Parameter: XPOS <- "42.4328984"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.354869833"
Evaluating: 120.112447*(0.354869833-0.5)
 Parameter: YPOS <- "-17.4319395"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.296621201"
Evaluating: 85*(0.296621201-0.5)+0
 Parameter: ZPOS <- "-17.2871979"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-17.2871979" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -9.249495 XMAX =   -9.249495 XAVE =   -9.249495
    YMIN =   52.782744 YMAX =   52.782744 YAVE =   52.782744
    ZMIN =   16.126499 ZMAX =   16.126499 ZAVE =   16.126499
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "42.4328984"
 RDCMND substituted energy or value "?XAVE" to "-9.249495"
Evaluating: 42.4328984--9.249495
 Parameter: XTRAN <- "51.6823934"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-17.4319395"
 RDCMND substituted energy or value "?YAVE" to "52.7827436"
Evaluating: -17.4319395-52.7827436
 Parameter: YTRAN <- "-70.2146831"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-17.2871979"
 RDCMND substituted energy or value "?ZAVE" to "16.1264987"
Evaluating: -17.2871979-16.1264987
 Parameter: ZTRAN <- "-33.4136966"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "51.6823934"
 Parameter: YTRAN -> "-70.2146831"
 Parameter: ZTRAN -> "-33.4136966"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    51.682393  -70.214683  -33.413697
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.305502374"
Evaluating: 0.305502374*360.0
 Parameter: XPHI <- "109.980855"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.213350851"
Evaluating: 0.213350851*360.0
 Parameter: YPHI <- "76.8063064"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.453027583"
Evaluating: 0.453027583*360.0
 Parameter: ZPHI <- "163.08993"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "42.4328984"
 Parameter: YPOS -> "-17.4319395"
 Parameter: ZPOS -> "-17.2871979"
 Parameter: XPHI -> "109.980855"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.341706    0.939807
    0.000000   -0.939807   -0.341706

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  109.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "42.4328984"
 Parameter: YPOS -> "-17.4319395"
 Parameter: ZPOS -> "-17.2871979"
 Parameter: YPHI -> "76.8063064"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.228244    0.000000   -0.973604
    0.000000    1.000000    0.000000
    0.973604    0.000000    0.228244

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   76.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "42.4328984"
 Parameter: YPOS -> "-17.4319395"
 Parameter: ZPOS -> "-17.2871979"
 Parameter: ZPHI -> "163.08993"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.956762    0.290870    0.000000
   -0.290870   -0.956762    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  163.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   42.432898 XMAX =   42.432898 XAVE =   42.432898
    YMIN =  -17.431939 YMAX =  -17.431939 YAVE =  -17.431939
    ZMIN =  -17.287198 ZMAX =  -17.287198 ZAVE =  -17.287198
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "42.4328984"
Evaluating: 42.4328984+3.5
 Parameter: XMAX <- "45.9328984"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-17.4319395"
Evaluating: -17.4319395+3.5
 Parameter: YMAX <- "-13.9319395"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-17.2871979"
Evaluating: -17.2871979+3.5
 Parameter: ZMAX <- "-13.7871979"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "42.4328984"
Evaluating: 42.4328984-3.5
 Parameter: XMIN <- "38.9328984"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-17.4319395"
Evaluating: -17.4319395-3.5
 Parameter: YMIN <- "-20.9319395"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-17.2871979"
Evaluating: -17.2871979-3.5
 Parameter: ZMIN <- "-20.7871979"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "45.9328984"
 Parameter: XMIN -> "38.9328984"
 Parameter: YMAX -> "-13.9319395"
 Parameter: YMIN -> "-20.9319395"
 Parameter: ZMAX -> "-13.7871979"
 Parameter: ZMIN -> "-20.7871979"
 SELRPN>      4 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      4 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
 5505 POS      NA       9        NA      -3997 MEMB     DPPC     334      NC3           3.7678
 5505 POS      NA       9        NA      -3998 MEMB     DPPC     334      PO4           2.3920
 5505 POS      NA       9        NA      -3999 MEMB     DPPC     334      GL1           3.9669
 5505 POS      NA       9        NA      -4000 MEMB     DPPC     334      GL2           3.8023
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         4
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "4"
 Comparing "4" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "9"
Evaluating: 9
 Parameter: J <- "9"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "9" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "9"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.612733824"
Evaluating: 120.112447*(0.612733824-0.5)
 Parameter: XPOS <- "13.5407355"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.946598417"
Evaluating: 120.112447*(0.946598417-0.5)
 Parameter: YPOS <- "53.6420287"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.415653236"
Evaluating: 85*(0.415653236-0.5)+0
 Parameter: ZPOS <- "-7.16947494"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-7.16947494" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-7.16947494" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "5"
Evaluating: 5+1
 Parameter: CNTRAND <- "6"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "6" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "9"
Evaluating: 9
 Parameter: J <- "9"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "9" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "9"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.48245369"
Evaluating: 120.112447*(0.48245369-0.5)
 Parameter: XPOS <- "-2.10753023"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.814892798"
Evaluating: 120.112447*(0.814892798-0.5)
 Parameter: YPOS <- "37.8225445"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.375742105"
Evaluating: 85*(0.375742105-0.5)+0
 Parameter: ZPOS <- "-10.5619211"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-10.5619211" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-10.5619211" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "6"
Evaluating: 6+1
 Parameter: CNTRAND <- "7"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "7" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "9"
Evaluating: 9
 Parameter: J <- "9"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "9" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "9"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.540454979"
Evaluating: 120.112447*(0.540454979-0.5)
 Parameter: XPOS <- "4.85914652"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.253732188"
Evaluating: 120.112447*(0.253732188-0.5)
 Parameter: YPOS <- "-29.5798295"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.284997932"
Evaluating: 85*(0.284997932-0.5)+0
 Parameter: ZPOS <- "-18.2751758"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-18.2751758" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   42.432898 XMAX =   42.432898 XAVE =   42.432898
    YMIN =  -17.431939 YMAX =  -17.431939 YAVE =  -17.431939
    ZMIN =  -17.287198 ZMAX =  -17.287198 ZAVE =  -17.287198
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "4.85914652"
 RDCMND substituted energy or value "?XAVE" to "42.4328984"
Evaluating: 4.85914652-42.4328984
 Parameter: XTRAN <- "-37.5737519"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-29.5798295"
 RDCMND substituted energy or value "?YAVE" to "-17.4319395"
Evaluating: -29.5798295--17.4319395
 Parameter: YTRAN <- "-12.14789"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-18.2751758"
 RDCMND substituted energy or value "?ZAVE" to "-17.2871979"
Evaluating: -18.2751758--17.2871979
 Parameter: ZTRAN <- "-0.9879779"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-37.5737519"
 Parameter: YTRAN -> "-12.14789"
 Parameter: ZTRAN -> "-0.9879779"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR   -37.573752  -12.147890   -0.987978
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.352748996"
Evaluating: 0.352748996*360.0
 Parameter: XPHI <- "126.989639"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.588684506"
Evaluating: 0.588684506*360.0
 Parameter: YPHI <- "211.926422"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.276978713"
Evaluating: 0.276978713*360.0
 Parameter: ZPHI <- "99.7123367"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "4.85914652"
 Parameter: YPOS -> "-29.5798295"
 Parameter: ZPOS -> "-18.2751758"
 Parameter: XPHI -> "126.989639"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.601671    0.798744
    0.000000   -0.798744   -0.601671

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  126.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "4.85914652"
 Parameter: YPOS -> "-29.5798295"
 Parameter: ZPOS -> "-18.2751758"
 Parameter: YPHI -> "211.926422"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.848728    0.000000    0.528830
    0.000000    1.000000    0.000000
   -0.528830    0.000000   -0.848728

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  148.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "4.85914652"
 Parameter: YPOS -> "-29.5798295"
 Parameter: ZPOS -> "-18.2751758"
 Parameter: ZPHI -> "99.7123367"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.168702    0.985667    0.000000
   -0.985667   -0.168702    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   99.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    4.859147 XMAX =    4.859147 XAVE =    4.859147
    YMIN =  -29.579830 YMAX =  -29.579830 YAVE =  -29.579830
    ZMIN =  -18.275176 ZMAX =  -18.275176 ZAVE =  -18.275176
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "4.85914652"
Evaluating: 4.85914652+3.5
 Parameter: XMAX <- "8.35914652"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-29.5798295"
Evaluating: -29.5798295+3.5
 Parameter: YMAX <- "-26.0798295"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-18.2751758"
Evaluating: -18.2751758+3.5
 Parameter: ZMAX <- "-14.7751758"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "4.85914652"
Evaluating: 4.85914652-3.5
 Parameter: XMIN <- "1.35914652"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-29.5798295"
Evaluating: -29.5798295-3.5
 Parameter: YMIN <- "-33.0798295"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-18.2751758"
Evaluating: -18.2751758-3.5
 Parameter: ZMIN <- "-21.7751758"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "8.35914652"
 Parameter: XMIN -> "1.35914652"
 Parameter: YMAX -> "-26.0798295"
 Parameter: YMIN -> "-33.0798295"
 Parameter: ZMAX -> "-14.7751758"
 Parameter: ZMIN -> "-21.7751758"
 SELRPN>      2 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      2 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
 5505 POS      NA       9        NA      -3301 MEMB     DPPC     276      NC3           2.9333
 5505 POS      NA       9        NA      -3302 MEMB     DPPC     276      PO4           2.4294
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "7"
Evaluating: 7+1
 Parameter: CNTRAND <- "8"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "8" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "9"
Evaluating: 9
 Parameter: J <- "9"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "9" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "9"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.442889211"
Evaluating: 120.112447*(0.442889211-0.5)
 Parameter: XPOS <- "-6.85971662"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.697698552"
Evaluating: 120.112447*(0.697698552-0.5)
 Parameter: YPOS <- "23.7460568"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.404506236"
Evaluating: 85*(0.404506236-0.5)+0
 Parameter: ZPOS <- "-8.11696994"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-8.11696994" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-8.11696994" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "8"
Evaluating: 8+1
 Parameter: CNTRAND <- "9"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "9" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "9"
Evaluating: 9
 Parameter: J <- "9"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "9" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "9"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.382455456"
Evaluating: 120.112447*(0.382455456-0.5)
 Parameter: XPOS <- "-14.1185628"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.878059286"
Evaluating: 120.112447*(0.878059286-0.5)
 Parameter: YPOS <- "45.409626"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.853600068"
Evaluating: 85*(0.853600068-0.5)+0
 Parameter: ZPOS <- "30.0560058"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "30.0560058" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "30.0560058" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    4.859147 XMAX =    4.859147 XAVE =    4.859147
    YMIN =  -29.579830 YMAX =  -29.579830 YAVE =  -29.579830
    ZMIN =  -18.275176 ZMAX =  -18.275176 ZAVE =  -18.275176
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-14.1185628"
 RDCMND substituted energy or value "?XAVE" to "4.85914652"
Evaluating: -14.1185628-4.85914652
 Parameter: XTRAN <- "-18.9777093"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "45.409626"
 RDCMND substituted energy or value "?YAVE" to "-29.5798295"
Evaluating: 45.409626--29.5798295
 Parameter: YTRAN <- "74.9894555"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "30.0560058"
 RDCMND substituted energy or value "?ZAVE" to "-18.2751758"
Evaluating: 30.0560058--18.2751758
 Parameter: ZTRAN <- "48.3311816"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-18.9777093"
 Parameter: YTRAN -> "74.9894555"
 Parameter: ZTRAN -> "48.3311816"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR   -18.977709   74.989456   48.331182
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.648876253"
Evaluating: 0.648876253*360.0
 Parameter: XPHI <- "233.595451"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.835590632"
Evaluating: 0.835590632*360.0
 Parameter: YPHI <- "300.812628"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.507862825"
Evaluating: 0.507862825*360.0
 Parameter: ZPHI <- "182.830617"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-14.1185628"
 Parameter: YPOS -> "45.409626"
 Parameter: ZPOS -> "30.0560058"
 Parameter: XPHI -> "233.595451"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.593483   -0.804847
    0.000000    0.804847   -0.593483

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  126.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-14.1185628"
 Parameter: YPOS -> "45.409626"
 Parameter: ZPOS -> "30.0560058"
 Parameter: YPHI -> "300.812628"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.512232    0.000000    0.858847
    0.000000    1.000000    0.000000
   -0.858847    0.000000    0.512232

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   59.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-14.1185628"
 Parameter: YPOS -> "45.409626"
 Parameter: ZPOS -> "30.0560058"
 Parameter: ZPHI -> "182.830617"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.998780   -0.049383    0.000000
    0.049383   -0.998780    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  177.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -14.118563 XMAX =  -14.118563 XAVE =  -14.118563
    YMIN =   45.409626 YMAX =   45.409626 YAVE =   45.409626
    ZMIN =   30.056006 ZMAX =   30.056006 ZAVE =   30.056006
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-14.1185628"
Evaluating: -14.1185628+3.5
 Parameter: XMAX <- "-10.6185628"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "45.409626"
Evaluating: 45.409626+3.5
 Parameter: YMAX <- "48.909626"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "30.0560058"
Evaluating: 30.0560058+3.5
 Parameter: ZMAX <- "33.5560058"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-14.1185628"
Evaluating: -14.1185628-3.5
 Parameter: XMIN <- "-17.6185628"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "45.409626"
Evaluating: 45.409626-3.5
 Parameter: YMIN <- "41.909626"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "30.0560058"
Evaluating: 30.0560058-3.5
 Parameter: ZMIN <- "26.5560058"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-10.6185628"
 Parameter: XMIN -> "-17.6185628"
 Parameter: YMAX -> "48.909626"
 Parameter: YMIN -> "41.909626"
 Parameter: ZMAX -> "33.5560058"
 Parameter: ZMIN -> "26.5560058"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "10"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "10" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "10"
Evaluating: 10
 Parameter: J <- "10"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "10" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "10"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.576334316"
Evaluating: 120.112447*(0.576334316-0.5)
 Parameter: XPOS <- "9.16870148"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.272919209"
Evaluating: 120.112447*(0.272919209-0.5)
 Parameter: YPOS <- "-27.2752295"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.700030157"
Evaluating: 85*(0.700030157-0.5)+0
 Parameter: ZPOS <- "17.0025633"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "17.0025633" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "17.0025633" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "9.16870148"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 9.16870148-0
 Parameter: XTRAN <- "9.16870148"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-27.2752295"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -27.2752295-0
 Parameter: YTRAN <- "-27.2752295"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "17.0025633"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 17.0025633-0
 Parameter: ZTRAN <- "17.0025633"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "9.16870148"
 Parameter: YTRAN -> "-27.2752295"
 Parameter: ZTRAN -> "17.0025633"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR     9.168701  -27.275229   17.002563
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.294142437"
Evaluating: 0.294142437*360.0
 Parameter: XPHI <- "105.891277"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.518521189"
Evaluating: 0.518521189*360.0
 Parameter: YPHI <- "186.667628"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.809612425"
Evaluating: 0.809612425*360.0
 Parameter: ZPHI <- "291.460473"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "9.16870148"
 Parameter: YPOS -> "-27.2752295"
 Parameter: ZPOS -> "17.0025633"
 Parameter: XPHI -> "105.891277"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.273813    0.961783
    0.000000   -0.961783   -0.273813

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  105.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "9.16870148"
 Parameter: YPOS -> "-27.2752295"
 Parameter: ZPOS -> "17.0025633"
 Parameter: YPHI -> "186.667628"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.993236    0.000000    0.116110
    0.000000    1.000000    0.000000
   -0.116110    0.000000   -0.993236

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  173.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "9.16870148"
 Parameter: YPOS -> "-27.2752295"
 Parameter: ZPOS -> "17.0025633"
 Parameter: ZPHI -> "291.460473"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.365859   -0.930670    0.000000
    0.930670    0.365859    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   68.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    9.168701 XMAX =    9.168701 XAVE =    9.168701
    YMIN =  -27.275229 YMAX =  -27.275229 YAVE =  -27.275229
    ZMIN =   17.002563 ZMAX =   17.002563 ZAVE =   17.002563
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "9.16870148"
Evaluating: 9.16870148+3.5
 Parameter: XMAX <- "12.6687015"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-27.2752295"
Evaluating: -27.2752295+3.5
 Parameter: YMAX <- "-23.7752295"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "17.0025633"
Evaluating: 17.0025633+3.5
 Parameter: ZMAX <- "20.5025633"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "9.16870148"
Evaluating: 9.16870148-3.5
 Parameter: XMIN <- "5.66870148"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-27.2752295"
Evaluating: -27.2752295-3.5
 Parameter: YMIN <- "-30.7752295"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "17.0025633"
Evaluating: 17.0025633-3.5
 Parameter: ZMIN <- "13.5025633"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "12.6687015"
 Parameter: XMIN -> "5.66870148"
 Parameter: YMAX -> "-23.7752295"
 Parameter: YMIN -> "-30.7752295"
 Parameter: ZMAX -> "20.5025633"
 Parameter: ZMIN -> "13.5025633"
 SELRPN>      3 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      3 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
 5506 POS      NA       10       NA      - 457 MEMB     DPPC     39       NC3           3.8666
 5506 POS      NA       10       NA      - 458 MEMB     DPPC     39       PO4           3.5003
 5506 POS      NA       10       NA      - 459 MEMB     DPPC     39       GL1           3.5296
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         3
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "3"
 Comparing "3" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "10"
Evaluating: 10
 Parameter: J <- "10"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "10" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "10"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.320491704"
Evaluating: 120.112447*(0.320491704-0.5)
 Parameter: XPOS <- "-21.5611807"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "7.097853181E-03"
Evaluating: 120.112447*(7.097853181E-03-0.5)
 Parameter: YPOS <- "-59.203683"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.795951651"
Evaluating: 85*(0.795951651-0.5)+0
 Parameter: ZPOS <- "25.1558903"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "25.1558903" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "25.1558903" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    9.168701 XMAX =    9.168701 XAVE =    9.168701
    YMIN =  -27.275229 YMAX =  -27.275229 YAVE =  -27.275229
    ZMIN =   17.002563 ZMAX =   17.002563 ZAVE =   17.002563
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-21.5611807"
 RDCMND substituted energy or value "?XAVE" to "9.16870148"
Evaluating: -21.5611807-9.16870148
 Parameter: XTRAN <- "-30.7298822"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-59.203683"
 RDCMND substituted energy or value "?YAVE" to "-27.2752295"
Evaluating: -59.203683--27.2752295
 Parameter: YTRAN <- "-31.9284535"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "25.1558903"
 RDCMND substituted energy or value "?ZAVE" to "17.0025633"
Evaluating: 25.1558903-17.0025633
 Parameter: ZTRAN <- "8.153327"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-30.7298822"
 Parameter: YTRAN -> "-31.9284535"
 Parameter: ZTRAN -> "8.153327"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR   -30.729882  -31.928453    8.153327
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.527946126"
Evaluating: 0.527946126*360.0
 Parameter: XPHI <- "190.060605"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.80039782"
Evaluating: 0.80039782*360.0
 Parameter: YPHI <- "288.143215"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.362769904"
Evaluating: 0.362769904*360.0
 Parameter: ZPHI <- "130.597165"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-21.5611807"
 Parameter: YPOS -> "-59.203683"
 Parameter: ZPOS -> "25.1558903"
 Parameter: XPHI -> "190.060605"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.984624   -0.174690
    0.000000    0.174690   -0.984624

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  169.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-21.5611807"
 Parameter: YPOS -> "-59.203683"
 Parameter: ZPOS -> "25.1558903"
 Parameter: YPHI -> "288.143215"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.311393    0.000000    0.950281
    0.000000    1.000000    0.000000
   -0.950281    0.000000    0.311393

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   71.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-21.5611807"
 Parameter: YPOS -> "-59.203683"
 Parameter: ZPOS -> "25.1558903"
 Parameter: ZPHI -> "130.597165"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.650737    0.759304    0.000000
   -0.759304   -0.650737    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  130.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -21.561181 XMAX =  -21.561181 XAVE =  -21.561181
    YMIN =  -59.203683 YMAX =  -59.203683 YAVE =  -59.203683
    ZMIN =   25.155890 ZMAX =   25.155890 ZAVE =   25.155890
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-21.5611807"
Evaluating: -21.5611807+3.5
 Parameter: XMAX <- "-18.0611807"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-59.203683"
Evaluating: -59.203683+3.5
 Parameter: YMAX <- "-55.703683"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "25.1558903"
Evaluating: 25.1558903+3.5
 Parameter: ZMAX <- "28.6558903"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-21.5611807"
Evaluating: -21.5611807-3.5
 Parameter: XMIN <- "-25.0611807"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-59.203683"
Evaluating: -59.203683-3.5
 Parameter: YMIN <- "-62.703683"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "25.1558903"
Evaluating: 25.1558903-3.5
 Parameter: ZMIN <- "21.6558903"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-18.0611807"
 Parameter: XMIN -> "-25.0611807"
 Parameter: YMAX -> "-55.703683"
 Parameter: YMIN -> "-62.703683"
 Parameter: ZMAX -> "28.6558903"
 Parameter: ZMIN -> "21.6558903"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "11"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "11" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "11"
Evaluating: 11
 Parameter: J <- "11"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "11" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "11"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.959468823"
Evaluating: 120.112447*(0.959468823-0.5)
 Parameter: XPOS <- "55.1879247"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.558329082"
Evaluating: 120.112447*(0.558329082-0.5)
 Parameter: YPOS <- "7.00604877"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.245930186"
Evaluating: 85*(0.245930186-0.5)+0
 Parameter: ZPOS <- "-21.5959342"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-21.5959342" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "55.1879247"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 55.1879247-0
 Parameter: XTRAN <- "55.1879247"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "7.00604877"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 7.00604877-0
 Parameter: YTRAN <- "7.00604877"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-21.5959342"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -21.5959342-0
 Parameter: ZTRAN <- "-21.5959342"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "55.1879247"
 Parameter: YTRAN -> "7.00604877"
 Parameter: ZTRAN -> "-21.5959342"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    55.187925    7.006049  -21.595934
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.724022624E-02"
Evaluating: 2.724022624E-02*360.0
 Parameter: XPHI <- "9.80648145"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.277972"
Evaluating: 0.277972*360.0
 Parameter: YPHI <- "100.06992"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.880550028"
Evaluating: 0.880550028*360.0
 Parameter: ZPHI <- "316.99801"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "55.1879247"
 Parameter: YPOS -> "7.00604877"
 Parameter: ZPOS -> "-21.5959342"
 Parameter: XPHI -> "9.80648145"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.985389    0.170321
    0.000000   -0.170321    0.985389

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    9.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "55.1879247"
 Parameter: YPOS -> "7.00604877"
 Parameter: ZPOS -> "-21.5959342"
 Parameter: YPHI -> "100.06992"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.174850    0.000000   -0.984595
    0.000000    1.000000    0.000000
    0.984595    0.000000   -0.174850

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  100.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "55.1879247"
 Parameter: YPOS -> "7.00604877"
 Parameter: ZPOS -> "-21.5959342"
 Parameter: ZPHI -> "316.99801"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.731330   -0.682024    0.000000
    0.682024    0.731330    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   43.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   55.187925 XMAX =   55.187925 XAVE =   55.187925
    YMIN =    7.006049 YMAX =    7.006049 YAVE =    7.006049
    ZMIN =  -21.595934 ZMAX =  -21.595934 ZAVE =  -21.595934
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "55.1879247"
Evaluating: 55.1879247+3.5
 Parameter: XMAX <- "58.6879247"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "7.00604877"
Evaluating: 7.00604877+3.5
 Parameter: YMAX <- "10.5060488"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-21.5959342"
Evaluating: -21.5959342+3.5
 Parameter: ZMAX <- "-18.0959342"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "55.1879247"
Evaluating: 55.1879247-3.5
 Parameter: XMIN <- "51.6879247"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "7.00604877"
Evaluating: 7.00604877-3.5
 Parameter: YMIN <- "3.50604877"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-21.5959342"
Evaluating: -21.5959342-3.5
 Parameter: ZMIN <- "-25.0959342"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "58.6879247"
 Parameter: XMIN -> "51.6879247"
 Parameter: YMAX -> "10.5060488"
 Parameter: YMIN -> "3.50604877"
 Parameter: ZMAX -> "-18.0959342"
 Parameter: ZMIN -> "-25.0959342"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "12"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "12" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "12"
Evaluating: 12
 Parameter: J <- "12"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "12" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "12"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.297037208"
Evaluating: 120.112447*(0.297037208-0.5)
 Parameter: XPOS <- "-24.3783576"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.588726099"
Evaluating: 120.112447*(0.588726099-0.5)
 Parameter: YPOS <- "10.6571089"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.693697769"
Evaluating: 85*(0.693697769-0.5)+0
 Parameter: ZPOS <- "16.4643104"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "16.4643104" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "16.4643104" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-24.3783576"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -24.3783576-0
 Parameter: XTRAN <- "-24.3783576"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "10.6571089"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 10.6571089-0
 Parameter: YTRAN <- "10.6571089"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "16.4643104"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 16.4643104-0
 Parameter: ZTRAN <- "16.4643104"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-24.3783576"
 Parameter: YTRAN -> "10.6571089"
 Parameter: ZTRAN -> "16.4643104"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR   -24.378358   10.657109   16.464310
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.882333903"
Evaluating: 0.882333903*360.0
 Parameter: XPHI <- "317.640205"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.771388395E-03"
Evaluating: 2.771388395E-03*360.0
 Parameter: YPHI <- "0.997699822"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.625044662"
Evaluating: 0.625044662*360.0
 Parameter: ZPHI <- "225.016078"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-24.3783576"
 Parameter: YPOS -> "10.6571089"
 Parameter: ZPOS -> "16.4643104"
 Parameter: XPHI -> "317.640205"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.738928   -0.673784
    0.000000    0.673784    0.738928

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   42.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-24.3783576"
 Parameter: YPOS -> "10.6571089"
 Parameter: ZPOS -> "16.4643104"
 Parameter: YPHI -> "0.997699822"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.999848    0.000000   -0.017412
    0.000000    1.000000    0.000000
    0.017412    0.000000    0.999848

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    1.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-24.3783576"
 Parameter: YPOS -> "10.6571089"
 Parameter: ZPOS -> "16.4643104"
 Parameter: ZPHI -> "225.016078"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.706908   -0.707305    0.000000
    0.707305   -0.706908    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  134.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -24.378358 XMAX =  -24.378358 XAVE =  -24.378358
    YMIN =   10.657109 YMAX =   10.657109 YAVE =   10.657109
    ZMIN =   16.464310 ZMAX =   16.464310 ZAVE =   16.464310
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-24.3783576"
Evaluating: -24.3783576+3.5
 Parameter: XMAX <- "-20.8783576"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "10.6571089"
Evaluating: 10.6571089+3.5
 Parameter: YMAX <- "14.1571089"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "16.4643104"
Evaluating: 16.4643104+3.5
 Parameter: ZMAX <- "19.9643104"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-24.3783576"
Evaluating: -24.3783576-3.5
 Parameter: XMIN <- "-27.8783576"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "10.6571089"
Evaluating: 10.6571089-3.5
 Parameter: YMIN <- "7.1571089"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "16.4643104"
Evaluating: 16.4643104-3.5
 Parameter: ZMIN <- "12.9643104"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-20.8783576"
 Parameter: XMIN -> "-27.8783576"
 Parameter: YMAX -> "14.1571089"
 Parameter: YMIN -> "7.1571089"
 Parameter: ZMAX -> "19.9643104"
 Parameter: ZMIN -> "12.9643104"
 SELRPN>      3 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      3 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
 5508 POS      NA       12       NA      - 267 MEMB     DPPC     23       GL1           3.9930
 5508 POS      NA       12       NA      - 268 MEMB     DPPC     23       GL2           3.8882
 5508 POS      NA       12       NA      - 518 MEMB     DPPC     44       PO4           2.7321
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         3
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "3"
 Comparing "3" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "12"
Evaluating: 12
 Parameter: J <- "12"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "12" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "12"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.348399582"
Evaluating: 120.112447*(0.348399582-0.5)
 Parameter: XPOS <- "-18.2090972"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "4.788715162E-02"
Evaluating: 120.112447*(4.788715162E-02-0.5)
 Parameter: YPOS <- "-54.3043805"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.221861732"
Evaluating: 85*(0.221861732-0.5)+0
 Parameter: ZPOS <- "-23.6417528"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-23.6417528" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -24.378358 XMAX =  -24.378358 XAVE =  -24.378358
    YMIN =   10.657109 YMAX =   10.657109 YAVE =   10.657109
    ZMIN =   16.464310 ZMAX =   16.464310 ZAVE =   16.464310
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-18.2090972"
 RDCMND substituted energy or value "?XAVE" to "-24.3783576"
Evaluating: -18.2090972--24.3783576
 Parameter: XTRAN <- "6.1692604"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-54.3043805"
 RDCMND substituted energy or value "?YAVE" to "10.6571089"
Evaluating: -54.3043805-10.6571089
 Parameter: YTRAN <- "-64.9614894"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-23.6417528"
 RDCMND substituted energy or value "?ZAVE" to "16.4643104"
Evaluating: -23.6417528-16.4643104
 Parameter: ZTRAN <- "-40.1060632"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "6.1692604"
 Parameter: YTRAN -> "-64.9614894"
 Parameter: ZTRAN -> "-40.1060632"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR     6.169260  -64.961489  -40.106063
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.699090626"
Evaluating: 0.699090626*360.0
 Parameter: XPHI <- "251.672625"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.634893854"
Evaluating: 0.634893854*360.0
 Parameter: YPHI <- "228.561787"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.877021781"
Evaluating: 0.877021781*360.0
 Parameter: ZPHI <- "315.727841"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-18.2090972"
 Parameter: YPOS -> "-54.3043805"
 Parameter: ZPOS -> "-23.6417528"
 Parameter: XPHI -> "251.672625"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.314446   -0.949275
    0.000000    0.949275   -0.314446

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  108.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-18.2090972"
 Parameter: YPOS -> "-54.3043805"
 Parameter: ZPOS -> "-23.6417528"
 Parameter: YPHI -> "228.561787"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.661812    0.000000    0.749670
    0.000000    1.000000    0.000000
   -0.749670    0.000000   -0.661812

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  131.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-18.2090972"
 Parameter: YPOS -> "-54.3043805"
 Parameter: ZPOS -> "-23.6417528"
 Parameter: ZPHI -> "315.727841"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.716032   -0.698067    0.000000
    0.698067    0.716032    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   44.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -18.209097 XMAX =  -18.209097 XAVE =  -18.209097
    YMIN =  -54.304381 YMAX =  -54.304381 YAVE =  -54.304381
    ZMIN =  -23.641753 ZMAX =  -23.641753 ZAVE =  -23.641753
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-18.2090972"
Evaluating: -18.2090972+3.5
 Parameter: XMAX <- "-14.7090972"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-54.3043805"
Evaluating: -54.3043805+3.5
 Parameter: YMAX <- "-50.8043805"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-23.6417528"
Evaluating: -23.6417528+3.5
 Parameter: ZMAX <- "-20.1417528"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-18.2090972"
Evaluating: -18.2090972-3.5
 Parameter: XMIN <- "-21.7090972"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-54.3043805"
Evaluating: -54.3043805-3.5
 Parameter: YMIN <- "-57.8043805"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-23.6417528"
Evaluating: -23.6417528-3.5
 Parameter: ZMIN <- "-27.1417528"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-14.7090972"
 Parameter: XMIN -> "-21.7090972"
 Parameter: YMAX -> "-50.8043805"
 Parameter: YMIN -> "-57.8043805"
 Parameter: ZMAX -> "-20.1417528"
 Parameter: ZMIN -> "-27.1417528"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "13"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "13" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "13"
Evaluating: 13
 Parameter: J <- "13"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "13" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "13"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.222119196"
Evaluating: 120.112447*(0.222119196-0.5)
 Parameter: XPOS <- "-33.3769433"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "7.583017349E-02"
Evaluating: 120.112447*(7.583017349E-02-0.5)
 Parameter: YPOS <- "-50.9480758"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.145815591"
Evaluating: 85*(0.145815591-0.5)+0
 Parameter: ZPOS <- "-30.1056748"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-30.1056748" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-33.3769433"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -33.3769433-0
 Parameter: XTRAN <- "-33.3769433"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-50.9480758"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -50.9480758-0
 Parameter: YTRAN <- "-50.9480758"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-30.1056748"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -30.1056748-0
 Parameter: ZTRAN <- "-30.1056748"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-33.3769433"
 Parameter: YTRAN -> "-50.9480758"
 Parameter: ZTRAN -> "-30.1056748"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR   -33.376943  -50.948076  -30.105675
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.252434715"
Evaluating: 0.252434715*360.0
 Parameter: XPHI <- "90.8764974"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.139932282E-03"
Evaluating: 8.139932282E-03*360.0
 Parameter: YPHI <- "2.93037562"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.347823126"
Evaluating: 0.347823126*360.0
 Parameter: ZPHI <- "125.216325"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-33.3769433"
 Parameter: YPOS -> "-50.9480758"
 Parameter: ZPOS -> "-30.1056748"
 Parameter: XPHI -> "90.8764974"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.015297    0.999883
    0.000000   -0.999883   -0.015297

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   90.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-33.3769433"
 Parameter: YPOS -> "-50.9480758"
 Parameter: ZPOS -> "-30.1056748"
 Parameter: YPHI -> "2.93037562"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.998692    0.000000   -0.051122
    0.000000    1.000000    0.000000
    0.051122    0.000000    0.998692

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    2.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-33.3769433"
 Parameter: YPOS -> "-50.9480758"
 Parameter: ZPOS -> "-30.1056748"
 Parameter: ZPHI -> "125.216325"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.576665    0.816981    0.000000
   -0.816981   -0.576665    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  125.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -33.376943 XMAX =  -33.376943 XAVE =  -33.376943
    YMIN =  -50.948076 YMAX =  -50.948076 YAVE =  -50.948076
    ZMIN =  -30.105675 ZMAX =  -30.105675 ZAVE =  -30.105675
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-33.3769433"
Evaluating: -33.3769433+3.5
 Parameter: XMAX <- "-29.8769433"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-50.9480758"
Evaluating: -50.9480758+3.5
 Parameter: YMAX <- "-47.4480758"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-30.1056748"
Evaluating: -30.1056748+3.5
 Parameter: ZMAX <- "-26.6056748"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-33.3769433"
Evaluating: -33.3769433-3.5
 Parameter: XMIN <- "-36.8769433"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-50.9480758"
Evaluating: -50.9480758-3.5
 Parameter: YMIN <- "-54.4480758"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-30.1056748"
Evaluating: -30.1056748-3.5
 Parameter: ZMIN <- "-33.6056748"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-29.8769433"
 Parameter: XMIN -> "-36.8769433"
 Parameter: YMAX -> "-47.4480758"
 Parameter: YMIN -> "-54.4480758"
 Parameter: ZMAX -> "-26.6056748"
 Parameter: ZMIN -> "-33.6056748"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "14"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "14" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "14"
Evaluating: 14
 Parameter: J <- "14"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "14" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "14"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.507651599"
Evaluating: 120.112447*(0.507651599-0.5)
 Parameter: XPOS <- "0.919052279"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.85543581"
Evaluating: 120.112447*(0.85543581-0.5)
 Parameter: YPOS <- "42.6922649"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.703828976"
Evaluating: 85*(0.703828976-0.5)+0
 Parameter: ZPOS <- "17.325463"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "17.325463" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "17.325463" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "0.919052279"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 0.919052279-0
 Parameter: XTRAN <- "0.919052279"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "42.6922649"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 42.6922649-0
 Parameter: YTRAN <- "42.6922649"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "17.325463"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 17.325463-0
 Parameter: ZTRAN <- "17.325463"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "0.919052279"
 Parameter: YTRAN -> "42.6922649"
 Parameter: ZTRAN -> "17.325463"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR     0.919052   42.692265   17.325463
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.822894879"
Evaluating: 0.822894879*360.0
 Parameter: XPHI <- "296.242156"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.37967718"
Evaluating: 0.37967718*360.0
 Parameter: YPHI <- "136.683785"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.918801466E-02"
Evaluating: 2.918801466E-02*360.0
 Parameter: ZPHI <- "10.5076853"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "0.919052279"
 Parameter: YPOS -> "42.6922649"
 Parameter: ZPOS -> "17.325463"
 Parameter: XPHI -> "296.242156"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.442166   -0.896933
    0.000000    0.896933    0.442166

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   63.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "0.919052279"
 Parameter: YPOS -> "42.6922649"
 Parameter: ZPOS -> "17.325463"
 Parameter: YPHI -> "136.683785"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.727579    0.000000   -0.686024
    0.000000    1.000000    0.000000
    0.686024    0.000000   -0.727579

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  136.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "0.919052279"
 Parameter: YPOS -> "42.6922649"
 Parameter: ZPOS -> "17.325463"
 Parameter: ZPHI -> "10.5076853"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.983230    0.182367    0.000000
   -0.182367    0.983230    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   10.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.919052 XMAX =    0.919052 XAVE =    0.919052
    YMIN =   42.692265 YMAX =   42.692265 YAVE =   42.692265
    ZMIN =   17.325463 ZMAX =   17.325463 ZAVE =   17.325463
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "0.919052279"
Evaluating: 0.919052279+3.5
 Parameter: XMAX <- "4.41905228"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "42.6922649"
Evaluating: 42.6922649+3.5
 Parameter: YMAX <- "46.1922649"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "17.325463"
Evaluating: 17.325463+3.5
 Parameter: ZMAX <- "20.825463"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "0.919052279"
Evaluating: 0.919052279-3.5
 Parameter: XMIN <- "-2.58094772"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "42.6922649"
Evaluating: 42.6922649-3.5
 Parameter: YMIN <- "39.1922649"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "17.325463"
Evaluating: 17.325463-3.5
 Parameter: ZMIN <- "13.825463"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "4.41905228"
 Parameter: XMIN -> "-2.58094772"
 Parameter: YMAX -> "46.1922649"
 Parameter: YMIN -> "39.1922649"
 Parameter: ZMAX -> "20.825463"
 Parameter: ZMIN -> "13.825463"
 SELRPN>      2 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      2 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "15"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "15" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "15"
Evaluating: 15
 Parameter: J <- "15"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "15" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "15"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.264477938"
Evaluating: 120.112447*(0.264477938-0.5)
 Parameter: XPOS <- "-28.2891312"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.308922598"
Evaluating: 120.112447*(0.308922598-0.5)
 Parameter: YPOS <- "-22.9507743"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.546253323"
Evaluating: 85*(0.546253323-0.5)+0
 Parameter: ZPOS <- "3.93153245"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "3.93153245" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "3.93153245" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "15"
Evaluating: 15
 Parameter: J <- "15"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "15" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "15"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "6.090109578E-02"
Evaluating: 120.112447*(6.090109578E-02-0.5)
 Parameter: XPOS <- "-52.7412439"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.228623174"
Evaluating: 120.112447*(0.228623174-0.5)
 Parameter: YPOS <- "-32.5957346"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.412885839"
Evaluating: 85*(0.412885839-0.5)+0
 Parameter: ZPOS <- "-7.40470368"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-7.40470368" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-7.40470368" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "15"
Evaluating: 15
 Parameter: J <- "15"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "15" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "15"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.42462642"
Evaluating: 120.112447*(0.42462642-0.5)
 Parameter: XPOS <- "-9.05330513"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "1.342287182E-02"
Evaluating: 120.112447*(1.342287182E-02-0.5)
 Parameter: YPOS <- "-58.4439695"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.636385498"
Evaluating: 85*(0.636385498-0.5)+0
 Parameter: ZPOS <- "11.5927673"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "11.5927673" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "11.5927673" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "15"
Evaluating: 15
 Parameter: J <- "15"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "15" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "15"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.615999446"
Evaluating: 120.112447*(0.615999446-0.5)
 Parameter: XPOS <- "13.9329773"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.768436757"
Evaluating: 120.112447*(0.768436757-0.5)
 Parameter: YPOS <- "32.2425957"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.471311433"
Evaluating: 85*(0.471311433-0.5)+0
 Parameter: ZPOS <- "-2.43852819"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-2.43852819" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-2.43852819" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "15"
Evaluating: 15
 Parameter: J <- "15"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "15" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "15"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.852094136"
Evaluating: 120.112447*(0.852094136-0.5)
 Parameter: XPOS <- "42.2908882"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.522948785"
Evaluating: 120.112447*(0.522948785-0.5)
 Parameter: YPOS <- "2.75643472"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "9.524811835E-02"
Evaluating: 85*(9.524811835E-02-0.5)+0
 Parameter: ZPOS <- "-34.4039099"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-34.4039099" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "42.2908882"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 42.2908882-0
 Parameter: XTRAN <- "42.2908882"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "2.75643472"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 2.75643472-0
 Parameter: YTRAN <- "2.75643472"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-34.4039099"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -34.4039099-0
 Parameter: ZTRAN <- "-34.4039099"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "42.2908882"
 Parameter: YTRAN -> "2.75643472"
 Parameter: ZTRAN -> "-34.4039099"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    42.290888    2.756435  -34.403910
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.591263096"
Evaluating: 0.591263096*360.0
 Parameter: XPHI <- "212.854715"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.91082712"
Evaluating: 0.91082712*360.0
 Parameter: YPHI <- "327.897763"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.36952568"
Evaluating: 0.36952568*360.0
 Parameter: ZPHI <- "133.029245"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "42.2908882"
 Parameter: YPOS -> "2.75643472"
 Parameter: ZPOS -> "-34.4039099"
 Parameter: XPHI -> "212.854715"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.840049   -0.542511
    0.000000    0.542511   -0.840049

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  147.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "42.2908882"
 Parameter: YPOS -> "2.75643472"
 Parameter: ZPOS -> "-34.4039099"
 Parameter: YPHI -> "327.897763"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.847101    0.000000    0.531432
    0.000000    1.000000    0.000000
   -0.531432    0.000000    0.847101

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   32.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "42.2908882"
 Parameter: YPOS -> "2.75643472"
 Parameter: ZPOS -> "-34.4039099"
 Parameter: ZPHI -> "133.029245"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.682372    0.731005    0.000000
   -0.731005   -0.682372    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  133.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   42.290888 XMAX =   42.290888 XAVE =   42.290888
    YMIN =    2.756435 YMAX =    2.756435 YAVE =    2.756435
    ZMIN =  -34.403910 ZMAX =  -34.403910 ZAVE =  -34.403910
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "42.2908882"
Evaluating: 42.2908882+3.5
 Parameter: XMAX <- "45.7908882"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "2.75643472"
Evaluating: 2.75643472+3.5
 Parameter: YMAX <- "6.25643472"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-34.4039099"
Evaluating: -34.4039099+3.5
 Parameter: ZMAX <- "-30.9039099"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "42.2908882"
Evaluating: 42.2908882-3.5
 Parameter: XMIN <- "38.7908882"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "2.75643472"
Evaluating: 2.75643472-3.5
 Parameter: YMIN <- "-0.74356528"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-34.4039099"
Evaluating: -34.4039099-3.5
 Parameter: ZMIN <- "-37.9039099"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "45.7908882"
 Parameter: XMIN -> "38.7908882"
 Parameter: YMAX -> "6.25643472"
 Parameter: YMIN -> "-0.74356528"
 Parameter: ZMAX -> "-30.9039099"
 Parameter: ZMIN -> "-37.9039099"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "16"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "16" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "16"
Evaluating: 16
 Parameter: J <- "16"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "16" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "16"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.492463528"
Evaluating: 120.112447*(0.492463528-0.5)
 Parameter: XPOS <- "-0.905224094"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.204832206"
Evaluating: 120.112447*(0.204832206-0.5)
 Parameter: YPOS <- "-35.453326"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.75136371"
Evaluating: 85*(0.75136371-0.5)+0
 Parameter: ZPOS <- "21.3659154"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "21.3659154" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "21.3659154" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-0.905224094"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -0.905224094-0
 Parameter: XTRAN <- "-0.905224094"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-35.453326"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -35.453326-0
 Parameter: YTRAN <- "-35.453326"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "21.3659154"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 21.3659154-0
 Parameter: ZTRAN <- "21.3659154"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-0.905224094"
 Parameter: YTRAN -> "-35.453326"
 Parameter: ZTRAN -> "21.3659154"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    -0.905224  -35.453326   21.365915
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.234545415E-02"
Evaluating: 6.234545415E-02*360.0
 Parameter: XPHI <- "22.4443635"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.41883175"
Evaluating: 0.41883175*360.0
 Parameter: YPHI <- "150.77943"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.343608074"
Evaluating: 0.343608074*360.0
 Parameter: ZPHI <- "123.698907"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-0.905224094"
 Parameter: YPOS -> "-35.453326"
 Parameter: ZPOS -> "21.3659154"
 Parameter: XPHI -> "22.4443635"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.924251    0.381786
    0.000000   -0.381786    0.924251

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   22.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-0.905224094"
 Parameter: YPOS -> "-35.453326"
 Parameter: ZPOS -> "21.3659154"
 Parameter: YPHI -> "150.77943"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.872747    0.000000   -0.488173
    0.000000    1.000000    0.000000
    0.488173    0.000000   -0.872747

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  150.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-0.905224094"
 Parameter: YPOS -> "-35.453326"
 Parameter: ZPOS -> "21.3659154"
 Parameter: ZPHI -> "123.698907"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.554829    0.831965    0.000000
   -0.831965   -0.554829    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  123.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -0.905224 XMAX =   -0.905224 XAVE =   -0.905224
    YMIN =  -35.453326 YMAX =  -35.453326 YAVE =  -35.453326
    ZMIN =   21.365915 ZMAX =   21.365915 ZAVE =   21.365915
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-0.905224094"
Evaluating: -0.905224094+3.5
 Parameter: XMAX <- "2.59477591"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-35.453326"
Evaluating: -35.453326+3.5
 Parameter: YMAX <- "-31.953326"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "21.3659154"
Evaluating: 21.3659154+3.5
 Parameter: ZMAX <- "24.8659154"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-0.905224094"
Evaluating: -0.905224094-3.5
 Parameter: XMIN <- "-4.40522409"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-35.453326"
Evaluating: -35.453326-3.5
 Parameter: YMIN <- "-38.953326"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "21.3659154"
Evaluating: 21.3659154-3.5
 Parameter: ZMIN <- "17.8659154"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "2.59477591"
 Parameter: XMIN -> "-4.40522409"
 Parameter: YMAX -> "-31.953326"
 Parameter: YMIN -> "-38.953326"
 Parameter: ZMAX -> "24.8659154"
 Parameter: ZMIN -> "17.8659154"
 SELRPN>      2 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      2 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
 5512 POS      NA       16       NA      - 554 MEMB     DPPC     47       PO4           3.8142
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "16"
Evaluating: 16
 Parameter: J <- "16"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "16" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "16"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.788464205"
Evaluating: 120.112447*(0.788464205-0.5)
 Parameter: XPOS <- "34.6481415"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.937276027"
Evaluating: 120.112447*(0.937276027-0.5)
 Parameter: YPOS <- "52.5222936"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.554407251"
Evaluating: 85*(0.554407251-0.5)+0
 Parameter: ZPOS <- "4.62461633"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "4.62461633" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "4.62461633" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "16"
Evaluating: 16
 Parameter: J <- "16"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "16" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "16"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.989701963"
Evaluating: 120.112447*(0.989701963-0.5)
 Parameter: XPOS <- "58.8193011"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.507191549"
Evaluating: 120.112447*(0.507191549-0.5)
 Parameter: YPOS <- "0.863794548"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.911112492"
Evaluating: 85*(0.911112492-0.5)+0
 Parameter: ZPOS <- "34.9445618"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "34.9445618" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "34.9445618" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -0.905224 XMAX =   -0.905224 XAVE =   -0.905224
    YMIN =  -35.453326 YMAX =  -35.453326 YAVE =  -35.453326
    ZMIN =   21.365915 ZMAX =   21.365915 ZAVE =   21.365915
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "58.8193011"
 RDCMND substituted energy or value "?XAVE" to "-0.905224094"
Evaluating: 58.8193011--0.905224094
 Parameter: XTRAN <- "59.7245252"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "0.863794548"
 RDCMND substituted energy or value "?YAVE" to "-35.453326"
Evaluating: 0.863794548--35.453326
 Parameter: YTRAN <- "36.3171205"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "34.9445618"
 RDCMND substituted energy or value "?ZAVE" to "21.3659154"
Evaluating: 34.9445618-21.3659154
 Parameter: ZTRAN <- "13.5786464"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "59.7245252"
 Parameter: YTRAN -> "36.3171205"
 Parameter: ZTRAN -> "13.5786464"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    59.724525   36.317121   13.578646
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.844111309"
Evaluating: 0.844111309*360.0
 Parameter: XPHI <- "303.880071"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.167705528"
Evaluating: 0.167705528*360.0
 Parameter: YPHI <- "60.3739901"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.603043061"
Evaluating: 0.603043061*360.0
 Parameter: ZPHI <- "217.095502"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "58.8193011"
 Parameter: YPOS -> "0.863794548"
 Parameter: ZPOS -> "34.9445618"
 Parameter: XPHI -> "303.880071"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.557456   -0.830206
    0.000000    0.830206    0.557456

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   56.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "58.8193011"
 Parameter: YPOS -> "0.863794548"
 Parameter: ZPOS -> "34.9445618"
 Parameter: YPHI -> "60.3739901"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.494337    0.000000   -0.869271
    0.000000    1.000000    0.000000
    0.869271    0.000000    0.494337

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   60.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "58.8193011"
 Parameter: YPOS -> "0.863794548"
 Parameter: ZPOS -> "34.9445618"
 Parameter: ZPHI -> "217.095502"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.797631   -0.603145    0.000000
    0.603145   -0.797631    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  142.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   58.819301 XMAX =   58.819301 XAVE =   58.819301
    YMIN =    0.863795 YMAX =    0.863795 YAVE =    0.863795
    ZMIN =   34.944562 ZMAX =   34.944562 ZAVE =   34.944562
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "58.8193011"
Evaluating: 58.8193011+3.5
 Parameter: XMAX <- "62.3193011"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "0.863794592"
Evaluating: 0.863794592+3.5
 Parameter: YMAX <- "4.36379459"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "34.9445618"
Evaluating: 34.9445618+3.5
 Parameter: ZMAX <- "38.4445618"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "58.8193011"
Evaluating: 58.8193011-3.5
 Parameter: XMIN <- "55.3193011"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "0.863794592"
Evaluating: 0.863794592-3.5
 Parameter: YMIN <- "-2.63620541"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "34.9445618"
Evaluating: 34.9445618-3.5
 Parameter: ZMIN <- "31.4445618"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "62.3193011"
 Parameter: XMIN -> "55.3193011"
 Parameter: YMAX -> "4.36379459"
 Parameter: YMIN -> "-2.63620541"
 Parameter: ZMAX -> "38.4445618"
 Parameter: ZMIN -> "31.4445618"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "17"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "17" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "17"
Evaluating: 17
 Parameter: J <- "17"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "17" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "17"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.515671832"
Evaluating: 120.112447*(0.515671832-0.5)
 Parameter: XPOS <- "1.88238209"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "8.650207488E-02"
Evaluating: 120.112447*(8.650207488E-02-0.5)
 Parameter: YPOS <- "-49.6662476"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "2.776799838E-02"
Evaluating: 85*(2.776799838E-02-0.5)+0
 Parameter: ZPOS <- "-40.1397201"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-40.1397201" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "1.88238209"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 1.88238209-0
 Parameter: XTRAN <- "1.88238209"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-49.6662476"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -49.6662476-0
 Parameter: YTRAN <- "-49.6662476"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-40.1397201"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -40.1397201-0
 Parameter: ZTRAN <- "-40.1397201"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "1.88238209"
 Parameter: YTRAN -> "-49.6662476"
 Parameter: ZTRAN -> "-40.1397201"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR     1.882382  -49.666248  -40.139720
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.020327303E-02"
Evaluating: 2.020327303E-02*360.0
 Parameter: XPHI <- "7.27317829"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.959165883"
Evaluating: 0.959165883*360.0
 Parameter: YPHI <- "345.299718"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.184786514"
Evaluating: 0.184786514*360.0
 Parameter: ZPHI <- "66.523145"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "1.88238209"
 Parameter: YPOS -> "-49.6662476"
 Parameter: ZPOS -> "-40.1397201"
 Parameter: XPHI -> "7.27317829"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.991954    0.126600
    0.000000   -0.126600    0.991954

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    7.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "1.88238209"
 Parameter: YPOS -> "-49.6662476"
 Parameter: ZPOS -> "-40.1397201"
 Parameter: YPHI -> "345.299718"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.967267    0.000000    0.253763
    0.000000    1.000000    0.000000
   -0.253763    0.000000    0.967267

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   14.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "1.88238209"
 Parameter: YPOS -> "-49.6662476"
 Parameter: ZPOS -> "-40.1397201"
 Parameter: ZPHI -> "66.523145"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.398379    0.917221    0.000000
   -0.917221    0.398379    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   66.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    1.882382 XMAX =    1.882382 XAVE =    1.882382
    YMIN =  -49.666248 YMAX =  -49.666248 YAVE =  -49.666248
    ZMIN =  -40.139720 ZMAX =  -40.139720 ZAVE =  -40.139720
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "1.88238209"
Evaluating: 1.88238209+3.5
 Parameter: XMAX <- "5.38238209"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-49.6662476"
Evaluating: -49.6662476+3.5
 Parameter: YMAX <- "-46.1662476"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-40.1397201"
Evaluating: -40.1397201+3.5
 Parameter: ZMAX <- "-36.6397201"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "1.88238209"
Evaluating: 1.88238209-3.5
 Parameter: XMIN <- "-1.61761791"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-49.6662476"
Evaluating: -49.6662476-3.5
 Parameter: YMIN <- "-53.1662476"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-40.1397201"
Evaluating: -40.1397201-3.5
 Parameter: ZMIN <- "-43.6397201"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "5.38238209"
 Parameter: XMIN -> "-1.61761791"
 Parameter: YMAX -> "-46.1662476"
 Parameter: YMIN -> "-53.1662476"
 Parameter: ZMAX -> "-36.6397201"
 Parameter: ZMIN -> "-43.6397201"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "18"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "18" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "18"
Evaluating: 18
 Parameter: J <- "18"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "18" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "18"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.530373103"
Evaluating: 120.112447*(0.530373103-0.5)
 Parameter: XPOS <- "3.64818772"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.75803215"
Evaluating: 120.112447*(0.75803215-0.5)
 Parameter: YPOS <- "30.9928729"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.794460064"
Evaluating: 85*(0.794460064-0.5)+0
 Parameter: ZPOS <- "25.0291054"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "25.0291054" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "25.0291054" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "3.64818772"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 3.64818772-0
 Parameter: XTRAN <- "3.64818772"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "30.9928729"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 30.9928729-0
 Parameter: YTRAN <- "30.9928729"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "25.0291054"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 25.0291054-0
 Parameter: ZTRAN <- "25.0291054"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "3.64818772"
 Parameter: YTRAN -> "30.9928729"
 Parameter: ZTRAN -> "25.0291054"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR     3.648188   30.992873   25.029105
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.647083162"
Evaluating: 0.647083162*360.0
 Parameter: XPHI <- "232.949938"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.658265925"
Evaluating: 0.658265925*360.0
 Parameter: YPHI <- "236.975733"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.602341921"
Evaluating: 0.602341921*360.0
 Parameter: ZPHI <- "216.843092"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "3.64818772"
 Parameter: YPOS -> "30.9928729"
 Parameter: ZPOS -> "25.0291054"
 Parameter: XPHI -> "232.949938"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.602513   -0.798109
    0.000000    0.798109   -0.602513

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  127.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "3.64818772"
 Parameter: YPOS -> "30.9928729"
 Parameter: ZPOS -> "25.0291054"
 Parameter: YPHI -> "236.975733"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.544994    0.000000    0.838440
    0.000000    1.000000    0.000000
   -0.838440    0.000000   -0.544994

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  123.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "3.64818772"
 Parameter: YPOS -> "30.9928729"
 Parameter: ZPOS -> "25.0291054"
 Parameter: ZPHI -> "216.843092"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.800281   -0.599626    0.000000
    0.599626   -0.800281    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  143.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    3.648188 XMAX =    3.648188 XAVE =    3.648188
    YMIN =   30.992873 YMAX =   30.992873 YAVE =   30.992873
    ZMIN =   25.029105 ZMAX =   25.029105 ZAVE =   25.029105
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "3.64818772"
Evaluating: 3.64818772+3.5
 Parameter: XMAX <- "7.14818772"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "30.9928729"
Evaluating: 30.9928729+3.5
 Parameter: YMAX <- "34.4928729"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "25.0291054"
Evaluating: 25.0291054+3.5
 Parameter: ZMAX <- "28.5291054"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "3.64818772"
Evaluating: 3.64818772-3.5
 Parameter: XMIN <- "0.14818772"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "30.9928729"
Evaluating: 30.9928729-3.5
 Parameter: YMIN <- "27.4928729"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "25.0291054"
Evaluating: 25.0291054-3.5
 Parameter: ZMIN <- "21.5291054"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "7.14818772"
 Parameter: XMIN -> "0.14818772"
 Parameter: YMAX -> "34.4928729"
 Parameter: YMIN -> "27.4928729"
 Parameter: ZMAX -> "28.5291054"
 Parameter: ZMIN -> "21.5291054"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "19"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "19" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "19"
Evaluating: 19
 Parameter: J <- "19"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "19" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "19"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.730815196"
Evaluating: 120.112447*(0.730815196-0.5)
 Parameter: XPOS <- "27.723778"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.811676864"
Evaluating: 120.112447*(0.811676864-0.5)
 Parameter: YPOS <- "37.4362708"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.734962265"
Evaluating: 85*(0.734962265-0.5)+0
 Parameter: ZPOS <- "19.9717925"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "19.9717925" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "19.9717925" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "27.723778"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 27.723778-0
 Parameter: XTRAN <- "27.723778"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "37.4362708"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 37.4362708-0
 Parameter: YTRAN <- "37.4362708"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "19.9717925"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 19.9717925-0
 Parameter: ZTRAN <- "19.9717925"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "27.723778"
 Parameter: YTRAN -> "37.4362708"
 Parameter: ZTRAN -> "19.9717925"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    27.723778   37.436271   19.971792
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.880336854"
Evaluating: 0.880336854*360.0
 Parameter: XPHI <- "316.921267"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.177705352"
Evaluating: 0.177705352*360.0
 Parameter: YPHI <- "63.9739267"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.807049711"
Evaluating: 0.807049711*360.0
 Parameter: ZPHI <- "290.537896"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "27.723778"
 Parameter: YPOS -> "37.4362708"
 Parameter: ZPOS -> "19.9717925"
 Parameter: XPHI -> "316.921267"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.730416   -0.683003
    0.000000    0.683003    0.730416

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   43.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "27.723778"
 Parameter: YPOS -> "37.4362708"
 Parameter: ZPOS -> "19.9717925"
 Parameter: YPHI -> "63.9739267"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.438780    0.000000   -0.898594
    0.000000    1.000000    0.000000
    0.898594    0.000000    0.438780

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   63.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "27.723778"
 Parameter: YPOS -> "37.4362708"
 Parameter: ZPOS -> "19.9717925"
 Parameter: ZPHI -> "290.537896"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.350827   -0.936440    0.000000
    0.936440    0.350827    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   69.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   27.723778 XMAX =   27.723778 XAVE =   27.723778
    YMIN =   37.436271 YMAX =   37.436271 YAVE =   37.436271
    ZMIN =   19.971792 ZMAX =   19.971792 ZAVE =   19.971792
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "27.723778"
Evaluating: 27.723778+3.5
 Parameter: XMAX <- "31.223778"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "37.4362708"
Evaluating: 37.4362708+3.5
 Parameter: YMAX <- "40.9362708"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "19.9717925"
Evaluating: 19.9717925+3.5
 Parameter: ZMAX <- "23.4717925"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "27.723778"
Evaluating: 27.723778-3.5
 Parameter: XMIN <- "24.223778"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "37.4362708"
Evaluating: 37.4362708-3.5
 Parameter: YMIN <- "33.9362708"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "19.9717925"
Evaluating: 19.9717925-3.5
 Parameter: ZMIN <- "16.4717925"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "31.223778"
 Parameter: XMIN -> "24.223778"
 Parameter: YMAX -> "40.9362708"
 Parameter: YMIN -> "33.9362708"
 Parameter: ZMAX -> "23.4717925"
 Parameter: ZMIN -> "16.4717925"
 SELRPN>      2 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      2 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
 5515 POS      NA       19       NA      -1213 MEMB     DPPC     102      NC3           1.1888
 5515 POS      NA       19       NA      -1214 MEMB     DPPC     102      PO4           3.8285
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "19"
Evaluating: 19
 Parameter: J <- "19"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "19" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "19"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.484337171"
Evaluating: 120.112447*(0.484337171-0.5)
 Parameter: XPOS <- "-1.88130072"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "3.517335824E-02"
Evaluating: 120.112447*(3.517335824E-02-0.5)
 Parameter: YPOS <- "-55.8314654"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.637246751"
Evaluating: 85*(0.637246751-0.5)+0
 Parameter: ZPOS <- "11.6659738"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "11.6659738" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "11.6659738" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "19"
Evaluating: 19
 Parameter: J <- "19"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "19" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "19"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.501306314"
Evaluating: 120.112447*(0.501306314-0.5)
 Parameter: XPOS <- "0.156904571"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.902171015"
Evaluating: 120.112447*(0.902171015-0.5)
 Parameter: YPOS <- "48.3057447"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "2.863645835E-02"
Evaluating: 85*(2.863645835E-02-0.5)+0
 Parameter: ZPOS <- "-40.065901"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-40.065901" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   27.723778 XMAX =   27.723778 XAVE =   27.723778
    YMIN =   37.436271 YMAX =   37.436271 YAVE =   37.436271
    ZMIN =   19.971792 ZMAX =   19.971792 ZAVE =   19.971792
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "0.156904571"
 RDCMND substituted energy or value "?XAVE" to "27.723778"
Evaluating: 0.156904571-27.723778
 Parameter: XTRAN <- "-27.5668734"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "48.3057447"
 RDCMND substituted energy or value "?YAVE" to "37.4362708"
Evaluating: 48.3057447-37.4362708
 Parameter: YTRAN <- "10.8694739"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-40.065901"
 RDCMND substituted energy or value "?ZAVE" to "19.9717925"
Evaluating: -40.065901-19.9717925
 Parameter: ZTRAN <- "-60.0376935"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-27.5668734"
 Parameter: YTRAN -> "10.8694739"
 Parameter: ZTRAN -> "-60.0376935"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR   -27.566873   10.869474  -60.037694
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.642677969"
Evaluating: 0.642677969*360.0
 Parameter: XPHI <- "231.364069"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.644437493"
Evaluating: 0.644437493*360.0
 Parameter: YPHI <- "231.997497"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.221201933"
Evaluating: 0.221201933*360.0
 Parameter: ZPHI <- "79.6326959"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "0.156904571"
 Parameter: YPOS -> "48.3057447"
 Parameter: ZPOS -> "-40.065901"
 Parameter: XPHI -> "231.364069"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.624370   -0.781129
    0.000000    0.781129   -0.624370

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  128.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "0.156904571"
 Parameter: YPOS -> "48.3057447"
 Parameter: ZPOS -> "-40.065901"
 Parameter: YPHI -> "231.997497"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.615696    0.000000    0.787984
    0.000000    1.000000    0.000000
   -0.787984    0.000000   -0.615696

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  128.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "0.156904571"
 Parameter: YPOS -> "48.3057447"
 Parameter: ZPOS -> "-40.065901"
 Parameter: ZPHI -> "79.6326959"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.179958    0.983674    0.000000
   -0.983674    0.179958    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   79.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.156905 XMAX =    0.156905 XAVE =    0.156905
    YMIN =   48.305745 YMAX =   48.305745 YAVE =   48.305745
    ZMIN =  -40.065901 ZMAX =  -40.065901 ZAVE =  -40.065901
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "0.156904568"
Evaluating: 0.156904568+3.5
 Parameter: XMAX <- "3.65690457"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "48.3057447"
Evaluating: 48.3057447+3.5
 Parameter: YMAX <- "51.8057447"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-40.065901"
Evaluating: -40.065901+3.5
 Parameter: ZMAX <- "-36.565901"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "0.156904568"
Evaluating: 0.156904568-3.5
 Parameter: XMIN <- "-3.34309543"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "48.3057447"
Evaluating: 48.3057447-3.5
 Parameter: YMIN <- "44.8057447"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-40.065901"
Evaluating: -40.065901-3.5
 Parameter: ZMIN <- "-43.565901"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "3.65690457"
 Parameter: XMIN -> "-3.34309543"
 Parameter: YMAX -> "51.8057447"
 Parameter: YMIN -> "44.8057447"
 Parameter: ZMAX -> "-36.565901"
 Parameter: ZMIN -> "-43.565901"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "20"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "20" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "20"
Evaluating: 20
 Parameter: J <- "20"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "20" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "20"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "6.604536601E-02"
Evaluating: 120.112447*(6.604536601E-02-0.5)
 Parameter: XPOS <- "-52.123353"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.85588206"
Evaluating: 120.112447*(0.85588206-0.5)
 Parameter: YPOS <- "42.7458651"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.379524335"
Evaluating: 85*(0.379524335-0.5)+0
 Parameter: ZPOS <- "-10.2404315"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-10.2404315" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-10.2404315" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "20"
Evaluating: 20
 Parameter: J <- "20"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "20" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "20"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.699508497"
Evaluating: 120.112447*(0.699508497-0.5)
 Parameter: XPOS <- "23.9634538"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.666955201"
Evaluating: 120.112447*(0.666955201-0.5)
 Parameter: YPOS <- "20.0533977"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.87179091"
Evaluating: 85*(0.87179091-0.5)+0
 Parameter: ZPOS <- "31.6022273"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "31.6022273" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "31.6022273" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "23.9634538"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 23.9634538-0
 Parameter: XTRAN <- "23.9634538"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "20.0533977"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 20.0533977-0
 Parameter: YTRAN <- "20.0533977"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "31.6022273"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 31.6022273-0
 Parameter: ZTRAN <- "31.6022273"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "23.9634538"
 Parameter: YTRAN -> "20.0533977"
 Parameter: ZTRAN -> "31.6022273"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    23.963454   20.053398   31.602227
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.259089584"
Evaluating: 0.259089584*360.0
 Parameter: XPHI <- "93.2722502"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.82509874E-02"
Evaluating: 6.82509874E-02*360.0
 Parameter: YPHI <- "24.5703555"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.958252935"
Evaluating: 0.958252935*360.0
 Parameter: ZPHI <- "344.971057"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "23.9634538"
 Parameter: YPOS -> "20.0533977"
 Parameter: ZPOS -> "31.6022273"
 Parameter: XPHI -> "93.2722502"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.057080    0.998370
    0.000000   -0.998370   -0.057080

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   93.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "23.9634538"
 Parameter: YPOS -> "20.0533977"
 Parameter: ZPOS -> "31.6022273"
 Parameter: YPHI -> "24.5703555"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.909451    0.000000   -0.415810
    0.000000    1.000000    0.000000
    0.415810    0.000000    0.909451

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   24.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "23.9634538"
 Parameter: YPOS -> "20.0533977"
 Parameter: ZPOS -> "31.6022273"
 Parameter: ZPHI -> "344.971057"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.965795   -0.259307    0.000000
    0.259307    0.965795    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   15.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   23.963454 XMAX =   23.963454 XAVE =   23.963454
    YMIN =   20.053398 YMAX =   20.053398 YAVE =   20.053398
    ZMIN =   31.602227 ZMAX =   31.602227 ZAVE =   31.602227
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "23.9634538"
Evaluating: 23.9634538+3.5
 Parameter: XMAX <- "27.4634538"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "20.0533977"
Evaluating: 20.0533977+3.5
 Parameter: YMAX <- "23.5533977"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "31.6022273"
Evaluating: 31.6022273+3.5
 Parameter: ZMAX <- "35.1022273"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "23.9634538"
Evaluating: 23.9634538-3.5
 Parameter: XMIN <- "20.4634538"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "20.0533977"
Evaluating: 20.0533977-3.5
 Parameter: YMIN <- "16.5533977"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "31.6022273"
Evaluating: 31.6022273-3.5
 Parameter: ZMIN <- "28.1022273"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "27.4634538"
 Parameter: XMIN -> "20.4634538"
 Parameter: YMAX -> "23.5533977"
 Parameter: YMIN -> "16.5533977"
 Parameter: ZMAX -> "35.1022273"
 Parameter: ZMIN -> "28.1022273"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "21"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "21" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "21"
Evaluating: 21
 Parameter: J <- "21"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "21" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "21"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.662678867"
Evaluating: 120.112447*(0.662678867-0.5)
 Parameter: XPOS <- "19.5397568"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.957066584"
Evaluating: 120.112447*(0.957066584-0.5)
 Parameter: YPOS <- "54.8993858"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.877615723"
Evaluating: 85*(0.877615723-0.5)+0
 Parameter: ZPOS <- "32.0973365"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "32.0973365" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "32.0973365" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "19.5397568"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 19.5397568-0
 Parameter: XTRAN <- "19.5397568"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "54.8993858"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 54.8993858-0
 Parameter: YTRAN <- "54.8993858"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "32.0973365"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 32.0973365-0
 Parameter: ZTRAN <- "32.0973365"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "19.5397568"
 Parameter: YTRAN -> "54.8993858"
 Parameter: ZTRAN -> "32.0973365"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    19.539757   54.899386   32.097336
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.159429036"
Evaluating: 0.159429036*360.0
 Parameter: XPHI <- "57.394453"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.841665363"
Evaluating: 0.841665363*360.0
 Parameter: YPHI <- "302.999531"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.392851715"
Evaluating: 0.392851715*360.0
 Parameter: ZPHI <- "141.426617"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "19.5397568"
 Parameter: YPOS -> "54.8993858"
 Parameter: ZPOS -> "32.0973365"
 Parameter: XPHI -> "57.394453"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.538852    0.842400
    0.000000   -0.842400    0.538852

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   57.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "19.5397568"
 Parameter: YPOS -> "54.8993858"
 Parameter: ZPOS -> "32.0973365"
 Parameter: YPHI -> "302.999531"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.544632    0.000000    0.838675
    0.000000    1.000000    0.000000
   -0.838675    0.000000    0.544632

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   57.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "19.5397568"
 Parameter: YPOS -> "54.8993858"
 Parameter: ZPOS -> "32.0973365"
 Parameter: ZPHI -> "141.426617"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.781810    0.623516    0.000000
   -0.623516   -0.781810    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  141.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   19.539757 XMAX =   19.539757 XAVE =   19.539757
    YMIN =   54.899386 YMAX =   54.899386 YAVE =   54.899386
    ZMIN =   32.097336 ZMAX =   32.097336 ZAVE =   32.097336
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "19.5397568"
Evaluating: 19.5397568+3.5
 Parameter: XMAX <- "23.0397568"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "54.8993858"
Evaluating: 54.8993858+3.5
 Parameter: YMAX <- "58.3993858"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "32.0973365"
Evaluating: 32.0973365+3.5
 Parameter: ZMAX <- "35.5973365"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "19.5397568"
Evaluating: 19.5397568-3.5
 Parameter: XMIN <- "16.0397568"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "54.8993858"
Evaluating: 54.8993858-3.5
 Parameter: YMIN <- "51.3993858"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "32.0973365"
Evaluating: 32.0973365-3.5
 Parameter: ZMIN <- "28.5973365"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "23.0397568"
 Parameter: XMIN -> "16.0397568"
 Parameter: YMAX -> "58.3993858"
 Parameter: YMIN -> "51.3993858"
 Parameter: ZMAX -> "35.5973365"
 Parameter: ZMIN -> "28.5973365"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "22"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "22" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "22"
Evaluating: 22
 Parameter: J <- "22"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "22" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "22"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.543262249"
Evaluating: 120.112447*(0.543262249-0.5)
 Parameter: XPOS <- "5.19633459"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.399760937"
Evaluating: 120.112447*(0.399760937-0.5)
 Parameter: YPOS <- "-12.0399591"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.456746385"
Evaluating: 85*(0.456746385-0.5)+0
 Parameter: ZPOS <- "-3.67655728"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-3.67655728" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-3.67655728" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "22"
Evaluating: 22
 Parameter: J <- "22"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "22" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "22"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.762771888"
Evaluating: 120.112447*(0.762771888-0.5)
 Parameter: XPOS <- "31.5621745"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.298289297"
Evaluating: 120.112447*(0.298289297-0.5)
 Parameter: YPOS <- "-24.2279661"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.911806617"
Evaluating: 85*(0.911806617-0.5)+0
 Parameter: ZPOS <- "35.0035624"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "35.0035624" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "35.0035624" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "31.5621745"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 31.5621745-0
 Parameter: XTRAN <- "31.5621745"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-24.2279661"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -24.2279661-0
 Parameter: YTRAN <- "-24.2279661"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "35.0035624"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 35.0035624-0
 Parameter: ZTRAN <- "35.0035624"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "31.5621745"
 Parameter: YTRAN -> "-24.2279661"
 Parameter: ZTRAN -> "35.0035624"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    31.562175  -24.227966   35.003562
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.841146837"
Evaluating: 0.841146837*360.0
 Parameter: XPHI <- "302.812861"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.969836913"
Evaluating: 0.969836913*360.0
 Parameter: YPHI <- "349.141289"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.904345124"
Evaluating: 0.904345124*360.0
 Parameter: ZPHI <- "325.564245"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "31.5621745"
 Parameter: YPOS -> "-24.2279661"
 Parameter: ZPOS -> "35.0035624"
 Parameter: XPHI -> "302.812861"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.541897   -0.840445
    0.000000    0.840445    0.541897

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   57.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "31.5621745"
 Parameter: YPOS -> "-24.2279661"
 Parameter: ZPOS -> "35.0035624"
 Parameter: YPHI -> "349.141289"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.982095    0.000000    0.188388
    0.000000    1.000000    0.000000
   -0.188388    0.000000    0.982095

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   10.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "31.5621745"
 Parameter: YPOS -> "-24.2279661"
 Parameter: ZPOS -> "35.0035624"
 Parameter: ZPHI -> "325.564245"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.824761   -0.565482    0.000000
    0.565482    0.824761    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   34.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   31.562175 XMAX =   31.562175 XAVE =   31.562175
    YMIN =  -24.227966 YMAX =  -24.227966 YAVE =  -24.227966
    ZMIN =   35.003562 ZMAX =   35.003562 ZAVE =   35.003562
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "31.5621745"
Evaluating: 31.5621745+3.5
 Parameter: XMAX <- "35.0621745"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-24.2279661"
Evaluating: -24.2279661+3.5
 Parameter: YMAX <- "-20.7279661"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "35.0035624"
Evaluating: 35.0035624+3.5
 Parameter: ZMAX <- "38.5035624"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "31.5621745"
Evaluating: 31.5621745-3.5
 Parameter: XMIN <- "28.0621745"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-24.2279661"
Evaluating: -24.2279661-3.5
 Parameter: YMIN <- "-27.7279661"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "35.0035624"
Evaluating: 35.0035624-3.5
 Parameter: ZMIN <- "31.5035624"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "35.0621745"
 Parameter: XMIN -> "28.0621745"
 Parameter: YMAX -> "-20.7279661"
 Parameter: YMIN -> "-27.7279661"
 Parameter: ZMAX -> "38.5035624"
 Parameter: ZMIN -> "31.5035624"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "23"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "23" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "23"
Evaluating: 23
 Parameter: J <- "23"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "23" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "23"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "5.912364858E-03"
Evaluating: 120.112447*(5.912364858E-03-0.5)
 Parameter: XPOS <- "-59.3460749"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.502008153"
Evaluating: 120.112447*(0.502008153-0.5)
 Parameter: YPOS <- "0.241204171"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.418147089"
Evaluating: 85*(0.418147089-0.5)+0
 Parameter: ZPOS <- "-6.95749743"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-6.95749743" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-6.95749743" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "23"
Evaluating: 23
 Parameter: J <- "23"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "23" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "23"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.641068274"
Evaluating: 120.112447*(0.641068274-0.5)
 Parameter: XPOS <- "16.9440556"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.53160636"
Evaluating: 120.112447*(0.53160636-0.5)
 Parameter: YPOS <- "3.79631724"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.849424643"
Evaluating: 85*(0.849424643-0.5)+0
 Parameter: ZPOS <- "29.7010947"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "29.7010947" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "29.7010947" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "16.9440556"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 16.9440556-0
 Parameter: XTRAN <- "16.9440556"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "3.79631724"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 3.79631724-0
 Parameter: YTRAN <- "3.79631724"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "29.7010947"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 29.7010947-0
 Parameter: ZTRAN <- "29.7010947"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "16.9440556"
 Parameter: YTRAN -> "3.79631724"
 Parameter: ZTRAN -> "29.7010947"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    16.944056    3.796317   29.701095
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.177896784"
Evaluating: 0.177896784*360.0
 Parameter: XPHI <- "64.0428422"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.1128975"
Evaluating: 0.1128975*360.0
 Parameter: YPHI <- "40.6431"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.946533088"
Evaluating: 0.946533088*360.0
 Parameter: ZPHI <- "340.751912"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "16.9440556"
 Parameter: YPOS -> "3.79631724"
 Parameter: ZPOS -> "29.7010947"
 Parameter: XPHI -> "64.0428422"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.437699    0.899122
    0.000000   -0.899122    0.437699

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   64.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "16.9440556"
 Parameter: YPOS -> "3.79631724"
 Parameter: ZPOS -> "29.7010947"
 Parameter: YPHI -> "40.6431"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.758782    0.000000   -0.651345
    0.000000    1.000000    0.000000
    0.651345    0.000000    0.758782

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   40.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "16.9440556"
 Parameter: YPOS -> "3.79631724"
 Parameter: ZPOS -> "29.7010947"
 Parameter: ZPHI -> "340.751912"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.944100   -0.329659    0.000000
    0.329659    0.944100    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   19.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   16.944056 XMAX =   16.944056 XAVE =   16.944056
    YMIN =    3.796317 YMAX =    3.796317 YAVE =    3.796317
    ZMIN =   29.701095 ZMAX =   29.701095 ZAVE =   29.701095
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "16.9440556"
Evaluating: 16.9440556+3.5
 Parameter: XMAX <- "20.4440556"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "3.79631724"
Evaluating: 3.79631724+3.5
 Parameter: YMAX <- "7.29631724"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "29.7010947"
Evaluating: 29.7010947+3.5
 Parameter: ZMAX <- "33.2010947"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "16.9440556"
Evaluating: 16.9440556-3.5
 Parameter: XMIN <- "13.4440556"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "3.79631724"
Evaluating: 3.79631724-3.5
 Parameter: YMIN <- "0.29631724"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "29.7010947"
Evaluating: 29.7010947-3.5
 Parameter: ZMIN <- "26.2010947"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "20.4440556"
 Parameter: XMIN -> "13.4440556"
 Parameter: YMAX -> "7.29631724"
 Parameter: YMIN -> "0.29631724"
 Parameter: ZMAX -> "33.2010947"
 Parameter: ZMIN -> "26.2010947"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "24"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "24" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "24"
Evaluating: 24
 Parameter: J <- "24"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "24" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "24"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.484296451"
Evaluating: 120.112447*(0.484296451-0.5)
 Parameter: XPOS <- "-1.8861917"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.968449042"
Evaluating: 120.112447*(0.968449042-0.5)
 Parameter: YPOS <- "56.2665607"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.391198711"
Evaluating: 85*(0.391198711-0.5)+0
 Parameter: ZPOS <- "-9.24810957"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-9.24810957" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-9.24810957" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "24"
Evaluating: 24
 Parameter: J <- "24"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "24" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "24"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.639029908"
Evaluating: 120.112447*(0.639029908-0.5)
 Parameter: XPOS <- "16.6992225"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.164383598"
Evaluating: 120.112447*(0.164383598-0.5)
 Parameter: YPOS <- "-40.3117073"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.134511833"
Evaluating: 85*(0.134511833-0.5)+0
 Parameter: ZPOS <- "-31.0664942"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-31.0664942" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "16.6992225"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 16.6992225-0
 Parameter: XTRAN <- "16.6992225"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-40.3117073"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -40.3117073-0
 Parameter: YTRAN <- "-40.3117073"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-31.0664942"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -31.0664942-0
 Parameter: ZTRAN <- "-31.0664942"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "16.6992225"
 Parameter: YTRAN -> "-40.3117073"
 Parameter: ZTRAN -> "-31.0664942"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    16.699223  -40.311707  -31.066494
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.688679567E-02"
Evaluating: 7.688679567E-02*360.0
 Parameter: XPHI <- "27.6792464"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.955719262"
Evaluating: 0.955719262*360.0
 Parameter: YPHI <- "344.058934"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.586559127E-02"
Evaluating: 2.586559127E-02*360.0
 Parameter: ZPHI <- "9.31161286"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "16.6992225"
 Parameter: YPOS -> "-40.3117073"
 Parameter: ZPOS -> "-31.0664942"
 Parameter: XPHI -> "27.6792464"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.885562    0.464521
    0.000000   -0.464521    0.885562

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   27.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "16.6992225"
 Parameter: YPOS -> "-40.3117073"
 Parameter: ZPOS -> "-31.0664942"
 Parameter: YPHI -> "344.058934"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.961545    0.000000    0.274648
    0.000000    1.000000    0.000000
   -0.274648    0.000000    0.961545

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   15.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "16.6992225"
 Parameter: YPOS -> "-40.3117073"
 Parameter: ZPOS -> "-31.0664942"
 Parameter: ZPHI -> "9.31161286"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.986823    0.161804    0.000000
   -0.161804    0.986823    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    9.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   16.699223 XMAX =   16.699223 XAVE =   16.699223
    YMIN =  -40.311707 YMAX =  -40.311707 YAVE =  -40.311707
    ZMIN =  -31.066494 ZMAX =  -31.066494 ZAVE =  -31.066494
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "16.6992225"
Evaluating: 16.6992225+3.5
 Parameter: XMAX <- "20.1992225"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-40.3117073"
Evaluating: -40.3117073+3.5
 Parameter: YMAX <- "-36.8117073"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-31.0664942"
Evaluating: -31.0664942+3.5
 Parameter: ZMAX <- "-27.5664942"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "16.6992225"
Evaluating: 16.6992225-3.5
 Parameter: XMIN <- "13.1992225"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-40.3117073"
Evaluating: -40.3117073-3.5
 Parameter: YMIN <- "-43.8117073"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-31.0664942"
Evaluating: -31.0664942-3.5
 Parameter: ZMIN <- "-34.5664942"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "20.1992225"
 Parameter: XMIN -> "13.1992225"
 Parameter: YMAX -> "-36.8117073"
 Parameter: YMIN -> "-43.8117073"
 Parameter: ZMAX -> "-27.5664942"
 Parameter: ZMIN -> "-34.5664942"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "25"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "25" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "25"
Evaluating: 25
 Parameter: J <- "25"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "25" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "25"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.444119375"
Evaluating: 120.112447*(0.444119375-0.5)
 Parameter: XPOS <- "-6.71195861"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.665638218"
Evaluating: 120.112447*(0.665638218-0.5)
 Parameter: YPOS <- "19.8952117"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.892042706"
Evaluating: 85*(0.892042706-0.5)+0
 Parameter: ZPOS <- "33.32363"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "33.32363" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "33.32363" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-6.71195861"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -6.71195861-0
 Parameter: XTRAN <- "-6.71195861"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "19.8952117"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 19.8952117-0
 Parameter: YTRAN <- "19.8952117"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "33.32363"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 33.32363-0
 Parameter: ZTRAN <- "33.32363"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-6.71195861"
 Parameter: YTRAN -> "19.8952117"
 Parameter: ZTRAN -> "33.32363"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    -6.711959   19.895212   33.323630
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.876486871"
Evaluating: 0.876486871*360.0
 Parameter: XPHI <- "315.535274"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.456290166"
Evaluating: 0.456290166*360.0
 Parameter: YPHI <- "164.26446"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.837593192"
Evaluating: 0.837593192*360.0
 Parameter: ZPHI <- "301.533549"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-6.71195861"
 Parameter: YPOS -> "19.8952117"
 Parameter: ZPOS -> "33.32363"
 Parameter: XPHI -> "315.535274"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.713682   -0.700470
    0.000000    0.700470    0.713682

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   44.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-6.71195861"
 Parameter: YPOS -> "19.8952117"
 Parameter: ZPOS -> "33.32363"
 Parameter: YPHI -> "164.26446"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.962524    0.000000   -0.271198
    0.000000    1.000000    0.000000
    0.271198    0.000000   -0.962524

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  164.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-6.71195861"
 Parameter: YPOS -> "19.8952117"
 Parameter: ZPOS -> "33.32363"
 Parameter: ZPHI -> "301.533549"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.522998   -0.852334    0.000000
    0.852334    0.522998    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   58.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -6.711959 XMAX =   -6.711959 XAVE =   -6.711959
    YMIN =   19.895212 YMAX =   19.895212 YAVE =   19.895212
    ZMIN =   33.323630 ZMAX =   33.323630 ZAVE =   33.323630
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-6.71195861"
Evaluating: -6.71195861+3.5
 Parameter: XMAX <- "-3.21195861"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "19.8952117"
Evaluating: 19.8952117+3.5
 Parameter: YMAX <- "23.3952117"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "33.32363"
Evaluating: 33.32363+3.5
 Parameter: ZMAX <- "36.82363"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-6.71195861"
Evaluating: -6.71195861-3.5
 Parameter: XMIN <- "-10.2119586"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "19.8952117"
Evaluating: 19.8952117-3.5
 Parameter: YMIN <- "16.3952117"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "33.32363"
Evaluating: 33.32363-3.5
 Parameter: ZMIN <- "29.82363"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-3.21195861"
 Parameter: XMIN -> "-10.2119586"
 Parameter: YMAX -> "23.3952117"
 Parameter: YMIN -> "16.3952117"
 Parameter: ZMAX -> "36.82363"
 Parameter: ZMIN -> "29.82363"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "26"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "26" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "26"
Evaluating: 26
 Parameter: J <- "26"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "26" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "26"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.552992261"
Evaluating: 120.112447*(0.552992261-0.5)
 Parameter: XPOS <- "6.36503014"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.786671839"
Evaluating: 120.112447*(0.786671839-0.5)
 Parameter: YPOS <- "34.4328561"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "8.903313304E-02"
Evaluating: 85*(8.903313304E-02-0.5)+0
 Parameter: ZPOS <- "-34.9321837"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-34.9321837" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "6.36503014"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 6.36503014-0
 Parameter: XTRAN <- "6.36503014"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "34.4328561"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 34.4328561-0
 Parameter: YTRAN <- "34.4328561"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-34.9321837"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -34.9321837-0
 Parameter: ZTRAN <- "-34.9321837"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "6.36503014"
 Parameter: YTRAN -> "34.4328561"
 Parameter: ZTRAN -> "-34.9321837"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR     6.365030   34.432856  -34.932184
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.574619393"
Evaluating: 0.574619393*360.0
 Parameter: XPHI <- "206.862981"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.493878062"
Evaluating: 0.493878062*360.0
 Parameter: YPHI <- "177.796102"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.660532544E-02"
Evaluating: 5.660532544E-02*360.0
 Parameter: ZPHI <- "20.3779172"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "6.36503014"
 Parameter: YPOS -> "34.4328561"
 Parameter: ZPOS -> "-34.9321837"
 Parameter: XPHI -> "206.862981"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.892090   -0.451858
    0.000000    0.451858   -0.892090

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  153.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "6.36503014"
 Parameter: YPOS -> "34.4328561"
 Parameter: ZPOS -> "-34.9321837"
 Parameter: YPHI -> "177.796102"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.999260    0.000000   -0.038456
    0.000000    1.000000    0.000000
    0.038456    0.000000   -0.999260

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  177.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "6.36503014"
 Parameter: YPOS -> "34.4328561"
 Parameter: ZPOS -> "-34.9321837"
 Parameter: ZPHI -> "20.3779172"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.937416    0.348211    0.000000
   -0.348211    0.937416    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   20.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    6.365030 XMAX =    6.365030 XAVE =    6.365030
    YMIN =   34.432856 YMAX =   34.432856 YAVE =   34.432856
    ZMIN =  -34.932184 ZMAX =  -34.932184 ZAVE =  -34.932184
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "6.36503014"
Evaluating: 6.36503014+3.5
 Parameter: XMAX <- "9.86503014"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "34.4328561"
Evaluating: 34.4328561+3.5
 Parameter: YMAX <- "37.9328561"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-34.9321837"
Evaluating: -34.9321837+3.5
 Parameter: ZMAX <- "-31.4321837"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "6.36503014"
Evaluating: 6.36503014-3.5
 Parameter: XMIN <- "2.86503014"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "34.4328561"
Evaluating: 34.4328561-3.5
 Parameter: YMIN <- "30.9328561"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-34.9321837"
Evaluating: -34.9321837-3.5
 Parameter: ZMIN <- "-38.4321837"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "9.86503014"
 Parameter: XMIN -> "2.86503014"
 Parameter: YMAX -> "37.9328561"
 Parameter: YMIN -> "30.9328561"
 Parameter: ZMAX -> "-31.4321837"
 Parameter: ZMIN -> "-38.4321837"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "27"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "27" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "27"
Evaluating: 27
 Parameter: J <- "27"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "27" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "27"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.413040262"
Evaluating: 120.112447*(0.413040262-0.5)
 Parameter: XPOS <- "-10.4449469"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.856723998"
Evaluating: 120.112447*(0.856723998-0.5)
 Parameter: YPOS <- "42.8469923"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.214337142"
Evaluating: 85*(0.214337142-0.5)+0
 Parameter: ZPOS <- "-24.2813429"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-24.2813429" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-10.4449469"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -10.4449469-0
 Parameter: XTRAN <- "-10.4449469"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "42.8469923"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 42.8469923-0
 Parameter: YTRAN <- "42.8469923"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-24.2813429"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -24.2813429-0
 Parameter: ZTRAN <- "-24.2813429"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-10.4449469"
 Parameter: YTRAN -> "42.8469923"
 Parameter: ZTRAN -> "-24.2813429"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR   -10.444947   42.846992  -24.281343
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.427565158E-02"
Evaluating: 4.427565158E-02*360.0
 Parameter: XPHI <- "15.9392346"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.469388395E-02"
Evaluating: 7.469388395E-02*360.0
 Parameter: YPHI <- "26.8897982"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.876217024E-02"
Evaluating: 8.876217024E-02*360.0
 Parameter: ZPHI <- "31.9543813"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-10.4449469"
 Parameter: YPOS -> "42.8469923"
 Parameter: ZPOS -> "-24.2813429"
 Parameter: XPHI -> "15.9392346"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.961553    0.274618
    0.000000   -0.274618    0.961553

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   15.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-10.4449469"
 Parameter: YPOS -> "42.8469923"
 Parameter: ZPOS -> "-24.2813429"
 Parameter: YPHI -> "26.8897982"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.891878    0.000000   -0.452276
    0.000000    1.000000    0.000000
    0.452276    0.000000    0.891878

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   26.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-10.4449469"
 Parameter: YPOS -> "42.8469923"
 Parameter: ZPOS -> "-24.2813429"
 Parameter: ZPHI -> "31.9543813"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.848470    0.529244    0.000000
   -0.529244    0.848470    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   31.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -10.444947 XMAX =  -10.444947 XAVE =  -10.444947
    YMIN =   42.846992 YMAX =   42.846992 YAVE =   42.846992
    ZMIN =  -24.281343 ZMAX =  -24.281343 ZAVE =  -24.281343
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-10.4449469"
Evaluating: -10.4449469+3.5
 Parameter: XMAX <- "-6.9449469"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "42.8469923"
Evaluating: 42.8469923+3.5
 Parameter: YMAX <- "46.3469923"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-24.2813429"
Evaluating: -24.2813429+3.5
 Parameter: ZMAX <- "-20.7813429"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-10.4449469"
Evaluating: -10.4449469-3.5
 Parameter: XMIN <- "-13.9449469"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "42.8469923"
Evaluating: 42.8469923-3.5
 Parameter: YMIN <- "39.3469923"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-24.2813429"
Evaluating: -24.2813429-3.5
 Parameter: ZMIN <- "-27.7813429"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-6.9449469"
 Parameter: XMIN -> "-13.9449469"
 Parameter: YMAX -> "46.3469923"
 Parameter: YMIN -> "39.3469923"
 Parameter: ZMAX -> "-20.7813429"
 Parameter: ZMIN -> "-27.7813429"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "28"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "28" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "28"
Evaluating: 28
 Parameter: J <- "28"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "28" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "28"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.776867358"
Evaluating: 120.112447*(0.776867358-0.5)
 Parameter: XPOS <- "33.2552159"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.694002893"
Evaluating: 120.112447*(0.694002893-0.5)
 Parameter: YPOS <- "23.3021622"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.122212181"
Evaluating: 85*(0.122212181-0.5)+0
 Parameter: ZPOS <- "-32.1119646"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-32.1119646" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "33.2552159"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 33.2552159-0
 Parameter: XTRAN <- "33.2552159"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "23.3021622"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 23.3021622-0
 Parameter: YTRAN <- "23.3021622"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-32.1119646"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -32.1119646-0
 Parameter: ZTRAN <- "-32.1119646"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "33.2552159"
 Parameter: YTRAN -> "23.3021622"
 Parameter: ZTRAN -> "-32.1119646"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    33.255216   23.302162  -32.111965
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.681984297"
Evaluating: 0.681984297*360.0
 Parameter: XPHI <- "245.514347"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.335878181"
Evaluating: 0.335878181*360.0
 Parameter: YPHI <- "120.916145"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.591148671"
Evaluating: 0.591148671*360.0
 Parameter: ZPHI <- "212.813522"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "33.2552159"
 Parameter: YPOS -> "23.3021622"
 Parameter: ZPOS -> "-32.1119646"
 Parameter: XPHI -> "245.514347"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.414465   -0.910065
    0.000000    0.910065   -0.414465

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  114.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "33.2552159"
 Parameter: YPOS -> "23.3021622"
 Parameter: ZPOS -> "-32.1119646"
 Parameter: YPHI -> "120.916145"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.513783    0.000000   -0.857920
    0.000000    1.000000    0.000000
    0.857920    0.000000   -0.513783

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  120.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "33.2552159"
 Parameter: YPOS -> "23.3021622"
 Parameter: ZPOS -> "-32.1119646"
 Parameter: ZPHI -> "212.813522"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.840439   -0.541907    0.000000
    0.541907   -0.840439    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  147.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   33.255216 XMAX =   33.255216 XAVE =   33.255216
    YMIN =   23.302162 YMAX =   23.302162 YAVE =   23.302162
    ZMIN =  -32.111965 ZMAX =  -32.111965 ZAVE =  -32.111965
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "33.2552159"
Evaluating: 33.2552159+3.5
 Parameter: XMAX <- "36.7552159"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "23.3021622"
Evaluating: 23.3021622+3.5
 Parameter: YMAX <- "26.8021622"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-32.1119646"
Evaluating: -32.1119646+3.5
 Parameter: ZMAX <- "-28.6119646"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "33.2552159"
Evaluating: 33.2552159-3.5
 Parameter: XMIN <- "29.7552159"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "23.3021622"
Evaluating: 23.3021622-3.5
 Parameter: YMIN <- "19.8021622"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-32.1119646"
Evaluating: -32.1119646-3.5
 Parameter: ZMIN <- "-35.6119646"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "36.7552159"
 Parameter: XMIN -> "29.7552159"
 Parameter: YMAX -> "26.8021622"
 Parameter: YMIN -> "19.8021622"
 Parameter: ZMAX -> "-28.6119646"
 Parameter: ZMIN -> "-35.6119646"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "29"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "29" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "29"
Evaluating: 29
 Parameter: J <- "29"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "29" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "29"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.619829384"
Evaluating: 120.112447*(0.619829384-0.5)
 Parameter: XPOS <- "14.3930005"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.443590029"
Evaluating: 120.112447*(0.443590029-0.5)
 Parameter: YPOS <- "-6.77553965"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.789087735"
Evaluating: 85*(0.789087735-0.5)+0
 Parameter: ZPOS <- "24.5724575"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "24.5724575" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "24.5724575" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "14.3930005"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 14.3930005-0
 Parameter: XTRAN <- "14.3930005"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-6.77553965"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -6.77553965-0
 Parameter: YTRAN <- "-6.77553965"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "24.5724575"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 24.5724575-0
 Parameter: ZTRAN <- "24.5724575"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "14.3930005"
 Parameter: YTRAN -> "-6.77553965"
 Parameter: ZTRAN -> "24.5724575"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    14.393000   -6.775540   24.572457
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.364146095"
Evaluating: 0.364146095*360.0
 Parameter: XPHI <- "131.092594"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.314322376"
Evaluating: 0.314322376*360.0
 Parameter: YPHI <- "113.156055"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.716012356"
Evaluating: 0.716012356*360.0
 Parameter: ZPHI <- "257.764448"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "14.3930005"
 Parameter: YPOS -> "-6.77553965"
 Parameter: ZPOS -> "24.5724575"
 Parameter: XPHI -> "131.092594"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.657278    0.753648
    0.000000   -0.753648   -0.657278

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  131.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "14.3930005"
 Parameter: YPOS -> "-6.77553965"
 Parameter: ZPOS -> "24.5724575"
 Parameter: YPHI -> "113.156055"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.393237    0.000000   -0.919437
    0.000000    1.000000    0.000000
    0.919437    0.000000   -0.393237

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  113.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "14.3930005"
 Parameter: YPOS -> "-6.77553965"
 Parameter: ZPOS -> "24.5724575"
 Parameter: ZPHI -> "257.764448"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.211931   -0.977285    0.000000
    0.977285   -0.211931    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  102.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   14.393000 XMAX =   14.393000 XAVE =   14.393000
    YMIN =   -6.775540 YMAX =   -6.775540 YAVE =   -6.775540
    ZMIN =   24.572457 ZMAX =   24.572457 ZAVE =   24.572457
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "14.3930005"
Evaluating: 14.3930005+3.5
 Parameter: XMAX <- "17.8930005"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-6.77553965"
Evaluating: -6.77553965+3.5
 Parameter: YMAX <- "-3.27553965"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "24.5724575"
Evaluating: 24.5724575+3.5
 Parameter: ZMAX <- "28.0724575"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "14.3930005"
Evaluating: 14.3930005-3.5
 Parameter: XMIN <- "10.8930005"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-6.77553965"
Evaluating: -6.77553965-3.5
 Parameter: YMIN <- "-10.2755396"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "24.5724575"
Evaluating: 24.5724575-3.5
 Parameter: ZMIN <- "21.0724575"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "17.8930005"
 Parameter: XMIN -> "10.8930005"
 Parameter: YMAX -> "-3.27553965"
 Parameter: YMIN -> "-10.2755396"
 Parameter: ZMAX -> "28.0724575"
 Parameter: ZMIN -> "21.0724575"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "30"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "30" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "30"
Evaluating: 30
 Parameter: J <- "30"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "30" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "30"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.554737532"
Evaluating: 120.112447*(0.554737532-0.5)
 Parameter: XPOS <- "6.57465891"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.259727834"
Evaluating: 120.112447*(0.259727834-0.5)
 Parameter: YPOS <- "-28.8596778"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.582627755"
Evaluating: 85*(0.582627755-0.5)+0
 Parameter: ZPOS <- "7.02335917"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "7.02335917" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "7.02335917" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "30"
Evaluating: 30
 Parameter: J <- "30"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "30" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "30"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.864642946"
Evaluating: 120.112447*(0.864642946-0.5)
 Parameter: XPOS <- "43.7981565"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.676847267"
Evaluating: 120.112447*(0.676847267-0.5)
 Parameter: YPOS <- "21.241558"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.584299407"
Evaluating: 85*(0.584299407-0.5)+0
 Parameter: ZPOS <- "7.1654496"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "7.1654496" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "7.1654496" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "30"
Evaluating: 30
 Parameter: J <- "30"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "30" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "30"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.181957122"
Evaluating: 120.112447*(0.181957122-0.5)
 Parameter: XPOS <- "-38.2009083"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.951522526"
Evaluating: 120.112447*(0.951522526-0.5)
 Parameter: YPOS <- "54.2334755"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.389374751"
Evaluating: 85*(0.389374751-0.5)+0
 Parameter: ZPOS <- "-9.40314616"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-9.40314616" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-9.40314616" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "30"
Evaluating: 30
 Parameter: J <- "30"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "30" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "30"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.903623372"
Evaluating: 120.112447*(0.903623372-0.5)
 Parameter: XPOS <- "48.4801909"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.262274074"
Evaluating: 120.112447*(0.262274074-0.5)
 Parameter: YPOS <- "-28.5538427"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.986855539"
Evaluating: 85*(0.986855539-0.5)+0
 Parameter: ZPOS <- "41.3827208"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "41.3827208" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "41.3827208" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "48.4801909"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 48.4801909-0
 Parameter: XTRAN <- "48.4801909"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-28.5538427"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -28.5538427-0
 Parameter: YTRAN <- "-28.5538427"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "41.3827208"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 41.3827208-0
 Parameter: ZTRAN <- "41.3827208"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "48.4801909"
 Parameter: YTRAN -> "-28.5538427"
 Parameter: ZTRAN -> "41.3827208"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    48.480191  -28.553843   41.382721
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.159838014"
Evaluating: 0.159838014*360.0
 Parameter: XPHI <- "57.541685"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.413280214"
Evaluating: 0.413280214*360.0
 Parameter: YPHI <- "148.780877"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.198795735E-03"
Evaluating: 1.198795735E-03*360.0
 Parameter: ZPHI <- "0.431566465"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "48.4801909"
 Parameter: YPOS -> "-28.5538427"
 Parameter: ZPOS -> "41.3827208"
 Parameter: XPHI -> "57.541685"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.536686    0.843782
    0.000000   -0.843782    0.536686

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   57.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "48.4801909"
 Parameter: YPOS -> "-28.5538427"
 Parameter: ZPOS -> "41.3827208"
 Parameter: YPHI -> "148.780877"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.855191    0.000000   -0.518312
    0.000000    1.000000    0.000000
    0.518312    0.000000   -0.855191

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  148.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "48.4801909"
 Parameter: YPOS -> "-28.5538427"
 Parameter: ZPOS -> "41.3827208"
 Parameter: ZPHI -> "0.431566465"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.999972    0.007532    0.000000
   -0.007532    0.999972    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    0.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   48.480191 XMAX =   48.480191 XAVE =   48.480191
    YMIN =  -28.553843 YMAX =  -28.553843 YAVE =  -28.553843
    ZMIN =   41.382721 ZMAX =   41.382721 ZAVE =   41.382721
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "48.4801909"
Evaluating: 48.4801909+3.5
 Parameter: XMAX <- "51.9801909"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-28.5538427"
Evaluating: -28.5538427+3.5
 Parameter: YMAX <- "-25.0538427"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "41.3827208"
Evaluating: 41.3827208+3.5
 Parameter: ZMAX <- "44.8827208"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "48.4801909"
Evaluating: 48.4801909-3.5
 Parameter: XMIN <- "44.9801909"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-28.5538427"
Evaluating: -28.5538427-3.5
 Parameter: YMIN <- "-32.0538427"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "41.3827208"
Evaluating: 41.3827208-3.5
 Parameter: ZMIN <- "37.8827208"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "51.9801909"
 Parameter: XMIN -> "44.9801909"
 Parameter: YMAX -> "-25.0538427"
 Parameter: YMIN -> "-32.0538427"
 Parameter: ZMAX -> "44.8827208"
 Parameter: ZMIN -> "37.8827208"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "31"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "31" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "31"
Evaluating: 31
 Parameter: J <- "31"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "31" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "31"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "8.676938788E-02"
Evaluating: 120.112447*(8.676938788E-02-0.5)
 Parameter: XPOS <- "-49.63414"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.510131207"
Evaluating: 120.112447*(0.510131207-0.5)
 Parameter: YPOS <- "1.21688406"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.528924344"
Evaluating: 85*(0.528924344-0.5)+0
 Parameter: ZPOS <- "2.45856924"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "2.45856924" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "2.45856924" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "31"
Evaluating: 31
 Parameter: J <- "31"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "31" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "31"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.598274134"
Evaluating: 120.112447*(0.598274134-0.5)
 Parameter: XPOS <- "11.8039467"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.734821136"
Evaluating: 120.112447*(0.734821136-0.5)
 Parameter: YPOS <- "28.2049413"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.213839517"
Evaluating: 85*(0.213839517-0.5)+0
 Parameter: ZPOS <- "-24.3236411"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-24.3236411" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "11.8039467"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 11.8039467-0
 Parameter: XTRAN <- "11.8039467"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "28.2049413"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 28.2049413-0
 Parameter: YTRAN <- "28.2049413"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-24.3236411"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -24.3236411-0
 Parameter: ZTRAN <- "-24.3236411"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "11.8039467"
 Parameter: YTRAN -> "28.2049413"
 Parameter: ZTRAN -> "-24.3236411"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    11.803947   28.204941  -24.323641
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.590838756"
Evaluating: 0.590838756*360.0
 Parameter: XPHI <- "212.701952"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.69989665"
Evaluating: 0.69989665*360.0
 Parameter: YPHI <- "251.962794"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.793833528"
Evaluating: 0.793833528*360.0
 Parameter: ZPHI <- "285.78007"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "11.8039467"
 Parameter: YPOS -> "28.2049413"
 Parameter: ZPOS -> "-24.3236411"
 Parameter: XPHI -> "212.701952"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.841492   -0.540269
    0.000000    0.540269   -0.841492

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  147.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "11.8039467"
 Parameter: YPOS -> "28.2049413"
 Parameter: ZPOS -> "-24.3236411"
 Parameter: YPHI -> "251.962794"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.309635    0.000000    0.950856
    0.000000    1.000000    0.000000
   -0.950856    0.000000   -0.309635

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  108.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "11.8039467"
 Parameter: YPOS -> "28.2049413"
 Parameter: ZPOS -> "-24.3236411"
 Parameter: ZPHI -> "285.78007"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.271946   -0.962313    0.000000
    0.962313    0.271946    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   74.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   11.803947 XMAX =   11.803947 XAVE =   11.803947
    YMIN =   28.204941 YMAX =   28.204941 YAVE =   28.204941
    ZMIN =  -24.323641 ZMAX =  -24.323641 ZAVE =  -24.323641
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "11.8039467"
Evaluating: 11.8039467+3.5
 Parameter: XMAX <- "15.3039467"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "28.2049413"
Evaluating: 28.2049413+3.5
 Parameter: YMAX <- "31.7049413"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-24.3236411"
Evaluating: -24.3236411+3.5
 Parameter: ZMAX <- "-20.8236411"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "11.8039467"
Evaluating: 11.8039467-3.5
 Parameter: XMIN <- "8.3039467"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "28.2049413"
Evaluating: 28.2049413-3.5
 Parameter: YMIN <- "24.7049413"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-24.3236411"
Evaluating: -24.3236411-3.5
 Parameter: ZMIN <- "-27.8236411"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "15.3039467"
 Parameter: XMIN -> "8.3039467"
 Parameter: YMAX -> "31.7049413"
 Parameter: YMIN -> "24.7049413"
 Parameter: ZMAX -> "-20.8236411"
 Parameter: ZMIN -> "-27.8236411"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "32"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "32" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "32"
Evaluating: 32
 Parameter: J <- "32"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "32" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "32"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.420996411"
Evaluating: 120.112447*(0.420996411-0.5)
 Parameter: XPOS <- "-9.4893144"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.14412815"
Evaluating: 120.112447*(0.14412815-0.5)
 Parameter: YPOS <- "-42.7446387"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.592138217"
Evaluating: 85*(0.592138217-0.5)+0
 Parameter: ZPOS <- "7.83174844"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "7.83174844" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "7.83174844" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "32"
Evaluating: 32
 Parameter: J <- "32"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "32" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "32"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.229945704"
Evaluating: 120.112447*(0.229945704-0.5)
 Parameter: XPOS <- "-32.4368823"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.609516619"
Evaluating: 120.112447*(0.609516619-0.5)
 Parameter: YPOS <- "13.1543091"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.297970419"
Evaluating: 85*(0.297970419-0.5)+0
 Parameter: ZPOS <- "-17.1725144"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-17.1725144" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-32.4368823"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -32.4368823-0
 Parameter: XTRAN <- "-32.4368823"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "13.1543091"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 13.1543091-0
 Parameter: YTRAN <- "13.1543091"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-17.1725144"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -17.1725144-0
 Parameter: ZTRAN <- "-17.1725144"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-32.4368823"
 Parameter: YTRAN -> "13.1543091"
 Parameter: ZTRAN -> "-17.1725144"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR   -32.436882   13.154309  -17.172514
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.121849354"
Evaluating: 0.121849354*360.0
 Parameter: XPHI <- "43.8657674"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.72062364"
Evaluating: 0.72062364*360.0
 Parameter: YPHI <- "259.42451"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.996639629"
Evaluating: 0.996639629*360.0
 Parameter: ZPHI <- "358.790266"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-32.4368823"
 Parameter: YPOS -> "13.1543091"
 Parameter: ZPOS -> "-17.1725144"
 Parameter: XPHI -> "43.8657674"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.720965    0.692971
    0.000000   -0.692971    0.720965

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   43.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-32.4368823"
 Parameter: YPOS -> "13.1543091"
 Parameter: ZPOS -> "-17.1725144"
 Parameter: YPHI -> "259.42451"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.183531    0.000000    0.983014
    0.000000    1.000000    0.000000
   -0.983014    0.000000   -0.183531

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  100.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-32.4368823"
 Parameter: YPOS -> "13.1543091"
 Parameter: ZPOS -> "-17.1725144"
 Parameter: ZPHI -> "358.790266"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.999777   -0.021112    0.000000
    0.021112    0.999777    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    1.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -32.436882 XMAX =  -32.436882 XAVE =  -32.436882
    YMIN =   13.154309 YMAX =   13.154309 YAVE =   13.154309
    ZMIN =  -17.172514 ZMAX =  -17.172514 ZAVE =  -17.172514
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-32.4368823"
Evaluating: -32.4368823+3.5
 Parameter: XMAX <- "-28.9368823"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "13.1543091"
Evaluating: 13.1543091+3.5
 Parameter: YMAX <- "16.6543091"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-17.1725144"
Evaluating: -17.1725144+3.5
 Parameter: ZMAX <- "-13.6725144"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-32.4368823"
Evaluating: -32.4368823-3.5
 Parameter: XMIN <- "-35.9368823"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "13.1543091"
Evaluating: 13.1543091-3.5
 Parameter: YMIN <- "9.6543091"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-17.1725144"
Evaluating: -17.1725144-3.5
 Parameter: ZMIN <- "-20.6725144"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-28.9368823"
 Parameter: XMIN -> "-35.9368823"
 Parameter: YMAX -> "16.6543091"
 Parameter: YMIN -> "9.6543091"
 Parameter: ZMAX -> "-13.6725144"
 Parameter: ZMIN -> "-20.6725144"
 SELRPN>      3 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      3 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
 5528 POS      NA       32       NA      -3529 MEMB     DPPC     295      NC3           2.7854
 5528 POS      NA       32       NA      -3531 MEMB     DPPC     295      GL1           3.8840
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "32"
Evaluating: 32
 Parameter: J <- "32"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "32" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "32"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.576338996"
Evaluating: 120.112447*(0.576338996-0.5)
 Parameter: XPOS <- "9.16926361"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.957128818"
Evaluating: 120.112447*(0.957128818-0.5)
 Parameter: YPOS <- "54.9068609"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.613971114"
Evaluating: 85*(0.613971114-0.5)+0
 Parameter: ZPOS <- "9.68754469"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "9.68754469" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "9.68754469" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "32"
Evaluating: 32
 Parameter: J <- "32"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "32" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "32"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.251734211"
Evaluating: 120.112447*(0.251734211-0.5)
 Parameter: XPOS <- "-29.8198114"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.223125609"
Evaluating: 120.112447*(0.223125609-0.5)
 Parameter: YPOS <- "-33.2560606"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "8.229351292E-03"
Evaluating: 85*(8.229351292E-03-0.5)+0
 Parameter: ZPOS <- "-41.8005051"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-41.8005051" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -32.436882 XMAX =  -32.436882 XAVE =  -32.436882
    YMIN =   13.154309 YMAX =   13.154309 YAVE =   13.154309
    ZMIN =  -17.172514 ZMAX =  -17.172514 ZAVE =  -17.172514
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-29.8198114"
 RDCMND substituted energy or value "?XAVE" to "-32.4368823"
Evaluating: -29.8198114--32.4368823
 Parameter: XTRAN <- "2.6170709"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-33.2560606"
 RDCMND substituted energy or value "?YAVE" to "13.1543091"
Evaluating: -33.2560606-13.1543091
 Parameter: YTRAN <- "-46.4103697"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-41.8005051"
 RDCMND substituted energy or value "?ZAVE" to "-17.1725144"
Evaluating: -41.8005051--17.1725144
 Parameter: ZTRAN <- "-24.6279907"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "2.6170709"
 Parameter: YTRAN -> "-46.4103697"
 Parameter: ZTRAN -> "-24.6279907"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR     2.617071  -46.410370  -24.627991
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.19201067"
Evaluating: 0.19201067*360.0
 Parameter: XPHI <- "69.1238412"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.779369562"
Evaluating: 0.779369562*360.0
 Parameter: YPHI <- "280.573042"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.736196885"
Evaluating: 0.736196885*360.0
 Parameter: ZPHI <- "265.030879"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-29.8198114"
 Parameter: YPOS -> "-33.2560606"
 Parameter: ZPOS -> "-41.8005051"
 Parameter: XPHI -> "69.1238412"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.356349    0.934353
    0.000000   -0.934353    0.356349

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   69.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-29.8198114"
 Parameter: YPOS -> "-33.2560606"
 Parameter: ZPOS -> "-41.8005051"
 Parameter: YPHI -> "280.573042"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.183489    0.000000    0.983022
    0.000000    1.000000    0.000000
   -0.983022    0.000000    0.183489

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   79.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-29.8198114"
 Parameter: YPOS -> "-33.2560606"
 Parameter: ZPOS -> "-41.8005051"
 Parameter: ZPHI -> "265.030879"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.086619   -0.996242    0.000000
    0.996242   -0.086619    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   94.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -29.819811 XMAX =  -29.819811 XAVE =  -29.819811
    YMIN =  -33.256061 YMAX =  -33.256061 YAVE =  -33.256061
    ZMIN =  -41.800505 ZMAX =  -41.800505 ZAVE =  -41.800505
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-29.8198114"
Evaluating: -29.8198114+3.5
 Parameter: XMAX <- "-26.3198114"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-33.2560606"
Evaluating: -33.2560606+3.5
 Parameter: YMAX <- "-29.7560606"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-41.8005051"
Evaluating: -41.8005051+3.5
 Parameter: ZMAX <- "-38.3005051"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-29.8198114"
Evaluating: -29.8198114-3.5
 Parameter: XMIN <- "-33.3198114"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-33.2560606"
Evaluating: -33.2560606-3.5
 Parameter: YMIN <- "-36.7560606"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-41.8005051"
Evaluating: -41.8005051-3.5
 Parameter: ZMIN <- "-45.3005051"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-26.3198114"
 Parameter: XMIN -> "-33.3198114"
 Parameter: YMAX -> "-29.7560606"
 Parameter: YMIN -> "-36.7560606"
 Parameter: ZMAX -> "-38.3005051"
 Parameter: ZMIN -> "-45.3005051"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "33"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "33" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "33"
Evaluating: 33
 Parameter: J <- "33"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "33" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "33"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.351666738"
Evaluating: 120.112447*(0.351666738-0.5)
 Parameter: XPOS <- "-17.8166711"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.891053826"
Evaluating: 120.112447*(0.891053826-0.5)
 Parameter: YPOS <- "46.9704319"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.886223"
Evaluating: 85*(0.886223-0.5)+0
 Parameter: ZPOS <- "32.828955"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "32.828955" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "32.828955" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-17.8166711"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -17.8166711-0
 Parameter: XTRAN <- "-17.8166711"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "46.9704319"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 46.9704319-0
 Parameter: YTRAN <- "46.9704319"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "32.828955"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 32.828955-0
 Parameter: ZTRAN <- "32.828955"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-17.8166711"
 Parameter: YTRAN -> "46.9704319"
 Parameter: ZTRAN -> "32.828955"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR   -17.816671   46.970432   32.828955
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.783670767"
Evaluating: 0.783670767*360.0
 Parameter: XPHI <- "282.121476"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.938566781"
Evaluating: 0.938566781*360.0
 Parameter: YPHI <- "337.884041"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.975261339"
Evaluating: 0.975261339*360.0
 Parameter: ZPHI <- "351.094082"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-17.8166711"
 Parameter: YPOS -> "46.9704319"
 Parameter: ZPOS -> "32.828955"
 Parameter: XPHI -> "282.121476"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.209985   -0.977705
    0.000000    0.977705    0.209985

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   77.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-17.8166711"
 Parameter: YPOS -> "46.9704319"
 Parameter: ZPOS -> "32.828955"
 Parameter: YPHI -> "337.884041"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.926424    0.000000    0.376482
    0.000000    1.000000    0.000000
   -0.376482    0.000000    0.926424

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   22.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-17.8166711"
 Parameter: YPOS -> "46.9704319"
 Parameter: ZPOS -> "32.828955"
 Parameter: ZPHI -> "351.094082"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.987944   -0.154812    0.000000
    0.154812    0.987944    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    8.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -17.816671 XMAX =  -17.816671 XAVE =  -17.816671
    YMIN =   46.970432 YMAX =   46.970432 YAVE =   46.970432
    ZMIN =   32.828955 ZMAX =   32.828955 ZAVE =   32.828955
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-17.8166711"
Evaluating: -17.8166711+3.5
 Parameter: XMAX <- "-14.3166711"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "46.9704319"
Evaluating: 46.9704319+3.5
 Parameter: YMAX <- "50.4704319"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "32.828955"
Evaluating: 32.828955+3.5
 Parameter: ZMAX <- "36.328955"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-17.8166711"
Evaluating: -17.8166711-3.5
 Parameter: XMIN <- "-21.3166711"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "46.9704319"
Evaluating: 46.9704319-3.5
 Parameter: YMIN <- "43.4704319"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "32.828955"
Evaluating: 32.828955-3.5
 Parameter: ZMIN <- "29.328955"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-14.3166711"
 Parameter: XMIN -> "-21.3166711"
 Parameter: YMAX -> "50.4704319"
 Parameter: YMIN -> "43.4704319"
 Parameter: ZMAX -> "36.328955"
 Parameter: ZMIN -> "29.328955"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "34"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "34" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "34"
Evaluating: 34
 Parameter: J <- "34"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "34" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "34"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.473815675"
Evaluating: 120.112447*(0.473815675-0.5)
 Parameter: XPOS <- "-3.14506335"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.907364714"
Evaluating: 120.112447*(0.907364714-0.5)
 Parameter: YPOS <- "48.9295726"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "1.385357819E-02"
Evaluating: 85*(1.385357819E-02-0.5)+0
 Parameter: ZPOS <- "-41.3224459"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-41.3224459" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-3.14506335"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -3.14506335-0
 Parameter: XTRAN <- "-3.14506335"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "48.9295726"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 48.9295726-0
 Parameter: YTRAN <- "48.9295726"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-41.3224459"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -41.3224459-0
 Parameter: ZTRAN <- "-41.3224459"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-3.14506335"
 Parameter: YTRAN -> "48.9295726"
 Parameter: ZTRAN -> "-41.3224459"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    -3.145063   48.929573  -41.322446
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.894244897"
Evaluating: 0.894244897*360.0
 Parameter: XPHI <- "321.928163"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.303513012"
Evaluating: 0.303513012*360.0
 Parameter: YPHI <- "109.264684"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.450217985"
Evaluating: 0.450217985*360.0
 Parameter: ZPHI <- "162.078475"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-3.14506335"
 Parameter: YPOS -> "48.9295726"
 Parameter: ZPOS -> "-41.3224459"
 Parameter: XPHI -> "321.928163"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.787238   -0.616649
    0.000000    0.616649    0.787238

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   38.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-3.14506335"
 Parameter: YPOS -> "48.9295726"
 Parameter: ZPOS -> "-41.3224459"
 Parameter: YPHI -> "109.264684"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.329933    0.000000   -0.944004
    0.000000    1.000000    0.000000
    0.944004    0.000000   -0.329933

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  109.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-3.14506335"
 Parameter: YPOS -> "48.9295726"
 Parameter: ZPOS -> "-41.3224459"
 Parameter: ZPHI -> "162.078475"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.951479    0.307714    0.000000
   -0.307714   -0.951479    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  162.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -3.145063 XMAX =   -3.145063 XAVE =   -3.145063
    YMIN =   48.929573 YMAX =   48.929573 YAVE =   48.929573
    ZMIN =  -41.322446 ZMAX =  -41.322446 ZAVE =  -41.322446
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-3.14506335"
Evaluating: -3.14506335+3.5
 Parameter: XMAX <- "0.35493665"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "48.9295726"
Evaluating: 48.9295726+3.5
 Parameter: YMAX <- "52.4295726"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-41.3224459"
Evaluating: -41.3224459+3.5
 Parameter: ZMAX <- "-37.8224459"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-3.14506335"
Evaluating: -3.14506335-3.5
 Parameter: XMIN <- "-6.64506335"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "48.9295726"
Evaluating: 48.9295726-3.5
 Parameter: YMIN <- "45.4295726"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-41.3224459"
Evaluating: -41.3224459-3.5
 Parameter: ZMIN <- "-44.8224459"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "0.35493665"
 Parameter: XMIN -> "-6.64506335"
 Parameter: YMAX -> "52.4295726"
 Parameter: YMIN -> "45.4295726"
 Parameter: ZMAX -> "-37.8224459"
 Parameter: ZMIN -> "-44.8224459"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      1 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
 5530 POS      NA       34       NA      -5515 POS      NA       19       NA            3.5876
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "34"
Evaluating: 34
 Parameter: J <- "34"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "34" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "34"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.377862557"
Evaluating: 120.112447*(0.377862557-0.5)
 Parameter: XPOS <- "-14.6702271"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.598483512"
Evaluating: 120.112447*(0.598483512-0.5)
 Parameter: YPOS <- "11.8290956"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.267961895"
Evaluating: 85*(0.267961895-0.5)+0
 Parameter: ZPOS <- "-19.7232389"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-19.7232389" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -3.145063 XMAX =   -3.145063 XAVE =   -3.145063
    YMIN =   48.929573 YMAX =   48.929573 YAVE =   48.929573
    ZMIN =  -41.322446 ZMAX =  -41.322446 ZAVE =  -41.322446
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-14.6702271"
 RDCMND substituted energy or value "?XAVE" to "-3.14506335"
Evaluating: -14.6702271--3.14506335
 Parameter: XTRAN <- "-11.5251638"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "11.8290956"
 RDCMND substituted energy or value "?YAVE" to "48.9295726"
Evaluating: 11.8290956-48.9295726
 Parameter: YTRAN <- "-37.100477"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-19.7232389"
 RDCMND substituted energy or value "?ZAVE" to "-41.3224459"
Evaluating: -19.7232389--41.3224459
 Parameter: ZTRAN <- "21.599207"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-11.5251638"
 Parameter: YTRAN -> "-37.100477"
 Parameter: ZTRAN -> "21.599207"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR   -11.525164  -37.100477   21.599207
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.833811832"
Evaluating: 0.833811832*360.0
 Parameter: XPHI <- "300.17226"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.361258758"
Evaluating: 0.361258758*360.0
 Parameter: YPHI <- "130.053153"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.453310807"
Evaluating: 0.453310807*360.0
 Parameter: ZPHI <- "163.191891"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-14.6702271"
 Parameter: YPOS -> "11.8290956"
 Parameter: ZPOS -> "-19.7232389"
 Parameter: XPHI -> "300.17226"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.502601   -0.864518
    0.000000    0.864518    0.502601

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   59.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-14.6702271"
 Parameter: YPOS -> "11.8290956"
 Parameter: ZPOS -> "-19.7232389"
 Parameter: YPHI -> "130.053153"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.643498    0.000000   -0.765448
    0.000000    1.000000    0.000000
    0.765448    0.000000   -0.643498

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  130.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-14.6702271"
 Parameter: YPOS -> "11.8290956"
 Parameter: ZPOS -> "-19.7232389"
 Parameter: ZPHI -> "163.191891"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.957279    0.289167    0.000000
   -0.289167   -0.957279    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  163.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -14.670227 XMAX =  -14.670227 XAVE =  -14.670227
    YMIN =   11.829096 YMAX =   11.829096 YAVE =   11.829096
    ZMIN =  -19.723239 ZMAX =  -19.723239 ZAVE =  -19.723239
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-14.6702271"
Evaluating: -14.6702271+3.5
 Parameter: XMAX <- "-11.1702271"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "11.8290956"
Evaluating: 11.8290956+3.5
 Parameter: YMAX <- "15.3290956"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-19.7232389"
Evaluating: -19.7232389+3.5
 Parameter: ZMAX <- "-16.2232389"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-14.6702271"
Evaluating: -14.6702271-3.5
 Parameter: XMIN <- "-18.1702271"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "11.8290956"
Evaluating: 11.8290956-3.5
 Parameter: YMIN <- "8.3290956"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-19.7232389"
Evaluating: -19.7232389-3.5
 Parameter: ZMIN <- "-23.2232389"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-11.1702271"
 Parameter: XMIN -> "-18.1702271"
 Parameter: YMAX -> "15.3290956"
 Parameter: YMIN -> "8.3290956"
 Parameter: ZMAX -> "-16.2232389"
 Parameter: ZMIN -> "-23.2232389"
 SELRPN>      3 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      3 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
 5530 POS      NA       34       NA      -2881 MEMB     DPPC     241      NC3           2.6931
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "34"
Evaluating: 34
 Parameter: J <- "34"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "34" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "34"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.141074937"
Evaluating: 120.112447*(0.141074937-0.5)
 Parameter: XPOS <- "-43.1113676"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.889573859"
Evaluating: 120.112447*(0.889573859-0.5)
 Parameter: YPOS <- "46.7926695"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.415118075"
Evaluating: 85*(0.415118075-0.5)+0
 Parameter: ZPOS <- "-7.21496362"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-7.21496362" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-7.21496362" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "34"
Evaluating: 34
 Parameter: J <- "34"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "34" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "34"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.59522783"
Evaluating: 120.112447*(0.59522783-0.5)
 Parameter: XPOS <- "11.4380477"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.24472921"
Evaluating: 120.112447*(0.24472921-0.5)
 Parameter: YPOS <- "-30.6611992"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.897488164"
Evaluating: 85*(0.897488164-0.5)+0
 Parameter: ZPOS <- "33.7864939"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "33.7864939" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "33.7864939" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -14.670227 XMAX =  -14.670227 XAVE =  -14.670227
    YMIN =   11.829096 YMAX =   11.829096 YAVE =   11.829096
    ZMIN =  -19.723239 ZMAX =  -19.723239 ZAVE =  -19.723239
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "11.4380477"
 RDCMND substituted energy or value "?XAVE" to "-14.6702271"
Evaluating: 11.4380477--14.6702271
 Parameter: XTRAN <- "26.1082748"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-30.6611992"
 RDCMND substituted energy or value "?YAVE" to "11.8290956"
Evaluating: -30.6611992-11.8290956
 Parameter: YTRAN <- "-42.4902948"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "33.7864939"
 RDCMND substituted energy or value "?ZAVE" to "-19.7232389"
Evaluating: 33.7864939--19.7232389
 Parameter: ZTRAN <- "53.5097328"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "26.1082748"
 Parameter: YTRAN -> "-42.4902948"
 Parameter: ZTRAN -> "53.5097328"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    26.108275  -42.490295   53.509733
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.973388323"
Evaluating: 0.973388323*360.0
 Parameter: XPHI <- "350.419796"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.380485567"
Evaluating: 0.380485567*360.0
 Parameter: YPHI <- "136.974804"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.764248282"
Evaluating: 0.764248282*360.0
 Parameter: ZPHI <- "275.129382"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "11.4380477"
 Parameter: YPOS -> "-30.6611992"
 Parameter: ZPOS -> "33.7864939"
 Parameter: XPHI -> "350.419796"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.986054   -0.166428
    0.000000    0.166428    0.986054

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    9.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "11.4380477"
 Parameter: YPOS -> "-30.6611992"
 Parameter: ZPOS -> "33.7864939"
 Parameter: YPHI -> "136.974804"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.731054    0.000000   -0.682320
    0.000000    1.000000    0.000000
    0.682320    0.000000   -0.731054

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  136.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "11.4380477"
 Parameter: YPOS -> "-30.6611992"
 Parameter: ZPOS -> "33.7864939"
 Parameter: ZPHI -> "275.129382"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.089405   -0.995995    0.000000
    0.995995    0.089405    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   84.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   11.438048 XMAX =   11.438048 XAVE =   11.438048
    YMIN =  -30.661199 YMAX =  -30.661199 YAVE =  -30.661199
    ZMIN =   33.786494 ZMAX =   33.786494 ZAVE =   33.786494
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "11.4380477"
Evaluating: 11.4380477+3.5
 Parameter: XMAX <- "14.9380477"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-30.6611992"
Evaluating: -30.6611992+3.5
 Parameter: YMAX <- "-27.1611992"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "33.7864939"
Evaluating: 33.7864939+3.5
 Parameter: ZMAX <- "37.2864939"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "11.4380477"
Evaluating: 11.4380477-3.5
 Parameter: XMIN <- "7.9380477"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-30.6611992"
Evaluating: -30.6611992-3.5
 Parameter: YMIN <- "-34.1611992"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "33.7864939"
Evaluating: 33.7864939-3.5
 Parameter: ZMIN <- "30.2864939"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "14.9380477"
 Parameter: XMIN -> "7.9380477"
 Parameter: YMAX -> "-27.1611992"
 Parameter: YMIN -> "-34.1611992"
 Parameter: ZMAX -> "37.2864939"
 Parameter: ZMIN -> "30.2864939"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "35"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "35" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "35"
Evaluating: 35
 Parameter: J <- "35"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "35" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "35"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.600370684"
Evaluating: 120.112447*(0.600370684-0.5)
 Parameter: XPOS <- "12.0557685"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.320606405"
Evaluating: 120.112447*(0.320606405-0.5)
 Parameter: YPOS <- "-21.5474037"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.523652148"
Evaluating: 85*(0.523652148-0.5)+0
 Parameter: ZPOS <- "2.01043258"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "2.01043258" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "2.01043258" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "35"
Evaluating: 35
 Parameter: J <- "35"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "35" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "35"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "6.679942799E-02"
Evaluating: 120.112447*(6.679942799E-02-0.5)
 Parameter: XPOS <- "-52.0327807"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.235306657"
Evaluating: 120.112447*(0.235306657-0.5)
 Parameter: YPOS <- "-31.7929651"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.694589016"
Evaluating: 85*(0.694589016-0.5)+0
 Parameter: ZPOS <- "16.5400664"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "16.5400664" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "16.5400664" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-52.0327807"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -52.0327807-0
 Parameter: XTRAN <- "-52.0327807"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-31.7929651"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -31.7929651-0
 Parameter: YTRAN <- "-31.7929651"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "16.5400664"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 16.5400664-0
 Parameter: ZTRAN <- "16.5400664"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-52.0327807"
 Parameter: YTRAN -> "-31.7929651"
 Parameter: ZTRAN -> "16.5400664"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR   -52.032781  -31.792965   16.540066
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.913116044"
Evaluating: 0.913116044*360.0
 Parameter: XPHI <- "328.721776"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.653875185"
Evaluating: 0.653875185*360.0
 Parameter: YPHI <- "235.395067"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.40164345"
Evaluating: 0.40164345*360.0
 Parameter: ZPHI <- "144.591642"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-52.0327807"
 Parameter: YPOS -> "-31.7929651"
 Parameter: ZPOS -> "16.5400664"
 Parameter: XPHI -> "328.721776"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.854656   -0.519194
    0.000000    0.519194    0.854656

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   31.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-52.0327807"
 Parameter: YPOS -> "-31.7929651"
 Parameter: ZPOS -> "16.5400664"
 Parameter: YPHI -> "235.395067"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.567915    0.000000    0.823087
    0.000000    1.000000    0.000000
   -0.823087    0.000000   -0.567915

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  124.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-52.0327807"
 Parameter: YPOS -> "-31.7929651"
 Parameter: ZPOS -> "16.5400664"
 Parameter: ZPHI -> "144.591642"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.815043    0.579400    0.000000
   -0.579400   -0.815043    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  144.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -52.032781 XMAX =  -52.032781 XAVE =  -52.032781
    YMIN =  -31.792965 YMAX =  -31.792965 YAVE =  -31.792965
    ZMIN =   16.540066 ZMAX =   16.540066 ZAVE =   16.540066
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-52.0327807"
Evaluating: -52.0327807+3.5
 Parameter: XMAX <- "-48.5327807"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-31.7929651"
Evaluating: -31.7929651+3.5
 Parameter: YMAX <- "-28.2929651"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "16.5400664"
Evaluating: 16.5400664+3.5
 Parameter: ZMAX <- "20.0400664"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-52.0327807"
Evaluating: -52.0327807-3.5
 Parameter: XMIN <- "-55.5327807"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-31.7929651"
Evaluating: -31.7929651-3.5
 Parameter: YMIN <- "-35.2929651"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "16.5400664"
Evaluating: 16.5400664-3.5
 Parameter: ZMIN <- "13.0400664"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-48.5327807"
 Parameter: XMIN -> "-55.5327807"
 Parameter: YMAX -> "-28.2929651"
 Parameter: YMIN -> "-35.2929651"
 Parameter: ZMAX -> "20.0400664"
 Parameter: ZMIN -> "13.0400664"
 SELRPN>      4 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      4 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
 5531 POS      NA       35       NA      -1779 MEMB     DPPC     149      GL1           2.5986
 5531 POS      NA       35       NA      -2293 MEMB     DPPC     192      NC3           3.7233
 5531 POS      NA       35       NA      -2294 MEMB     DPPC     192      PO4           2.5973
 5531 POS      NA       35       NA      -2295 MEMB     DPPC     192      GL1           2.6976
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         4
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "4"
 Comparing "4" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "35"
Evaluating: 35
 Parameter: J <- "35"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "35" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "35"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.87199203"
Evaluating: 120.112447*(0.87199203-0.5)
 Parameter: XPOS <- "44.680873"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.137897124"
Evaluating: 120.112447*(0.137897124-0.5)
 Parameter: YPOS <- "-43.4930625"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.43434702"
Evaluating: 85*(0.43434702-0.5)+0
 Parameter: ZPOS <- "-5.5805033"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-5.5805033" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-5.5805033" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "35"
Evaluating: 35
 Parameter: J <- "35"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "35" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "35"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.830437967"
Evaluating: 120.112447*(0.830437967-0.5)
 Parameter: XPOS <- "39.6897128"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.205739231"
Evaluating: 120.112447*(0.205739231-0.5)
 Parameter: YPOS <- "-35.344381"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "6.772586733E-02"
Evaluating: 85*(6.772586733E-02-0.5)+0
 Parameter: ZPOS <- "-36.7433013"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-36.7433013" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -52.032781 XMAX =  -52.032781 XAVE =  -52.032781
    YMIN =  -31.792965 YMAX =  -31.792965 YAVE =  -31.792965
    ZMIN =   16.540066 ZMAX =   16.540066 ZAVE =   16.540066
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "39.6897128"
 RDCMND substituted energy or value "?XAVE" to "-52.0327807"
Evaluating: 39.6897128--52.0327807
 Parameter: XTRAN <- "91.7224935"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-35.344381"
 RDCMND substituted energy or value "?YAVE" to "-31.7929651"
Evaluating: -35.344381--31.7929651
 Parameter: YTRAN <- "-3.5514159"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-36.7433013"
 RDCMND substituted energy or value "?ZAVE" to "16.5400664"
Evaluating: -36.7433013-16.5400664
 Parameter: ZTRAN <- "-53.2833677"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "91.7224935"
 Parameter: YTRAN -> "-3.5514159"
 Parameter: ZTRAN -> "-53.2833677"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    91.722493   -3.551416  -53.283368
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.786548683"
Evaluating: 0.786548683*360.0
 Parameter: XPHI <- "283.157526"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.718505602E-02"
Evaluating: 8.718505602E-02*360.0
 Parameter: YPHI <- "31.3866202"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.9834324"
Evaluating: 0.9834324*360.0
 Parameter: ZPHI <- "354.035664"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "39.6897128"
 Parameter: YPOS -> "-35.344381"
 Parameter: ZPOS -> "-36.7433013"
 Parameter: XPHI -> "283.157526"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.227629   -0.973748
    0.000000    0.973748    0.227629

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   76.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "39.6897128"
 Parameter: YPOS -> "-35.344381"
 Parameter: ZPOS -> "-36.7433013"
 Parameter: YPHI -> "31.3866202"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.853672    0.000000   -0.520810
    0.000000    1.000000    0.000000
    0.520810    0.000000    0.853672

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   31.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "39.6897128"
 Parameter: YPOS -> "-35.344381"
 Parameter: ZPOS -> "-36.7433013"
 Parameter: ZPHI -> "354.035664"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.994587   -0.103909    0.000000
    0.103909    0.994587    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    5.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   39.689713 XMAX =   39.689713 XAVE =   39.689713
    YMIN =  -35.344381 YMAX =  -35.344381 YAVE =  -35.344381
    ZMIN =  -36.743301 ZMAX =  -36.743301 ZAVE =  -36.743301
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "39.6897128"
Evaluating: 39.6897128+3.5
 Parameter: XMAX <- "43.1897128"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-35.344381"
Evaluating: -35.344381+3.5
 Parameter: YMAX <- "-31.844381"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-36.7433013"
Evaluating: -36.7433013+3.5
 Parameter: ZMAX <- "-33.2433013"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "39.6897128"
Evaluating: 39.6897128-3.5
 Parameter: XMIN <- "36.1897128"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-35.344381"
Evaluating: -35.344381-3.5
 Parameter: YMIN <- "-38.844381"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-36.7433013"
Evaluating: -36.7433013-3.5
 Parameter: ZMIN <- "-40.2433013"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "43.1897128"
 Parameter: XMIN -> "36.1897128"
 Parameter: YMAX -> "-31.844381"
 Parameter: YMIN -> "-38.844381"
 Parameter: ZMAX -> "-33.2433013"
 Parameter: ZMIN -> "-40.2433013"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "36"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "36" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "36"
Evaluating: 36
 Parameter: J <- "36"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "36" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "36"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "4.682652783E-02"
Evaluating: 120.112447*(4.682652783E-02-0.5)
 Parameter: XPOS <- "-54.4317747"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.280758373"
Evaluating: 120.112447*(0.280758373-0.5)
 Parameter: YPOS <- "-26.3336483"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.414083124"
Evaluating: 85*(0.414083124-0.5)+0
 Parameter: ZPOS <- "-7.30293446"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-7.30293446" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-7.30293446" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "36"
Evaluating: 36
 Parameter: J <- "36"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "36" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "36"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.12343366"
Evaluating: 120.112447*(0.12343366-0.5)
 Parameter: XPOS <- "-45.2303046"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.647923142"
Evaluating: 120.112447*(0.647923142-0.5)
 Parameter: YPOS <- "17.7674106"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.288055527"
Evaluating: 85*(0.288055527-0.5)+0
 Parameter: ZPOS <- "-18.0152802"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-18.0152802" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-45.2303046"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -45.2303046-0
 Parameter: XTRAN <- "-45.2303046"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "17.7674106"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 17.7674106-0
 Parameter: YTRAN <- "17.7674106"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-18.0152802"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -18.0152802-0
 Parameter: ZTRAN <- "-18.0152802"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-45.2303046"
 Parameter: YTRAN -> "17.7674106"
 Parameter: ZTRAN -> "-18.0152802"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR   -45.230305   17.767411  -18.015280
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.92428829"
Evaluating: 0.92428829*360.0
 Parameter: XPHI <- "332.743784"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.704635481"
Evaluating: 0.704635481*360.0
 Parameter: YPHI <- "253.668773"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.641735916"
Evaluating: 0.641735916*360.0
 Parameter: ZPHI <- "231.02493"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-45.2303046"
 Parameter: YPOS -> "17.7674106"
 Parameter: ZPOS -> "-18.0152802"
 Parameter: XPHI -> "332.743784"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.888967   -0.457970
    0.000000    0.457970    0.888967

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   27.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-45.2303046"
 Parameter: YPOS -> "17.7674106"
 Parameter: ZPOS -> "-18.0152802"
 Parameter: YPHI -> "253.668773"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.281190    0.000000    0.959652
    0.000000    1.000000    0.000000
   -0.959652    0.000000   -0.281190

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  106.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-45.2303046"
 Parameter: YPOS -> "17.7674106"
 Parameter: ZPOS -> "-18.0152802"
 Parameter: ZPHI -> "231.02493"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.628982   -0.777420    0.000000
    0.777420   -0.628982    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  128.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -45.230305 XMAX =  -45.230305 XAVE =  -45.230305
    YMIN =   17.767411 YMAX =   17.767411 YAVE =   17.767411
    ZMIN =  -18.015280 ZMAX =  -18.015280 ZAVE =  -18.015280
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-45.2303046"
Evaluating: -45.2303046+3.5
 Parameter: XMAX <- "-41.7303046"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "17.7674106"
Evaluating: 17.7674106+3.5
 Parameter: YMAX <- "21.2674106"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-18.0152802"
Evaluating: -18.0152802+3.5
 Parameter: ZMAX <- "-14.5152802"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-45.2303046"
Evaluating: -45.2303046-3.5
 Parameter: XMIN <- "-48.7303046"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "17.7674106"
Evaluating: 17.7674106-3.5
 Parameter: YMIN <- "14.2674106"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-18.0152802"
Evaluating: -18.0152802-3.5
 Parameter: ZMIN <- "-21.5152802"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-41.7303046"
 Parameter: XMIN -> "-48.7303046"
 Parameter: YMAX -> "21.2674106"
 Parameter: YMIN -> "14.2674106"
 Parameter: ZMAX -> "-14.5152802"
 Parameter: ZMIN -> "-21.5152802"
 SELRPN>      2 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      2 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
 5532 POS      NA       36       NA      -4274 MEMB     DPPC     357      PO4           1.6242
 5532 POS      NA       36       NA      -4275 MEMB     DPPC     357      GL1           2.6618
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "36"
Evaluating: 36
 Parameter: J <- "36"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "36" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "36"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.918799138"
Evaluating: 120.112447*(0.918799138-0.5)
 Parameter: XPOS <- "50.3029893"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.271417567"
Evaluating: 120.112447*(0.271417567-0.5)
 Parameter: YPOS <- "-27.4555954"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.544724839"
Evaluating: 85*(0.544724839-0.5)+0
 Parameter: ZPOS <- "3.80161132"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "3.80161132" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "3.80161132" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "36"
Evaluating: 36
 Parameter: J <- "36"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "36" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "36"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "3.842446062E-02"
Evaluating: 120.112447*(3.842446062E-02-0.5)
 Parameter: XPOS <- "-55.4409675"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.861282605"
Evaluating: 120.112447*(0.861282605-0.5)
 Parameter: YPOS <- "43.3945377"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "1.182293283E-02"
Evaluating: 85*(1.182293283E-02-0.5)+0
 Parameter: ZPOS <- "-41.4950507"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-41.4950507" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -45.230305 XMAX =  -45.230305 XAVE =  -45.230305
    YMIN =   17.767411 YMAX =   17.767411 YAVE =   17.767411
    ZMIN =  -18.015280 ZMAX =  -18.015280 ZAVE =  -18.015280
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-55.4409675"
 RDCMND substituted energy or value "?XAVE" to "-45.2303046"
Evaluating: -55.4409675--45.2303046
 Parameter: XTRAN <- "-10.2106629"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "43.3945377"
 RDCMND substituted energy or value "?YAVE" to "17.7674106"
Evaluating: 43.3945377-17.7674106
 Parameter: YTRAN <- "25.6271271"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-41.4950507"
 RDCMND substituted energy or value "?ZAVE" to "-18.0152802"
Evaluating: -41.4950507--18.0152802
 Parameter: ZTRAN <- "-23.4797705"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-10.2106629"
 Parameter: YTRAN -> "25.6271271"
 Parameter: ZTRAN -> "-23.4797705"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR   -10.210663   25.627127  -23.479771
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.392822647"
Evaluating: 0.392822647*360.0
 Parameter: XPHI <- "141.416153"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.113245484"
Evaluating: 0.113245484*360.0
 Parameter: YPHI <- "40.7683742"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.709049199"
Evaluating: 0.709049199*360.0
 Parameter: ZPHI <- "255.257712"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-55.4409675"
 Parameter: YPOS -> "43.3945377"
 Parameter: ZPOS -> "-41.4950507"
 Parameter: XPHI -> "141.416153"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.781696    0.623659
    0.000000   -0.623659   -0.781696

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  141.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-55.4409675"
 Parameter: YPOS -> "43.3945377"
 Parameter: ZPOS -> "-41.4950507"
 Parameter: YPHI -> "40.7683742"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.757356    0.000000   -0.653003
    0.000000    1.000000    0.000000
    0.653003    0.000000    0.757356

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   40.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-55.4409675"
 Parameter: YPOS -> "43.3945377"
 Parameter: ZPOS -> "-41.4950507"
 Parameter: ZPHI -> "255.257712"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.254472   -0.967080    0.000000
    0.967080   -0.254472    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  104.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -55.440967 XMAX =  -55.440967 XAVE =  -55.440967
    YMIN =   43.394538 YMAX =   43.394538 YAVE =   43.394538
    ZMIN =  -41.495051 ZMAX =  -41.495051 ZAVE =  -41.495051
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-55.4409675"
Evaluating: -55.4409675+3.5
 Parameter: XMAX <- "-51.9409675"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "43.3945377"
Evaluating: 43.3945377+3.5
 Parameter: YMAX <- "46.8945377"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-41.4950507"
Evaluating: -41.4950507+3.5
 Parameter: ZMAX <- "-37.9950507"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-55.4409675"
Evaluating: -55.4409675-3.5
 Parameter: XMIN <- "-58.9409675"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "43.3945377"
Evaluating: 43.3945377-3.5
 Parameter: YMIN <- "39.8945377"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-41.4950507"
Evaluating: -41.4950507-3.5
 Parameter: ZMIN <- "-44.9950507"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-51.9409675"
 Parameter: XMIN -> "-58.9409675"
 Parameter: YMAX -> "46.8945377"
 Parameter: YMIN -> "39.8945377"
 Parameter: ZMAX -> "-37.9950507"
 Parameter: ZMIN -> "-44.9950507"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "37"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "37" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "37"
Evaluating: 37
 Parameter: J <- "37"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "37" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "37"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.524134096"
Evaluating: 120.112447*(0.524134096-0.5)
 Parameter: XPOS <- "2.89880533"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.101736776"
Evaluating: 120.112447*(0.101736776-0.5)
 Parameter: YPOS <- "-47.8363704"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.661813548"
Evaluating: 85*(0.661813548-0.5)+0
 Parameter: ZPOS <- "13.7541516"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "13.7541516" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "13.7541516" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "37"
Evaluating: 37
 Parameter: J <- "37"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "37" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "37"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.405175355"
Evaluating: 120.112447*(0.405175355-0.5)
 Parameter: XPOS <- "-11.3896201"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.733580413"
Evaluating: 120.112447*(0.733580413-0.5)
 Parameter: YPOS <- "28.055915"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.27572096"
Evaluating: 85*(0.27572096-0.5)+0
 Parameter: ZPOS <- "-19.0637184"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-19.0637184" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-11.3896201"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -11.3896201-0
 Parameter: XTRAN <- "-11.3896201"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "28.055915"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 28.055915-0
 Parameter: YTRAN <- "28.055915"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-19.0637184"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -19.0637184-0
 Parameter: ZTRAN <- "-19.0637184"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-11.3896201"
 Parameter: YTRAN -> "28.055915"
 Parameter: ZTRAN -> "-19.0637184"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR   -11.389620   28.055915  -19.063718
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.882013246"
Evaluating: 0.882013246*360.0
 Parameter: XPHI <- "317.524769"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.971930519"
Evaluating: 0.971930519*360.0
 Parameter: YPHI <- "349.894987"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.887348524"
Evaluating: 0.887348524*360.0
 Parameter: ZPHI <- "319.445469"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-11.3896201"
 Parameter: YPOS -> "28.055915"
 Parameter: ZPOS -> "-19.0637184"
 Parameter: XPHI -> "317.524769"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.737569   -0.675271
    0.000000    0.675271    0.737569

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   42.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-11.3896201"
 Parameter: YPOS -> "28.055915"
 Parameter: ZPOS -> "-19.0637184"
 Parameter: YPHI -> "349.894987"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.984488    0.000000    0.175453
    0.000000    1.000000    0.000000
   -0.175453    0.000000    0.984488

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   10.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-11.3896201"
 Parameter: YPOS -> "28.055915"
 Parameter: ZPOS -> "-19.0637184"
 Parameter: ZPHI -> "319.445469"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.759788   -0.650171    0.000000
    0.650171    0.759788    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   40.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -11.389620 XMAX =  -11.389620 XAVE =  -11.389620
    YMIN =   28.055915 YMAX =   28.055915 YAVE =   28.055915
    ZMIN =  -19.063718 ZMAX =  -19.063718 ZAVE =  -19.063718
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-11.3896201"
Evaluating: -11.3896201+3.5
 Parameter: XMAX <- "-7.8896201"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "28.055915"
Evaluating: 28.055915+3.5
 Parameter: YMAX <- "31.555915"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-19.0637184"
Evaluating: -19.0637184+3.5
 Parameter: ZMAX <- "-15.5637184"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-11.3896201"
Evaluating: -11.3896201-3.5
 Parameter: XMIN <- "-14.8896201"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "28.055915"
Evaluating: 28.055915-3.5
 Parameter: YMIN <- "24.555915"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-19.0637184"
Evaluating: -19.0637184-3.5
 Parameter: ZMIN <- "-22.5637184"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-7.8896201"
 Parameter: XMIN -> "-14.8896201"
 Parameter: YMAX -> "31.555915"
 Parameter: YMIN -> "24.555915"
 Parameter: ZMAX -> "-15.5637184"
 Parameter: ZMIN -> "-22.5637184"
 SELRPN>      2 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      2 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
 5533 POS      NA       37       NA      -3169 MEMB     DPPC     265      NC3           3.1569
 5533 POS      NA       37       NA      -3457 MEMB     DPPC     289      NC3           3.6421
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "37"
Evaluating: 37
 Parameter: J <- "37"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "37" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "37"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.254479217"
Evaluating: 120.112447*(0.254479217-0.5)
 Parameter: XPOS <- "-29.490102"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.239001349"
Evaluating: 120.112447*(0.239001349-0.5)
 Parameter: YPOS <- "-31.3491866"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.174460175"
Evaluating: 85*(0.174460175-0.5)+0
 Parameter: ZPOS <- "-27.6708851"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-27.6708851" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -11.389620 XMAX =  -11.389620 XAVE =  -11.389620
    YMIN =   28.055915 YMAX =   28.055915 YAVE =   28.055915
    ZMIN =  -19.063718 ZMAX =  -19.063718 ZAVE =  -19.063718
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-29.490102"
 RDCMND substituted energy or value "?XAVE" to "-11.3896201"
Evaluating: -29.490102--11.3896201
 Parameter: XTRAN <- "-18.1004819"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-31.3491866"
 RDCMND substituted energy or value "?YAVE" to "28.055915"
Evaluating: -31.3491866-28.055915
 Parameter: YTRAN <- "-59.4051016"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-27.6708851"
 RDCMND substituted energy or value "?ZAVE" to "-19.0637184"
Evaluating: -27.6708851--19.0637184
 Parameter: ZTRAN <- "-8.6071667"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-18.1004819"
 Parameter: YTRAN -> "-59.4051016"
 Parameter: ZTRAN -> "-8.6071667"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR   -18.100482  -59.405102   -8.607167
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.215598108"
Evaluating: 0.215598108*360.0
 Parameter: XPHI <- "77.6153189"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.388492563"
Evaluating: 0.388492563*360.0
 Parameter: YPHI <- "139.857323"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.565517852"
Evaluating: 0.565517852*360.0
 Parameter: ZPHI <- "203.586427"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-29.490102"
 Parameter: YPOS -> "-31.3491866"
 Parameter: ZPOS -> "-27.6708851"
 Parameter: XPHI -> "77.6153189"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.214474    0.976730
    0.000000   -0.976730    0.214474

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   77.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-29.490102"
 Parameter: YPOS -> "-31.3491866"
 Parameter: ZPOS -> "-27.6708851"
 Parameter: YPHI -> "139.857323"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.764441    0.000000   -0.644693
    0.000000    1.000000    0.000000
    0.644693    0.000000   -0.764441

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  139.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-29.490102"
 Parameter: YPOS -> "-31.3491866"
 Parameter: ZPOS -> "-27.6708851"
 Parameter: ZPHI -> "203.586427"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.916458   -0.400132    0.000000
    0.400132   -0.916458    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  156.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -29.490102 XMAX =  -29.490102 XAVE =  -29.490102
    YMIN =  -31.349187 YMAX =  -31.349187 YAVE =  -31.349187
    ZMIN =  -27.670885 ZMAX =  -27.670885 ZAVE =  -27.670885
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-29.490102"
Evaluating: -29.490102+3.5
 Parameter: XMAX <- "-25.990102"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-31.3491866"
Evaluating: -31.3491866+3.5
 Parameter: YMAX <- "-27.8491866"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-27.6708851"
Evaluating: -27.6708851+3.5
 Parameter: ZMAX <- "-24.1708851"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-29.490102"
Evaluating: -29.490102-3.5
 Parameter: XMIN <- "-32.990102"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-31.3491866"
Evaluating: -31.3491866-3.5
 Parameter: YMIN <- "-34.8491866"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-27.6708851"
Evaluating: -27.6708851-3.5
 Parameter: ZMIN <- "-31.1708851"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-25.990102"
 Parameter: XMIN -> "-32.990102"
 Parameter: YMAX -> "-27.8491866"
 Parameter: YMIN -> "-34.8491866"
 Parameter: ZMAX -> "-24.1708851"
 Parameter: ZMIN -> "-31.1708851"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "38"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "38" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "38"
Evaluating: 38
 Parameter: J <- "38"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "38" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "38"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "2.783609421E-02"
Evaluating: 120.112447*(2.783609421E-02-0.5)
 Parameter: XPOS <- "-56.7127621"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.930863157"
Evaluating: 120.112447*(0.930863157-0.5)
 Parameter: YPOS <- "51.7520281"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.883370271"
Evaluating: 85*(0.883370271-0.5)+0
 Parameter: ZPOS <- "32.586473"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "32.586473" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "32.586473" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-56.7127621"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -56.7127621-0
 Parameter: XTRAN <- "-56.7127621"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "51.7520281"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 51.7520281-0
 Parameter: YTRAN <- "51.7520281"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "32.586473"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 32.586473-0
 Parameter: ZTRAN <- "32.586473"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-56.7127621"
 Parameter: YTRAN -> "51.7520281"
 Parameter: ZTRAN -> "32.586473"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR   -56.712762   51.752028   32.586473
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.306455894"
Evaluating: 0.306455894*360.0
 Parameter: XPHI <- "110.324122"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.521609436E-03"
Evaluating: 5.521609436E-03*360.0
 Parameter: YPHI <- "1.9877794"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.441905202"
Evaluating: 0.441905202*360.0
 Parameter: ZPHI <- "159.085873"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-56.7127621"
 Parameter: YPOS -> "51.7520281"
 Parameter: ZPOS -> "32.586473"
 Parameter: XPHI -> "110.324122"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.347330    0.937743
    0.000000   -0.937743   -0.347330

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  110.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-56.7127621"
 Parameter: YPOS -> "51.7520281"
 Parameter: ZPOS -> "32.586473"
 Parameter: YPHI -> "1.9877794"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.999398    0.000000   -0.034686
    0.000000    1.000000    0.000000
    0.034686    0.000000    0.999398

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    1.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-56.7127621"
 Parameter: YPOS -> "51.7520281"
 Parameter: ZPOS -> "32.586473"
 Parameter: ZPHI -> "159.085873"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.934116    0.356968    0.000000
   -0.356968   -0.934116    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  159.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -56.712762 XMAX =  -56.712762 XAVE =  -56.712762
    YMIN =   51.752028 YMAX =   51.752028 YAVE =   51.752028
    ZMIN =   32.586473 ZMAX =   32.586473 ZAVE =   32.586473
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-56.7127621"
Evaluating: -56.7127621+3.5
 Parameter: XMAX <- "-53.2127621"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "51.7520281"
Evaluating: 51.7520281+3.5
 Parameter: YMAX <- "55.2520281"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "32.586473"
Evaluating: 32.586473+3.5
 Parameter: ZMAX <- "36.086473"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-56.7127621"
Evaluating: -56.7127621-3.5
 Parameter: XMIN <- "-60.2127621"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "51.7520281"
Evaluating: 51.7520281-3.5
 Parameter: YMIN <- "48.2520281"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "32.586473"
Evaluating: 32.586473-3.5
 Parameter: ZMIN <- "29.086473"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-53.2127621"
 Parameter: XMIN -> "-60.2127621"
 Parameter: YMAX -> "55.2520281"
 Parameter: YMIN -> "48.2520281"
 Parameter: ZMAX -> "36.086473"
 Parameter: ZMIN -> "29.086473"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "39"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "39" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "39"
Evaluating: 39
 Parameter: J <- "39"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "39" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "39"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.441860333"
Evaluating: 120.112447*(0.441860333-0.5)
 Parameter: XPOS <- "-6.98329767"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.926783055"
Evaluating: 120.112447*(0.926783055-0.5)
 Parameter: YPOS <- "51.2619571"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.169057203"
Evaluating: 85*(0.169057203-0.5)+0
 Parameter: ZPOS <- "-28.1301377"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-28.1301377" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-6.98329767"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -6.98329767-0
 Parameter: XTRAN <- "-6.98329767"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "51.2619571"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 51.2619571-0
 Parameter: YTRAN <- "51.2619571"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-28.1301377"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -28.1301377-0
 Parameter: ZTRAN <- "-28.1301377"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-6.98329767"
 Parameter: YTRAN -> "51.2619571"
 Parameter: ZTRAN -> "-28.1301377"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    -6.983298   51.261957  -28.130138
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.930575789"
Evaluating: 0.930575789*360.0
 Parameter: XPHI <- "335.007284"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.865466667"
Evaluating: 0.865466667*360.0
 Parameter: YPHI <- "311.568"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.419641199"
Evaluating: 0.419641199*360.0
 Parameter: ZPHI <- "151.070832"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-6.98329767"
 Parameter: YPOS -> "51.2619571"
 Parameter: ZPOS -> "-28.1301377"
 Parameter: XPHI -> "335.007284"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.906362   -0.422503
    0.000000    0.422503    0.906362

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   24.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-6.98329767"
 Parameter: YPOS -> "51.2619571"
 Parameter: ZPOS -> "-28.1301377"
 Parameter: YPHI -> "311.568"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.663508    0.000000    0.748169
    0.000000    1.000000    0.000000
   -0.748169    0.000000    0.663508

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   48.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-6.98329767"
 Parameter: YPOS -> "51.2619571"
 Parameter: ZPOS -> "-28.1301377"
 Parameter: ZPHI -> "151.070832"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.875218    0.483728    0.000000
   -0.483728   -0.875218    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  151.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -6.983298 XMAX =   -6.983298 XAVE =   -6.983298
    YMIN =   51.261957 YMAX =   51.261957 YAVE =   51.261957
    ZMIN =  -28.130138 ZMAX =  -28.130138 ZAVE =  -28.130138
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-6.98329767"
Evaluating: -6.98329767+3.5
 Parameter: XMAX <- "-3.48329767"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "51.2619571"
Evaluating: 51.2619571+3.5
 Parameter: YMAX <- "54.7619571"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-28.1301377"
Evaluating: -28.1301377+3.5
 Parameter: ZMAX <- "-24.6301377"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-6.98329767"
Evaluating: -6.98329767-3.5
 Parameter: XMIN <- "-10.4832977"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "51.2619571"
Evaluating: 51.2619571-3.5
 Parameter: YMIN <- "47.7619571"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-28.1301377"
Evaluating: -28.1301377-3.5
 Parameter: ZMIN <- "-31.6301377"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-3.48329767"
 Parameter: XMIN -> "-10.4832977"
 Parameter: YMAX -> "54.7619571"
 Parameter: YMIN -> "47.7619571"
 Parameter: ZMAX -> "-24.6301377"
 Parameter: ZMIN -> "-31.6301377"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "40"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "40" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "40"
Evaluating: 40
 Parameter: J <- "40"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "40" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "40"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.778210445"
Evaluating: 120.112447*(0.778210445-0.5)
 Parameter: XPOS <- "33.4165373"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.542383333"
Evaluating: 120.112447*(0.542383333-0.5)
 Parameter: YPOS <- "5.09076584"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.981161247"
Evaluating: 85*(0.981161247-0.5)+0
 Parameter: ZPOS <- "40.898706"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "40.898706" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "40.898706" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "33.4165373"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 33.4165373-0
 Parameter: XTRAN <- "33.4165373"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "5.09076584"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 5.09076584-0
 Parameter: YTRAN <- "5.09076584"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "40.898706"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 40.898706-0
 Parameter: ZTRAN <- "40.898706"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "33.4165373"
 Parameter: YTRAN -> "5.09076584"
 Parameter: ZTRAN -> "40.898706"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    33.416537    5.090766   40.898706
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.648670507E-02"
Evaluating: 9.648670507E-02*360.0
 Parameter: XPHI <- "34.7352138"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.933512914"
Evaluating: 0.933512914*360.0
 Parameter: YPHI <- "336.064649"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.484317117"
Evaluating: 0.484317117*360.0
 Parameter: ZPHI <- "174.354162"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "33.4165373"
 Parameter: YPOS -> "5.09076584"
 Parameter: ZPOS -> "40.898706"
 Parameter: XPHI -> "34.7352138"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.821794    0.569785
    0.000000   -0.569785    0.821794

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   34.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "33.4165373"
 Parameter: YPOS -> "5.09076584"
 Parameter: ZPOS -> "40.898706"
 Parameter: YPHI -> "336.064649"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.914004    0.000000    0.405706
    0.000000    1.000000    0.000000
   -0.405706    0.000000    0.914004

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   23.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "33.4165373"
 Parameter: YPOS -> "5.09076584"
 Parameter: ZPOS -> "40.898706"
 Parameter: ZPHI -> "174.354162"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.995149    0.098379    0.000000
   -0.098379   -0.995149    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  174.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   33.416537 XMAX =   33.416537 XAVE =   33.416537
    YMIN =    5.090766 YMAX =    5.090766 YAVE =    5.090766
    ZMIN =   40.898706 ZMAX =   40.898706 ZAVE =   40.898706
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "33.4165373"
Evaluating: 33.4165373+3.5
 Parameter: XMAX <- "36.9165373"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "5.09076584"
Evaluating: 5.09076584+3.5
 Parameter: YMAX <- "8.59076584"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "40.898706"
Evaluating: 40.898706+3.5
 Parameter: ZMAX <- "44.398706"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "33.4165373"
Evaluating: 33.4165373-3.5
 Parameter: XMIN <- "29.9165373"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "5.09076584"
Evaluating: 5.09076584-3.5
 Parameter: YMIN <- "1.59076584"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "40.898706"
Evaluating: 40.898706-3.5
 Parameter: ZMIN <- "37.398706"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "36.9165373"
 Parameter: XMIN -> "29.9165373"
 Parameter: YMAX -> "8.59076584"
 Parameter: YMIN -> "1.59076584"
 Parameter: ZMAX -> "44.398706"
 Parameter: ZMIN -> "37.398706"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "41"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "41" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "41"
Evaluating: 41
 Parameter: J <- "41"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "41" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "41"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.443190954"
Evaluating: 120.112447*(0.443190954-0.5)
 Parameter: XPOS <- "-6.82347353"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "3.778611246E-02"
Evaluating: 120.112447*(3.778611246E-02-0.5)
 Parameter: YPOS <- "-55.5176411"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "3.592163647E-02"
Evaluating: 85*(3.592163647E-02-0.5)+0
 Parameter: ZPOS <- "-39.4466609"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-39.4466609" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-6.82347353"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -6.82347353-0
 Parameter: XTRAN <- "-6.82347353"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-55.5176411"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -55.5176411-0
 Parameter: YTRAN <- "-55.5176411"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-39.4466609"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -39.4466609-0
 Parameter: ZTRAN <- "-39.4466609"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-6.82347353"
 Parameter: YTRAN -> "-55.5176411"
 Parameter: ZTRAN -> "-39.4466609"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    -6.823474  -55.517641  -39.446661
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.766016542"
Evaluating: 0.766016542*360.0
 Parameter: XPHI <- "275.765955"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.913532516"
Evaluating: 0.913532516*360.0
 Parameter: YPHI <- "328.871706"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.133476659"
Evaluating: 0.133476659*360.0
 Parameter: ZPHI <- "48.0515972"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-6.82347353"
 Parameter: YPOS -> "-55.5176411"
 Parameter: ZPOS -> "-39.4466609"
 Parameter: XPHI -> "275.765955"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.100465   -0.994941
    0.000000    0.994941    0.100465

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   84.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-6.82347353"
 Parameter: YPOS -> "-55.5176411"
 Parameter: ZPOS -> "-39.4466609"
 Parameter: YPHI -> "328.871706"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.856012    0.000000    0.516956
    0.000000    1.000000    0.000000
   -0.516956    0.000000    0.856012

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   31.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-6.82347353"
 Parameter: YPOS -> "-55.5176411"
 Parameter: ZPOS -> "-39.4466609"
 Parameter: ZPHI -> "48.0515972"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.668461    0.743747    0.000000
   -0.743747    0.668461    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   48.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -6.823474 XMAX =   -6.823474 XAVE =   -6.823474
    YMIN =  -55.517641 YMAX =  -55.517641 YAVE =  -55.517641
    ZMIN =  -39.446661 ZMAX =  -39.446661 ZAVE =  -39.446661
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-6.82347353"
Evaluating: -6.82347353+3.5
 Parameter: XMAX <- "-3.32347353"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-55.5176411"
Evaluating: -55.5176411+3.5
 Parameter: YMAX <- "-52.0176411"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-39.4466609"
Evaluating: -39.4466609+3.5
 Parameter: ZMAX <- "-35.9466609"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-6.82347353"
Evaluating: -6.82347353-3.5
 Parameter: XMIN <- "-10.3234735"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-55.5176411"
Evaluating: -55.5176411-3.5
 Parameter: YMIN <- "-59.0176411"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-39.4466609"
Evaluating: -39.4466609-3.5
 Parameter: ZMIN <- "-42.9466609"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-3.32347353"
 Parameter: XMIN -> "-10.3234735"
 Parameter: YMAX -> "-52.0176411"
 Parameter: YMIN -> "-59.0176411"
 Parameter: ZMAX -> "-35.9466609"
 Parameter: ZMIN -> "-42.9466609"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "42"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "42" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "42"
Evaluating: 42
 Parameter: J <- "42"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "42" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "42"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.930903477"
Evaluating: 120.112447*(0.930903477-0.5)
 Parameter: XPOS <- "51.756871"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.50441097"
Evaluating: 120.112447*(0.50441097-0.5)
 Parameter: YPOS <- "0.5298124"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.272765004"
Evaluating: 85*(0.272765004-0.5)+0
 Parameter: ZPOS <- "-19.3149747"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-19.3149747" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "51.756871"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 51.756871-0
 Parameter: XTRAN <- "51.756871"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "0.5298124"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 0.5298124-0
 Parameter: YTRAN <- "0.5298124"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-19.3149747"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -19.3149747-0
 Parameter: ZTRAN <- "-19.3149747"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "51.756871"
 Parameter: YTRAN -> "0.5298124"
 Parameter: ZTRAN -> "-19.3149747"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    51.756871    0.529812  -19.314975
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.283302448"
Evaluating: 0.283302448*360.0
 Parameter: XPHI <- "101.988881"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.169695477"
Evaluating: 0.169695477*360.0
 Parameter: YPHI <- "61.0903717"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.754281765"
Evaluating: 0.754281765*360.0
 Parameter: ZPHI <- "271.541435"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "51.756871"
 Parameter: YPOS -> "0.5298124"
 Parameter: ZPOS -> "-19.3149747"
 Parameter: XPHI -> "101.988881"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.207722    0.978188
    0.000000   -0.978188   -0.207722

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  101.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "51.756871"
 Parameter: YPOS -> "0.5298124"
 Parameter: ZPOS -> "-19.3149747"
 Parameter: YPHI -> "61.0903717"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.483429    0.000000   -0.875383
    0.000000    1.000000    0.000000
    0.875383    0.000000    0.483429

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   61.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "51.756871"
 Parameter: YPOS -> "0.5298124"
 Parameter: ZPOS -> "-19.3149747"
 Parameter: ZPHI -> "271.541435"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.026900   -0.999638    0.000000
    0.999638    0.026900    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   88.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   51.756871 XMAX =   51.756871 XAVE =   51.756871
    YMIN =    0.529812 YMAX =    0.529812 YAVE =    0.529812
    ZMIN =  -19.314975 ZMAX =  -19.314975 ZAVE =  -19.314975
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "51.756871"
Evaluating: 51.756871+3.5
 Parameter: XMAX <- "55.256871"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "0.5298124"
Evaluating: 0.5298124+3.5
 Parameter: YMAX <- "4.0298124"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-19.3149747"
Evaluating: -19.3149747+3.5
 Parameter: ZMAX <- "-15.8149747"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "51.756871"
Evaluating: 51.756871-3.5
 Parameter: XMIN <- "48.256871"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "0.5298124"
Evaluating: 0.5298124-3.5
 Parameter: YMIN <- "-2.9701876"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-19.3149747"
Evaluating: -19.3149747-3.5
 Parameter: ZMIN <- "-22.8149747"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "55.256871"
 Parameter: XMIN -> "48.256871"
 Parameter: YMAX -> "4.0298124"
 Parameter: YMIN -> "-2.9701876"
 Parameter: ZMAX -> "-15.8149747"
 Parameter: ZMIN -> "-22.8149747"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      1 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
 5538 POS      NA       42       NA      -4141 MEMB     DPPC     346      NC3           2.8772
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "42"
Evaluating: 42
 Parameter: J <- "42"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "42" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "42"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.202807248"
Evaluating: 120.112447*(0.202807248-0.5)
 Parameter: XPOS <- "-35.6965487"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.645490285"
Evaluating: 120.112447*(0.645490285-0.5)
 Parameter: YPOS <- "17.4751941"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.538501458"
Evaluating: 85*(0.538501458-0.5)+0
 Parameter: ZPOS <- "3.27262393"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "3.27262393" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "3.27262393" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "42"
Evaluating: 42
 Parameter: J <- "42"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "42" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "42"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.577376612"
Evaluating: 120.112447*(0.577376612-0.5)
 Parameter: XPOS <- "9.29389421"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.471170809"
Evaluating: 120.112447*(0.471170809-0.5)
 Parameter: YPOS <- "-3.46274468"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "6.646422082E-02"
Evaluating: 85*(6.646422082E-02-0.5)+0
 Parameter: ZPOS <- "-36.8505412"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-36.8505412" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   51.756871 XMAX =   51.756871 XAVE =   51.756871
    YMIN =    0.529812 YMAX =    0.529812 YAVE =    0.529812
    ZMIN =  -19.314975 ZMAX =  -19.314975 ZAVE =  -19.314975
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "9.29389421"
 RDCMND substituted energy or value "?XAVE" to "51.756871"
Evaluating: 9.29389421-51.756871
 Parameter: XTRAN <- "-42.4629768"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-3.46274468"
 RDCMND substituted energy or value "?YAVE" to "0.5298124"
Evaluating: -3.46274468-0.5298124
 Parameter: YTRAN <- "-3.99255708"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-36.8505412"
 RDCMND substituted energy or value "?ZAVE" to "-19.3149747"
Evaluating: -36.8505412--19.3149747
 Parameter: ZTRAN <- "-17.5355665"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-42.4629768"
 Parameter: YTRAN -> "-3.99255708"
 Parameter: ZTRAN -> "-17.5355665"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR   -42.462977   -3.992557  -17.535567
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.213134835"
Evaluating: 0.213134835*360.0
 Parameter: XPHI <- "76.7285406"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.649406164"
Evaluating: 0.649406164*360.0
 Parameter: YPHI <- "233.786219"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.474390687"
Evaluating: 0.474390687*360.0
 Parameter: ZPHI <- "170.780647"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "9.29389421"
 Parameter: YPOS -> "-3.46274468"
 Parameter: ZPOS -> "-36.8505412"
 Parameter: XPHI -> "76.7285406"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.229565    0.973293
    0.000000   -0.973293    0.229565

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   76.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "9.29389421"
 Parameter: YPOS -> "-3.46274468"
 Parameter: ZPOS -> "-36.8505412"
 Parameter: YPHI -> "233.786219"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.590800    0.000000    0.806818
    0.000000    1.000000    0.000000
   -0.806818    0.000000   -0.590800

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  126.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "9.29389421"
 Parameter: YPOS -> "-3.46274468"
 Parameter: ZPOS -> "-36.8505412"
 Parameter: ZPHI -> "170.780647"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.987082    0.160215    0.000000
   -0.160215   -0.987082    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  170.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    9.293894 XMAX =    9.293894 XAVE =    9.293894
    YMIN =   -3.462745 YMAX =   -3.462745 YAVE =   -3.462745
    ZMIN =  -36.850541 ZMAX =  -36.850541 ZAVE =  -36.850541
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "9.2938942"
Evaluating: 9.2938942+3.5
 Parameter: XMAX <- "12.7938942"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-3.46274468"
Evaluating: -3.46274468+3.5
 Parameter: YMAX <- "3.725532E-02"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-36.8505412"
Evaluating: -36.8505412+3.5
 Parameter: ZMAX <- "-33.3505412"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "9.2938942"
Evaluating: 9.2938942-3.5
 Parameter: XMIN <- "5.7938942"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-3.46274468"
Evaluating: -3.46274468-3.5
 Parameter: YMIN <- "-6.96274468"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-36.8505412"
Evaluating: -36.8505412-3.5
 Parameter: ZMIN <- "-40.3505412"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "12.7938942"
 Parameter: XMIN -> "5.7938942"
 Parameter: YMAX -> "3.725532E-02"
 Parameter: YMIN -> "-6.96274468"
 Parameter: ZMAX -> "-33.3505412"
 Parameter: ZMIN -> "-40.3505412"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "43"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "43" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "43"
Evaluating: 43
 Parameter: J <- "43"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "43" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "43"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.748379288"
Evaluating: 120.112447*(0.748379288-0.5)
 Parameter: XPOS <- "29.8334441"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.576461915"
Evaluating: 120.112447*(0.576461915-0.5)
 Parameter: YPOS <- "9.18402771"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.681559768"
Evaluating: 85*(0.681559768-0.5)+0
 Parameter: ZPOS <- "15.4325803"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "15.4325803" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "15.4325803" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "29.8334441"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 29.8334441-0
 Parameter: XTRAN <- "29.8334441"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "9.18402771"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 9.18402771-0
 Parameter: YTRAN <- "9.18402771"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "15.4325803"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 15.4325803-0
 Parameter: ZTRAN <- "15.4325803"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "29.8334441"
 Parameter: YTRAN -> "9.18402771"
 Parameter: ZTRAN -> "15.4325803"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    29.833444    9.184028   15.432580
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.392639921"
Evaluating: 0.392639921*360.0
 Parameter: XPHI <- "141.350372"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.145677222"
Evaluating: 0.145677222*360.0
 Parameter: YPHI <- "52.4437999"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.961049584"
Evaluating: 0.961049584*360.0
 Parameter: ZPHI <- "345.97785"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "29.8334441"
 Parameter: YPOS -> "9.18402771"
 Parameter: ZPOS -> "15.4325803"
 Parameter: XPHI -> "141.350372"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.780980    0.624556
    0.000000   -0.624556   -0.780980

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  141.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "29.8334441"
 Parameter: YPOS -> "9.18402771"
 Parameter: ZPOS -> "15.4325803"
 Parameter: YPHI -> "52.4437999"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.609539    0.000000   -0.792756
    0.000000    1.000000    0.000000
    0.792756    0.000000    0.609539

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   52.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "29.8334441"
 Parameter: YPOS -> "9.18402771"
 Parameter: ZPOS -> "15.4325803"
 Parameter: ZPHI -> "345.97785"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.970202   -0.242297    0.000000
    0.242297    0.970202    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   14.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   29.833444 XMAX =   29.833444 XAVE =   29.833444
    YMIN =    9.184028 YMAX =    9.184028 YAVE =    9.184028
    ZMIN =   15.432580 ZMAX =   15.432580 ZAVE =   15.432580
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "29.8334441"
Evaluating: 29.8334441+3.5
 Parameter: XMAX <- "33.3334441"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "9.18402771"
Evaluating: 9.18402771+3.5
 Parameter: YMAX <- "12.6840277"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "15.4325803"
Evaluating: 15.4325803+3.5
 Parameter: ZMAX <- "18.9325803"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "29.8334441"
Evaluating: 29.8334441-3.5
 Parameter: XMIN <- "26.3334441"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "9.18402771"
Evaluating: 9.18402771-3.5
 Parameter: YMIN <- "5.68402771"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "15.4325803"
Evaluating: 15.4325803-3.5
 Parameter: ZMIN <- "11.9325803"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "33.3334441"
 Parameter: XMIN -> "26.3334441"
 Parameter: YMAX -> "12.6840277"
 Parameter: YMIN -> "5.68402771"
 Parameter: ZMAX -> "18.9325803"
 Parameter: ZMIN -> "11.9325803"
 SELRPN>      3 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      3 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
 5539 POS      NA       43       NA      - 651 MEMB     DPPC     55       GL1           3.3080
 5539 POS      NA       43       NA      - 652 MEMB     DPPC     55       GL2           3.5294
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "43"
Evaluating: 43
 Parameter: J <- "43"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "43" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "43"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.204729512"
Evaluating: 120.112447*(0.204729512-0.5)
 Parameter: XPOS <- "-35.4656608"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.121090386"
Evaluating: 120.112447*(0.121090386-0.5)
 Parameter: YPOS <- "-45.5117609"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.39154705"
Evaluating: 85*(0.39154705-0.5)+0
 Parameter: ZPOS <- "-9.21850075"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-9.21850075" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-9.21850075" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "43"
Evaluating: 43
 Parameter: J <- "43"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "43" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "43"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.65588182"
Evaluating: 120.112447*(0.65588182-0.5)
 Parameter: XPOS <- "18.7233468"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.619233523"
Evaluating: 120.112447*(0.619233523-0.5)
 Parameter: YPOS <- "14.3214302"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.417500169"
Evaluating: 85*(0.417500169-0.5)+0
 Parameter: ZPOS <- "-7.01248563"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-7.01248563" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-7.01248563" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "43"
Evaluating: 43
 Parameter: J <- "43"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "43" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "43"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.818707763"
Evaluating: 120.112447*(0.818707763-0.5)
 Parameter: XPOS <- "38.2807693"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.716420771"
Evaluating: 120.112447*(0.716420771-0.5)
 Parameter: YPOS <- "25.9948284"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.689584901"
Evaluating: 85*(0.689584901-0.5)+0
 Parameter: ZPOS <- "16.1147166"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "16.1147166" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "16.1147166" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   29.833444 XMAX =   29.833444 XAVE =   29.833444
    YMIN =    9.184028 YMAX =    9.184028 YAVE =    9.184028
    ZMIN =   15.432580 ZMAX =   15.432580 ZAVE =   15.432580
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "38.2807693"
 RDCMND substituted energy or value "?XAVE" to "29.8334441"
Evaluating: 38.2807693-29.8334441
 Parameter: XTRAN <- "8.4473252"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "25.9948284"
 RDCMND substituted energy or value "?YAVE" to "9.18402771"
Evaluating: 25.9948284-9.18402771
 Parameter: YTRAN <- "16.8108007"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "16.1147166"
 RDCMND substituted energy or value "?ZAVE" to "15.4325803"
Evaluating: 16.1147166-15.4325803
 Parameter: ZTRAN <- "0.6821363"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "8.4473252"
 Parameter: YTRAN -> "16.8108007"
 Parameter: ZTRAN -> "0.6821363"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR     8.447325   16.810801    0.682136
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.723445954"
Evaluating: 0.723445954*360.0
 Parameter: XPHI <- "260.440543"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.304050025"
Evaluating: 0.304050025*360.0
 Parameter: YPHI <- "109.458009"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.147234629"
Evaluating: 0.147234629*360.0
 Parameter: ZPHI <- "53.0044664"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "38.2807693"
 Parameter: YPOS -> "25.9948284"
 Parameter: ZPOS -> "16.1147166"
 Parameter: XPHI -> "260.440543"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.166071   -0.986114
    0.000000    0.986114   -0.166071

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   99.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "38.2807693"
 Parameter: YPOS -> "25.9948284"
 Parameter: ZPOS -> "16.1147166"
 Parameter: YPHI -> "109.458009"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.333116    0.000000   -0.942886
    0.000000    1.000000    0.000000
    0.942886    0.000000   -0.333116

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  109.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "38.2807693"
 Parameter: YPOS -> "25.9948284"
 Parameter: ZPOS -> "16.1147166"
 Parameter: ZPHI -> "53.0044664"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.601753    0.798682    0.000000
   -0.798682    0.601753    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   53.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   38.280769 XMAX =   38.280769 XAVE =   38.280769
    YMIN =   25.994828 YMAX =   25.994828 YAVE =   25.994828
    ZMIN =   16.114717 ZMAX =   16.114717 ZAVE =   16.114717
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "38.2807693"
Evaluating: 38.2807693+3.5
 Parameter: XMAX <- "41.7807693"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "25.9948284"
Evaluating: 25.9948284+3.5
 Parameter: YMAX <- "29.4948284"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "16.1147166"
Evaluating: 16.1147166+3.5
 Parameter: ZMAX <- "19.6147166"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "38.2807693"
Evaluating: 38.2807693-3.5
 Parameter: XMIN <- "34.7807693"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "25.9948284"
Evaluating: 25.9948284-3.5
 Parameter: YMIN <- "22.4948284"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "16.1147166"
Evaluating: 16.1147166-3.5
 Parameter: ZMIN <- "12.6147166"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "41.7807693"
 Parameter: XMIN -> "34.7807693"
 Parameter: YMAX -> "29.4948284"
 Parameter: YMIN -> "22.4948284"
 Parameter: ZMAX -> "19.6147166"
 Parameter: ZMIN -> "12.6147166"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      1 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "44"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "44" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "44"
Evaluating: 44
 Parameter: J <- "44"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "44" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "44"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.703824783"
Evaluating: 120.112447*(0.703824783-0.5)
 Parameter: XPOS <- "24.4818934"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.309584473"
Evaluating: 120.112447*(0.309584473-0.5)
 Parameter: YPOS <- "-22.8712749"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.278639226"
Evaluating: 85*(0.278639226-0.5)+0
 Parameter: ZPOS <- "-18.8156658"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-18.8156658" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "24.4818934"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 24.4818934-0
 Parameter: XTRAN <- "24.4818934"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-22.8712749"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -22.8712749-0
 Parameter: YTRAN <- "-22.8712749"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-18.8156658"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -18.8156658-0
 Parameter: ZTRAN <- "-18.8156658"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "24.4818934"
 Parameter: YTRAN -> "-22.8712749"
 Parameter: ZTRAN -> "-18.8156658"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    24.481893  -22.871275  -18.815666
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.135912733"
Evaluating: 0.135912733*360.0
 Parameter: XPHI <- "48.9285839"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.460310069"
Evaluating: 0.460310069*360.0
 Parameter: YPHI <- "165.711625"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.776185775"
Evaluating: 0.776185775*360.0
 Parameter: ZPHI <- "279.426879"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "24.4818934"
 Parameter: YPOS -> "-22.8712749"
 Parameter: ZPOS -> "-18.8156658"
 Parameter: XPHI -> "48.9285839"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.656999    0.753891
    0.000000   -0.753891    0.656999

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   48.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "24.4818934"
 Parameter: YPOS -> "-22.8712749"
 Parameter: ZPOS -> "-18.8156658"
 Parameter: YPHI -> "165.711625"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.969066    0.000000   -0.246802
    0.000000    1.000000    0.000000
    0.246802    0.000000   -0.969066

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  165.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "24.4818934"
 Parameter: YPOS -> "-22.8712749"
 Parameter: ZPOS -> "-18.8156658"
 Parameter: ZPHI -> "279.426879"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.163789   -0.986495    0.000000
    0.986495    0.163789    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   80.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   24.481893 XMAX =   24.481893 XAVE =   24.481893
    YMIN =  -22.871275 YMAX =  -22.871275 YAVE =  -22.871275
    ZMIN =  -18.815666 ZMAX =  -18.815666 ZAVE =  -18.815666
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "24.4818934"
Evaluating: 24.4818934+3.5
 Parameter: XMAX <- "27.9818934"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-22.8712749"
Evaluating: -22.8712749+3.5
 Parameter: YMAX <- "-19.3712749"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-18.8156658"
Evaluating: -18.8156658+3.5
 Parameter: ZMAX <- "-15.3156658"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "24.4818934"
Evaluating: 24.4818934-3.5
 Parameter: XMIN <- "20.9818934"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-22.8712749"
Evaluating: -22.8712749-3.5
 Parameter: YMIN <- "-26.3712749"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-18.8156658"
Evaluating: -18.8156658-3.5
 Parameter: ZMIN <- "-22.3156658"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "27.9818934"
 Parameter: XMIN -> "20.9818934"
 Parameter: YMAX -> "-19.3712749"
 Parameter: YMIN -> "-26.3712749"
 Parameter: ZMAX -> "-15.3156658"
 Parameter: ZMIN -> "-22.3156658"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      1 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
 5540 POS      NA       44       NA      -3410 MEMB     DPPC     285      PO4           2.8487
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "44"
Evaluating: 44
 Parameter: J <- "44"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "44" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "44"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.657496723"
Evaluating: 120.112447*(0.657496723-0.5)
 Parameter: XPOS <- "18.9173168"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.640701657"
Evaluating: 120.112447*(0.640701657-0.5)
 Parameter: YPOS <- "16.9000203"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.217845592"
Evaluating: 85*(0.217845592-0.5)+0
 Parameter: ZPOS <- "-23.9831247"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-23.9831247" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   24.481893 XMAX =   24.481893 XAVE =   24.481893
    YMIN =  -22.871275 YMAX =  -22.871275 YAVE =  -22.871275
    ZMIN =  -18.815666 ZMAX =  -18.815666 ZAVE =  -18.815666
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "18.9173168"
 RDCMND substituted energy or value "?XAVE" to "24.4818934"
Evaluating: 18.9173168-24.4818934
 Parameter: XTRAN <- "-5.5645766"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "16.9000203"
 RDCMND substituted energy or value "?YAVE" to "-22.8712749"
Evaluating: 16.9000203--22.8712749
 Parameter: YTRAN <- "39.7712952"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-23.9831247"
 RDCMND substituted energy or value "?ZAVE" to "-18.8156658"
Evaluating: -23.9831247--18.8156658
 Parameter: ZTRAN <- "-5.1674589"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-5.5645766"
 Parameter: YTRAN -> "39.7712952"
 Parameter: ZTRAN -> "-5.1674589"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    -5.564577   39.771295   -5.167459
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.754876228"
Evaluating: 0.754876228*360.0
 Parameter: XPHI <- "271.755442"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.280713322"
Evaluating: 0.280713322*360.0
 Parameter: YPHI <- "101.056796"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.335869001"
Evaluating: 0.335869001*360.0
 Parameter: ZPHI <- "120.91284"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "18.9173168"
 Parameter: YPOS -> "16.9000203"
 Parameter: ZPOS -> "-23.9831247"
 Parameter: XPHI -> "271.755442"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.030633   -0.999531
    0.000000    0.999531    0.030633

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   88.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "18.9173168"
 Parameter: YPOS -> "16.9000203"
 Parameter: ZPOS -> "-23.9831247"
 Parameter: YPHI -> "101.056796"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.191782    0.000000   -0.981438
    0.000000    1.000000    0.000000
    0.981438    0.000000   -0.191782

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  101.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "18.9173168"
 Parameter: YPOS -> "16.9000203"
 Parameter: ZPOS -> "-23.9831247"
 Parameter: ZPHI -> "120.91284"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.513734    0.857950    0.000000
   -0.857950   -0.513734    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  120.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   18.917317 XMAX =   18.917317 XAVE =   18.917317
    YMIN =   16.900020 YMAX =   16.900020 YAVE =   16.900020
    ZMIN =  -23.983125 ZMAX =  -23.983125 ZAVE =  -23.983125
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "18.9173168"
Evaluating: 18.9173168+3.5
 Parameter: XMAX <- "22.4173168"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "16.9000203"
Evaluating: 16.9000203+3.5
 Parameter: YMAX <- "20.4000203"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-23.9831247"
Evaluating: -23.9831247+3.5
 Parameter: ZMAX <- "-20.4831247"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "18.9173168"
Evaluating: 18.9173168-3.5
 Parameter: XMIN <- "15.4173168"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "16.9000203"
Evaluating: 16.9000203-3.5
 Parameter: YMIN <- "13.4000203"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-23.9831247"
Evaluating: -23.9831247-3.5
 Parameter: ZMIN <- "-27.4831247"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "22.4173168"
 Parameter: XMIN -> "15.4173168"
 Parameter: YMAX -> "20.4000203"
 Parameter: YMIN -> "13.4000203"
 Parameter: ZMAX -> "-20.4831247"
 Parameter: ZMIN -> "-27.4831247"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "45"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "45" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "45"
Evaluating: 45
 Parameter: J <- "45"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "45" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "45"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "4.316226179E-03"
Evaluating: 120.112447*(4.316226179E-03-0.5)
 Parameter: XPOS <- "-59.537791"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.5685497"
Evaluating: 120.112447*(0.5685497-0.5)
 Parameter: YPOS <- "8.23367221"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.950713105"
Evaluating: 85*(0.950713105-0.5)+0
 Parameter: ZPOS <- "38.3106139"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "38.3106139" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "38.3106139" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-59.537791"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -59.537791-0
 Parameter: XTRAN <- "-59.537791"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "8.23367221"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 8.23367221-0
 Parameter: YTRAN <- "8.23367221"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "38.3106139"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 38.3106139-0
 Parameter: ZTRAN <- "38.3106139"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-59.537791"
 Parameter: YTRAN -> "8.23367221"
 Parameter: ZTRAN -> "38.3106139"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR   -59.537791    8.233672   38.310614
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.539694832"
Evaluating: 0.539694832*360.0
 Parameter: XPHI <- "194.29014"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.364998621"
Evaluating: 0.364998621*360.0
 Parameter: YPHI <- "131.399504"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.342642069"
Evaluating: 0.342642069*360.0
 Parameter: ZPHI <- "123.351145"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-59.537791"
 Parameter: YPOS -> "8.23367221"
 Parameter: ZPOS -> "38.3106139"
 Parameter: XPHI -> "194.29014"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.969058   -0.246832
    0.000000    0.246832   -0.969058

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  165.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-59.537791"
 Parameter: YPOS -> "8.23367221"
 Parameter: ZPOS -> "38.3106139"
 Parameter: YPHI -> "131.399504"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.661305    0.000000   -0.750117
    0.000000    1.000000    0.000000
    0.750117    0.000000   -0.661305

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  131.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-59.537791"
 Parameter: YPOS -> "8.23367221"
 Parameter: ZPOS -> "38.3106139"
 Parameter: ZPHI -> "123.351145"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.549769    0.835317    0.000000
   -0.835317   -0.549769    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  123.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -59.537791 XMAX =  -59.537791 XAVE =  -59.537791
    YMIN =    8.233672 YMAX =    8.233672 YAVE =    8.233672
    ZMIN =   38.310614 ZMAX =   38.310614 ZAVE =   38.310614
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-59.537791"
Evaluating: -59.537791+3.5
 Parameter: XMAX <- "-56.037791"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "8.23367221"
Evaluating: 8.23367221+3.5
 Parameter: YMAX <- "11.7336722"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "38.3106139"
Evaluating: 38.3106139+3.5
 Parameter: ZMAX <- "41.8106139"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-59.537791"
Evaluating: -59.537791-3.5
 Parameter: XMIN <- "-63.037791"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "8.23367221"
Evaluating: 8.23367221-3.5
 Parameter: YMIN <- "4.73367221"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "38.3106139"
Evaluating: 38.3106139-3.5
 Parameter: ZMIN <- "34.8106139"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-56.037791"
 Parameter: XMIN -> "-63.037791"
 Parameter: YMAX -> "11.7336722"
 Parameter: YMIN -> "4.73367221"
 Parameter: ZMAX -> "41.8106139"
 Parameter: ZMIN -> "34.8106139"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "46"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "46" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "46"
Evaluating: 46
 Parameter: J <- "46"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "46" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "46"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.528959173"
Evaluating: 120.112447*(0.528959173-0.5)
 Parameter: XPOS <- "3.47835713"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.727192101"
Evaluating: 120.112447*(0.727192101-0.5)
 Parameter: YPOS <- "27.2885992"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.634852437"
Evaluating: 85*(0.634852437-0.5)+0
 Parameter: ZPOS <- "11.4624571"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "11.4624571" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "11.4624571" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "46"
Evaluating: 46
 Parameter: J <- "46"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "46" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "46"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.158607579"
Evaluating: 120.112447*(0.158607579-0.5)
 Parameter: XPOS <- "-41.0054791"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "5.832038147E-02"
Evaluating: 120.112447*(5.832038147E-02-0.5)
 Parameter: YPOS <- "-53.0512198"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.141314428"
Evaluating: 85*(0.141314428-0.5)+0
 Parameter: ZPOS <- "-30.4882736"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-30.4882736" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-41.0054791"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -41.0054791-0
 Parameter: XTRAN <- "-41.0054791"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-53.0512198"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -53.0512198-0
 Parameter: YTRAN <- "-53.0512198"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-30.4882736"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -30.4882736-0
 Parameter: ZTRAN <- "-30.4882736"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-41.0054791"
 Parameter: YTRAN -> "-53.0512198"
 Parameter: ZTRAN -> "-30.4882736"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR   -41.005479  -53.051220  -30.488274
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.372040942E-02"
Evaluating: 7.372040942E-02*360.0
 Parameter: XPHI <- "26.5393474"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.822799338"
Evaluating: 0.822799338*360.0
 Parameter: YPHI <- "296.207762"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.95164666"
Evaluating: 0.95164666*360.0
 Parameter: ZPHI <- "342.592798"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-41.0054791"
 Parameter: YPOS -> "-53.0512198"
 Parameter: ZPOS -> "-30.4882736"
 Parameter: XPHI -> "26.5393474"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.894628    0.446812
    0.000000   -0.446812    0.894628

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   26.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-41.0054791"
 Parameter: YPOS -> "-53.0512198"
 Parameter: ZPOS -> "-30.4882736"
 Parameter: YPHI -> "296.207762"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.441627    0.000000    0.897199
    0.000000    1.000000    0.000000
   -0.897199    0.000000    0.441627

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   63.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-41.0054791"
 Parameter: YPOS -> "-53.0512198"
 Parameter: ZPOS -> "-30.4882736"
 Parameter: ZPHI -> "342.592798"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.954203   -0.299161    0.000000
    0.299161    0.954203    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   17.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -41.005479 XMAX =  -41.005479 XAVE =  -41.005479
    YMIN =  -53.051220 YMAX =  -53.051220 YAVE =  -53.051220
    ZMIN =  -30.488274 ZMAX =  -30.488274 ZAVE =  -30.488274
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-41.0054791"
Evaluating: -41.0054791+3.5
 Parameter: XMAX <- "-37.5054791"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-53.0512198"
Evaluating: -53.0512198+3.5
 Parameter: YMAX <- "-49.5512198"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-30.4882736"
Evaluating: -30.4882736+3.5
 Parameter: ZMAX <- "-26.9882736"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-41.0054791"
Evaluating: -41.0054791-3.5
 Parameter: XMIN <- "-44.5054791"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-53.0512198"
Evaluating: -53.0512198-3.5
 Parameter: YMIN <- "-56.5512198"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-30.4882736"
Evaluating: -30.4882736-3.5
 Parameter: ZMIN <- "-33.9882736"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-37.5054791"
 Parameter: XMIN -> "-44.5054791"
 Parameter: YMAX -> "-49.5512198"
 Parameter: YMIN -> "-56.5512198"
 Parameter: ZMAX -> "-26.9882736"
 Parameter: ZMIN -> "-33.9882736"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "47"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "47" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "47"
Evaluating: 47
 Parameter: J <- "47"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "47" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "47"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.818736507"
Evaluating: 120.112447*(0.818736507-0.5)
 Parameter: XPOS <- "38.2842218"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.401090919"
Evaluating: 120.112447*(0.401090919-0.5)
 Parameter: YPOS <- "-11.8802117"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.569469874"
Evaluating: 85*(0.569469874-0.5)+0
 Parameter: ZPOS <- "5.90493929"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "5.90493929" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "5.90493929" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "47"
Evaluating: 47
 Parameter: J <- "47"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "47" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "47"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.117330804"
Evaluating: 120.112447*(0.117330804-0.5)
 Parameter: XPOS <- "-45.9633335"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.261650254"
Evaluating: 120.112447*(0.261650254-0.5)
 Parameter: YPOS <- "-28.6287712"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.960242344"
Evaluating: 85*(0.960242344-0.5)+0
 Parameter: ZPOS <- "39.1205992"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "39.1205992" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "39.1205992" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-45.9633335"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -45.9633335-0
 Parameter: XTRAN <- "-45.9633335"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-28.6287712"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -28.6287712-0
 Parameter: YTRAN <- "-28.6287712"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "39.1205992"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 39.1205992-0
 Parameter: ZTRAN <- "39.1205992"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-45.9633335"
 Parameter: YTRAN -> "-28.6287712"
 Parameter: ZTRAN -> "39.1205992"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR   -45.963333  -28.628771   39.120599
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.307143944"
Evaluating: 0.307143944*360.0
 Parameter: XPHI <- "110.57182"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.051229235E-02"
Evaluating: 2.051229235E-02*360.0
 Parameter: YPHI <- "7.38442525"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.885760091E-02"
Evaluating: 7.885760091E-02*360.0
 Parameter: ZPHI <- "28.3887363"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-45.9633335"
 Parameter: YPOS -> "-28.6287712"
 Parameter: ZPOS -> "39.1205992"
 Parameter: XPHI -> "110.57182"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.351381    0.936232
    0.000000   -0.936232   -0.351381

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  110.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-45.9633335"
 Parameter: YPOS -> "-28.6287712"
 Parameter: ZPOS -> "39.1205992"
 Parameter: YPHI -> "7.38442525"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.991706    0.000000   -0.128526
    0.000000    1.000000    0.000000
    0.128526    0.000000    0.991706

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    7.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-45.9633335"
 Parameter: YPOS -> "-28.6287712"
 Parameter: ZPOS -> "39.1205992"
 Parameter: ZPHI -> "28.3887363"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.879742    0.475451    0.000000
   -0.475451    0.879742    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   28.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -45.963333 XMAX =  -45.963333 XAVE =  -45.963333
    YMIN =  -28.628771 YMAX =  -28.628771 YAVE =  -28.628771
    ZMIN =   39.120599 ZMAX =   39.120599 ZAVE =   39.120599
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-45.9633335"
Evaluating: -45.9633335+3.5
 Parameter: XMAX <- "-42.4633335"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-28.6287712"
Evaluating: -28.6287712+3.5
 Parameter: YMAX <- "-25.1287712"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "39.1205992"
Evaluating: 39.1205992+3.5
 Parameter: ZMAX <- "42.6205992"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-45.9633335"
Evaluating: -45.9633335-3.5
 Parameter: XMIN <- "-49.4633335"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-28.6287712"
Evaluating: -28.6287712-3.5
 Parameter: YMIN <- "-32.1287712"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "39.1205992"
Evaluating: 39.1205992-3.5
 Parameter: ZMIN <- "35.6205992"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-42.4633335"
 Parameter: XMIN -> "-49.4633335"
 Parameter: YMAX -> "-25.1287712"
 Parameter: YMIN -> "-32.1287712"
 Parameter: ZMAX -> "42.6205992"
 Parameter: ZMIN -> "35.6205992"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "48"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "48" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "48"
Evaluating: 48
 Parameter: J <- "48"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "48" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "48"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.306109127"
Evaluating: 120.112447*(0.306109127-0.5)
 Parameter: XPOS <- "-23.2887072"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.277930637"
Evaluating: 120.112447*(0.277930637-0.5)
 Parameter: YPOS <- "-26.6732946"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.703458605"
Evaluating: 85*(0.703458605-0.5)+0
 Parameter: ZPOS <- "17.2939814"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "17.2939814" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "17.2939814" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-23.2887072"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -23.2887072-0
 Parameter: XTRAN <- "-23.2887072"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-26.6732946"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -26.6732946-0
 Parameter: YTRAN <- "-26.6732946"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "17.2939814"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 17.2939814-0
 Parameter: ZTRAN <- "17.2939814"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-23.2887072"
 Parameter: YTRAN -> "-26.6732946"
 Parameter: ZTRAN -> "17.2939814"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR   -23.288707  -26.673295   17.293981
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.890804754"
Evaluating: 0.890804754*360.0
 Parameter: XPHI <- "320.689711"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.586480145E-02"
Evaluating: 7.586480145E-02*360.0
 Parameter: YPHI <- "27.3113285"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.421799646"
Evaluating: 0.421799646*360.0
 Parameter: ZPHI <- "151.847873"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-23.2887072"
 Parameter: YPOS -> "-26.6732946"
 Parameter: ZPOS -> "17.2939814"
 Parameter: XPHI -> "320.689711"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.773726   -0.633520
    0.000000    0.633520    0.773726

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   39.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-23.2887072"
 Parameter: YPOS -> "-26.6732946"
 Parameter: ZPOS -> "17.2939814"
 Parameter: YPHI -> "27.3113285"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.888527    0.000000   -0.458825
    0.000000    1.000000    0.000000
    0.458825    0.000000    0.888527

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   27.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-23.2887072"
 Parameter: YPOS -> "-26.6732946"
 Parameter: ZPOS -> "17.2939814"
 Parameter: ZPHI -> "151.847873"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.881698    0.471814    0.000000
   -0.471814   -0.881698    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  151.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -23.288707 XMAX =  -23.288707 XAVE =  -23.288707
    YMIN =  -26.673295 YMAX =  -26.673295 YAVE =  -26.673295
    ZMIN =   17.293981 ZMAX =   17.293981 ZAVE =   17.293981
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-23.2887072"
Evaluating: -23.2887072+3.5
 Parameter: XMAX <- "-19.7887072"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-26.6732946"
Evaluating: -26.6732946+3.5
 Parameter: YMAX <- "-23.1732946"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "17.2939814"
Evaluating: 17.2939814+3.5
 Parameter: ZMAX <- "20.7939814"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-23.2887072"
Evaluating: -23.2887072-3.5
 Parameter: XMIN <- "-26.7887072"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-26.6732946"
Evaluating: -26.6732946-3.5
 Parameter: YMIN <- "-30.1732946"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "17.2939814"
Evaluating: 17.2939814-3.5
 Parameter: ZMIN <- "13.7939814"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-19.7887072"
 Parameter: XMIN -> "-26.7887072"
 Parameter: YMAX -> "-23.1732946"
 Parameter: YMIN -> "-30.1732946"
 Parameter: ZMAX -> "20.7939814"
 Parameter: ZMIN -> "13.7939814"
 SELRPN>      4 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      4 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
 5544 POS      NA       48       NA      - 673 MEMB     DPPC     57       NC3           3.6879
 5544 POS      NA       48       NA      - 674 MEMB     DPPC     57       PO4           2.3192
 5544 POS      NA       48       NA      - 675 MEMB     DPPC     57       GL1           3.3533
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         3
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "3"
 Comparing "3" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "48"
Evaluating: 48
 Parameter: J <- "48"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "48" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "48"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.527991804"
Evaluating: 120.112447*(0.527991804-0.5)
 Parameter: XPOS <- "3.36216407"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "1.908154028E-02"
Evaluating: 120.112447*(1.908154028E-02-0.5)
 Parameter: YPOS <- "-57.764293"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.147099716"
Evaluating: 85*(0.147099716-0.5)+0
 Parameter: ZPOS <- "-29.9965241"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-29.9965241" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -23.288707 XMAX =  -23.288707 XAVE =  -23.288707
    YMIN =  -26.673295 YMAX =  -26.673295 YAVE =  -26.673295
    ZMIN =   17.293981 ZMAX =   17.293981 ZAVE =   17.293981
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "3.36216407"
 RDCMND substituted energy or value "?XAVE" to "-23.2887072"
Evaluating: 3.36216407--23.2887072
 Parameter: XTRAN <- "26.6508713"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-57.764293"
 RDCMND substituted energy or value "?YAVE" to "-26.6732946"
Evaluating: -57.764293--26.6732946
 Parameter: YTRAN <- "-31.0909984"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-29.9965241"
 RDCMND substituted energy or value "?ZAVE" to "17.2939814"
Evaluating: -29.9965241-17.2939814
 Parameter: ZTRAN <- "-47.2905055"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "26.6508713"
 Parameter: YTRAN -> "-31.0909984"
 Parameter: ZTRAN -> "-47.2905055"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    26.650871  -31.090998  -47.290506
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.584838643"
Evaluating: 0.584838643*360.0
 Parameter: XPHI <- "210.541911"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.375505973"
Evaluating: 0.375505973*360.0
 Parameter: YPHI <- "135.18215"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.898359599"
Evaluating: 0.898359599*360.0
 Parameter: ZPHI <- "323.409456"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "3.36216407"
 Parameter: YPOS -> "-57.764293"
 Parameter: ZPOS -> "-29.9965241"
 Parameter: XPHI -> "210.541911"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.861258   -0.508168
    0.000000    0.508168   -0.861258

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  149.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "3.36216407"
 Parameter: YPOS -> "-57.764293"
 Parameter: ZPOS -> "-29.9965241"
 Parameter: YPHI -> "135.18215"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.709351    0.000000   -0.704855
    0.000000    1.000000    0.000000
    0.704855    0.000000   -0.709351

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  135.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "3.36216407"
 Parameter: YPOS -> "-57.764293"
 Parameter: ZPOS -> "-29.9965241"
 Parameter: ZPHI -> "323.409456"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.802916   -0.596092    0.000000
    0.596092    0.802916    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   36.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    3.362164 XMAX =    3.362164 XAVE =    3.362164
    YMIN =  -57.764293 YMAX =  -57.764293 YAVE =  -57.764293
    ZMIN =  -29.996524 ZMAX =  -29.996524 ZAVE =  -29.996524
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "3.36216405"
Evaluating: 3.36216405+3.5
 Parameter: XMAX <- "6.86216405"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-57.764293"
Evaluating: -57.764293+3.5
 Parameter: YMAX <- "-54.264293"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-29.9965241"
Evaluating: -29.9965241+3.5
 Parameter: ZMAX <- "-26.4965241"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "3.36216405"
Evaluating: 3.36216405-3.5
 Parameter: XMIN <- "-0.13783595"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-57.764293"
Evaluating: -57.764293-3.5
 Parameter: YMIN <- "-61.264293"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-29.9965241"
Evaluating: -29.9965241-3.5
 Parameter: ZMIN <- "-33.4965241"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "6.86216405"
 Parameter: XMIN -> "-0.13783595"
 Parameter: YMAX -> "-54.264293"
 Parameter: YMIN -> "-61.264293"
 Parameter: ZMAX -> "-26.4965241"
 Parameter: ZMIN -> "-33.4965241"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "49"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "49" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "49"
Evaluating: 49
 Parameter: J <- "49"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "49" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "49"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.180712012"
Evaluating: 120.112447*(0.180712012-0.5)
 Parameter: XPOS <- "-38.3504615"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.79089033"
Evaluating: 120.112447*(0.79089033-0.5)
 Parameter: YPOS <- "34.9395493"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.920736139"
Evaluating: 85*(0.920736139-0.5)+0
 Parameter: ZPOS <- "35.7625718"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "35.7625718" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "35.7625718" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-38.3504615"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -38.3504615-0
 Parameter: XTRAN <- "-38.3504615"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "34.9395493"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 34.9395493-0
 Parameter: YTRAN <- "34.9395493"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "35.7625718"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 35.7625718-0
 Parameter: ZTRAN <- "35.7625718"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-38.3504615"
 Parameter: YTRAN -> "34.9395493"
 Parameter: ZTRAN -> "35.7625718"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR   -38.350462   34.939549   35.762572
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.592142078"
Evaluating: 0.592142078*360.0
 Parameter: XPHI <- "213.171148"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.172147057"
Evaluating: 0.172147057*360.0
 Parameter: YPHI <- "61.9729405"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.775647773"
Evaluating: 0.775647773*360.0
 Parameter: ZPHI <- "279.233198"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-38.3504615"
 Parameter: YPOS -> "34.9395493"
 Parameter: ZPOS -> "35.7625718"
 Parameter: XPHI -> "213.171148"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.837040   -0.547142
    0.000000    0.547142   -0.837040

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  146.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-38.3504615"
 Parameter: YPOS -> "34.9395493"
 Parameter: ZPOS -> "35.7625718"
 Parameter: YPHI -> "61.9729405"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.469889    0.000000   -0.882726
    0.000000    1.000000    0.000000
    0.882726    0.000000    0.469889

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   61.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-38.3504615"
 Parameter: YPOS -> "34.9395493"
 Parameter: ZPOS -> "35.7625718"
 Parameter: ZPHI -> "279.233198"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.160453   -0.987043    0.000000
    0.987043    0.160453    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   80.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -38.350462 XMAX =  -38.350462 XAVE =  -38.350462
    YMIN =   34.939549 YMAX =   34.939549 YAVE =   34.939549
    ZMIN =   35.762572 ZMAX =   35.762572 ZAVE =   35.762572
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-38.3504615"
Evaluating: -38.3504615+3.5
 Parameter: XMAX <- "-34.8504615"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "34.9395493"
Evaluating: 34.9395493+3.5
 Parameter: YMAX <- "38.4395493"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "35.7625718"
Evaluating: 35.7625718+3.5
 Parameter: ZMAX <- "39.2625718"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-38.3504615"
Evaluating: -38.3504615-3.5
 Parameter: XMIN <- "-41.8504615"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "34.9395493"
Evaluating: 34.9395493-3.5
 Parameter: YMIN <- "31.4395493"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "35.7625718"
Evaluating: 35.7625718-3.5
 Parameter: ZMIN <- "32.2625718"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-34.8504615"
 Parameter: XMIN -> "-41.8504615"
 Parameter: YMAX -> "38.4395493"
 Parameter: YMIN -> "31.4395493"
 Parameter: ZMAX -> "39.2625718"
 Parameter: ZMIN -> "32.2625718"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "50"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "50" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "50"
Evaluating: 50
 Parameter: J <- "50"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "50" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "50"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.913773422"
Evaluating: 120.112447*(0.913773422-0.5)
 Parameter: XPOS <- "49.6993382"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.153802125"
Evaluating: 120.112447*(0.153802125-0.5)
 Parameter: YPOS <- "-41.5826739"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.341505977"
Evaluating: 85*(0.341505977-0.5)+0
 Parameter: ZPOS <- "-13.471992"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-13.471992" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-13.471992" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "50"
Evaluating: 50
 Parameter: J <- "50"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "50" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "50"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.663057532"
Evaluating: 120.112447*(0.663057532-0.5)
 Parameter: XPOS <- "19.5852392"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.66826339"
Evaluating: 120.112447*(0.66826339-0.5)
 Parameter: YPOS <- "20.2105275"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.427083502"
Evaluating: 85*(0.427083502-0.5)+0
 Parameter: ZPOS <- "-6.19790233"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-6.19790233" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-6.19790233" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "50"
Evaluating: 50
 Parameter: J <- "50"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "50" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "50"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.844118032"
Evaluating: 120.112447*(0.844118032-0.5)
 Parameter: XPOS <- "41.3328589"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.982407043"
Evaluating: 120.112447*(0.982407043-0.5)
 Parameter: YPOS <- "57.9430904"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "4.703562616E-02"
Evaluating: 85*(4.703562616E-02-0.5)+0
 Parameter: ZPOS <- "-38.5019718"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-38.5019718" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "41.3328589"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 41.3328589-0
 Parameter: XTRAN <- "41.3328589"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "57.9430904"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 57.9430904-0
 Parameter: YTRAN <- "57.9430904"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-38.5019718"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -38.5019718-0
 Parameter: ZTRAN <- "-38.5019718"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "41.3328589"
 Parameter: YTRAN -> "57.9430904"
 Parameter: ZTRAN -> "-38.5019718"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    41.332859   57.943090  -38.501972
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.659719841"
Evaluating: 0.659719841*360.0
 Parameter: XPHI <- "237.499143"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.201121262"
Evaluating: 0.201121262*360.0
 Parameter: YPHI <- "72.4036543"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.829392145"
Evaluating: 0.829392145*360.0
 Parameter: ZPHI <- "298.581172"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "41.3328589"
 Parameter: YPOS -> "57.9430904"
 Parameter: ZPOS -> "-38.5019718"
 Parameter: XPHI -> "237.499143"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.537312   -0.843383
    0.000000    0.843383   -0.537312

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  122.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "41.3328589"
 Parameter: YPOS -> "57.9430904"
 Parameter: ZPOS -> "-38.5019718"
 Parameter: YPHI -> "72.4036543"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.302309    0.000000   -0.953210
    0.000000    1.000000    0.000000
    0.953210    0.000000    0.302309

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   72.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "41.3328589"
 Parameter: YPOS -> "57.9430904"
 Parameter: ZPOS -> "-38.5019718"
 Parameter: ZPHI -> "298.581172"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.478403   -0.878140    0.000000
    0.878140    0.478403    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   61.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   41.332859 XMAX =   41.332859 XAVE =   41.332859
    YMIN =   57.943090 YMAX =   57.943090 YAVE =   57.943090
    ZMIN =  -38.501972 ZMAX =  -38.501972 ZAVE =  -38.501972
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "41.3328589"
Evaluating: 41.3328589+3.5
 Parameter: XMAX <- "44.8328589"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "57.9430904"
Evaluating: 57.9430904+3.5
 Parameter: YMAX <- "61.4430904"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-38.5019718"
Evaluating: -38.5019718+3.5
 Parameter: ZMAX <- "-35.0019718"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "41.3328589"
Evaluating: 41.3328589-3.5
 Parameter: XMIN <- "37.8328589"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "57.9430904"
Evaluating: 57.9430904-3.5
 Parameter: YMIN <- "54.4430904"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-38.5019718"
Evaluating: -38.5019718-3.5
 Parameter: ZMIN <- "-42.0019718"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "44.8328589"
 Parameter: XMIN -> "37.8328589"
 Parameter: YMAX -> "61.4430904"
 Parameter: YMIN -> "54.4430904"
 Parameter: ZMAX -> "-35.0019718"
 Parameter: ZMIN -> "-42.0019718"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "51"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "51" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "51"
Evaluating: 51
 Parameter: J <- "51"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "51" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "51"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.243658468"
Evaluating: 120.112447*(0.243658468-0.5)
 Parameter: XPOS <- "-30.7898087"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.581928008"
Evaluating: 120.112447*(0.581928008-0.5)
 Parameter: YPOS <- "9.84057352"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.234454651"
Evaluating: 85*(0.234454651-0.5)+0
 Parameter: ZPOS <- "-22.5713547"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-22.5713547" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-30.7898087"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -30.7898087-0
 Parameter: XTRAN <- "-30.7898087"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "9.84057352"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 9.84057352-0
 Parameter: YTRAN <- "9.84057352"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-22.5713547"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -22.5713547-0
 Parameter: ZTRAN <- "-22.5713547"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-30.7898087"
 Parameter: YTRAN -> "9.84057352"
 Parameter: ZTRAN -> "-22.5713547"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR   -30.789809    9.840574  -22.571355
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.129503307"
Evaluating: 0.129503307*360.0
 Parameter: XPHI <- "46.6211905"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.321284284"
Evaluating: 0.321284284*360.0
 Parameter: YPHI <- "115.662342"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.211751429"
Evaluating: 0.211751429*360.0
 Parameter: ZPHI <- "76.2305144"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-30.7898087"
 Parameter: YPOS -> "9.84057352"
 Parameter: ZPOS -> "-22.5713547"
 Parameter: XPHI -> "46.6211905"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.686819    0.726829
    0.000000   -0.726829    0.686819

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   46.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-30.7898087"
 Parameter: YPOS -> "9.84057352"
 Parameter: ZPOS -> "-22.5713547"
 Parameter: YPHI -> "115.662342"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.433067    0.000000   -0.901362
    0.000000    1.000000    0.000000
    0.901362    0.000000   -0.433067

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  115.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-30.7898087"
 Parameter: YPOS -> "9.84057352"
 Parameter: ZPOS -> "-22.5713547"
 Parameter: ZPHI -> "76.2305144"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.238016    0.971261    0.000000
   -0.971261    0.238016    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   76.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -30.789809 XMAX =  -30.789809 XAVE =  -30.789809
    YMIN =    9.840574 YMAX =    9.840574 YAVE =    9.840574
    ZMIN =  -22.571355 ZMAX =  -22.571355 ZAVE =  -22.571355
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-30.7898087"
Evaluating: -30.7898087+3.5
 Parameter: XMAX <- "-27.2898087"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "9.84057352"
Evaluating: 9.84057352+3.5
 Parameter: YMAX <- "13.3405735"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-22.5713547"
Evaluating: -22.5713547+3.5
 Parameter: ZMAX <- "-19.0713547"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-30.7898087"
Evaluating: -30.7898087-3.5
 Parameter: XMIN <- "-34.2898087"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "9.84057352"
Evaluating: 9.84057352-3.5
 Parameter: YMIN <- "6.34057352"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-22.5713547"
Evaluating: -22.5713547-3.5
 Parameter: ZMIN <- "-26.0713547"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-27.2898087"
 Parameter: XMIN -> "-34.2898087"
 Parameter: YMAX -> "13.3405735"
 Parameter: YMIN -> "6.34057352"
 Parameter: ZMAX -> "-19.0713547"
 Parameter: ZMIN -> "-26.0713547"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "52"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "52" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "52"
Evaluating: 52
 Parameter: J <- "52"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "52" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "52"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "3.092641298E-02"
Evaluating: 120.112447*(3.092641298E-02-0.5)
 Parameter: XPOS <- "-56.3415764"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.550992359"
Evaluating: 120.112447*(0.550992359-0.5)
 Parameter: YPOS <- "6.12481702"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.5225146"
Evaluating: 85*(0.5225146-0.5)+0
 Parameter: ZPOS <- "1.913741"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "1.913741" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "1.913741" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "52"
Evaluating: 52
 Parameter: J <- "52"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "52" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "52"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.232282158"
Evaluating: 120.112447*(0.232282158-0.5)
 Parameter: XPOS <- "-32.1562451"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.796849084"
Evaluating: 120.112447*(0.796849084-0.5)
 Parameter: YPOS <- "35.6552699"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.120747396"
Evaluating: 85*(0.120747396-0.5)+0
 Parameter: ZPOS <- "-32.2364713"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-32.2364713" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-32.1562451"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -32.1562451-0
 Parameter: XTRAN <- "-32.1562451"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "35.6552699"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 35.6552699-0
 Parameter: YTRAN <- "35.6552699"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-32.2364713"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -32.2364713-0
 Parameter: ZTRAN <- "-32.2364713"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-32.1562451"
 Parameter: YTRAN -> "35.6552699"
 Parameter: ZTRAN -> "-32.2364713"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR   -32.156245   35.655270  -32.236471
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.270093664"
Evaluating: 0.270093664*360.0
 Parameter: XPHI <- "97.233719"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.908786042"
Evaluating: 0.908786042*360.0
 Parameter: YPHI <- "327.162975"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.189719961E-02"
Evaluating: 3.189719961E-02*360.0
 Parameter: ZPHI <- "11.4829919"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-32.1562451"
 Parameter: YPOS -> "35.6552699"
 Parameter: ZPOS -> "-32.2364713"
 Parameter: XPHI -> "97.233719"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.125917    0.992041
    0.000000   -0.992041   -0.125917

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   97.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-32.1562451"
 Parameter: YPOS -> "35.6552699"
 Parameter: ZPOS -> "-32.2364713"
 Parameter: YPHI -> "327.162975"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.840216    0.000000    0.542251
    0.000000    1.000000    0.000000
   -0.542251    0.000000    0.840216

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   32.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-32.1562451"
 Parameter: YPOS -> "35.6552699"
 Parameter: ZPOS -> "-32.2364713"
 Parameter: ZPHI -> "11.4829919"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.979984    0.199077    0.000000
   -0.199077    0.979984    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   11.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -32.156245 XMAX =  -32.156245 XAVE =  -32.156245
    YMIN =   35.655270 YMAX =   35.655270 YAVE =   35.655270
    ZMIN =  -32.236471 ZMAX =  -32.236471 ZAVE =  -32.236471
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-32.1562451"
Evaluating: -32.1562451+3.5
 Parameter: XMAX <- "-28.6562451"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "35.6552699"
Evaluating: 35.6552699+3.5
 Parameter: YMAX <- "39.1552699"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-32.2364713"
Evaluating: -32.2364713+3.5
 Parameter: ZMAX <- "-28.7364713"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-32.1562451"
Evaluating: -32.1562451-3.5
 Parameter: XMIN <- "-35.6562451"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "35.6552699"
Evaluating: 35.6552699-3.5
 Parameter: YMIN <- "32.1552699"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-32.2364713"
Evaluating: -32.2364713-3.5
 Parameter: ZMIN <- "-35.7364713"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-28.6562451"
 Parameter: XMIN -> "-35.6562451"
 Parameter: YMAX -> "39.1552699"
 Parameter: YMIN -> "32.1552699"
 Parameter: ZMAX -> "-28.7364713"
 Parameter: ZMIN -> "-35.7364713"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "53"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "53" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "53"
Evaluating: 53
 Parameter: J <- "53"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "53" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "53"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.248820479"
Evaluating: 120.112447*(0.248820479-0.5)
 Parameter: XPOS <- "-30.1697869"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.616910528"
Evaluating: 120.112447*(0.616910528-0.5)
 Parameter: YPOS <- "14.0424096"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.733927646"
Evaluating: 85*(0.733927646-0.5)+0
 Parameter: ZPOS <- "19.8838499"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "19.8838499" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "19.8838499" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-30.1697869"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -30.1697869-0
 Parameter: XTRAN <- "-30.1697869"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "14.0424096"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 14.0424096-0
 Parameter: YTRAN <- "14.0424096"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "19.8838499"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 19.8838499-0
 Parameter: ZTRAN <- "19.8838499"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-30.1697869"
 Parameter: YTRAN -> "14.0424096"
 Parameter: ZTRAN -> "19.8838499"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR   -30.169787   14.042410   19.883850
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.12791584"
Evaluating: 0.12791584*360.0
 Parameter: XPHI <- "46.0497024"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.747066019E-03"
Evaluating: 5.747066019E-03*360.0
 Parameter: YPHI <- "2.06894377"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.481978015"
Evaluating: 0.481978015*360.0
 Parameter: ZPHI <- "173.512085"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-30.1697869"
 Parameter: YPOS -> "14.0424096"
 Parameter: ZPOS -> "19.8838499"
 Parameter: XPHI -> "46.0497024"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.694034    0.719942
    0.000000   -0.719942    0.694034

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   46.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-30.1697869"
 Parameter: YPOS -> "14.0424096"
 Parameter: ZPOS -> "19.8838499"
 Parameter: YPHI -> "2.06894377"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.999348    0.000000   -0.036102
    0.000000    1.000000    0.000000
    0.036102    0.000000    0.999348

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    2.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-30.1697869"
 Parameter: YPOS -> "14.0424096"
 Parameter: ZPOS -> "19.8838499"
 Parameter: ZPHI -> "173.512085"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.993596    0.112994    0.000000
   -0.112994   -0.993596    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  173.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -30.169787 XMAX =  -30.169787 XAVE =  -30.169787
    YMIN =   14.042410 YMAX =   14.042410 YAVE =   14.042410
    ZMIN =   19.883850 ZMAX =   19.883850 ZAVE =   19.883850
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-30.1697869"
Evaluating: -30.1697869+3.5
 Parameter: XMAX <- "-26.6697869"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "14.0424096"
Evaluating: 14.0424096+3.5
 Parameter: YMAX <- "17.5424096"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "19.8838499"
Evaluating: 19.8838499+3.5
 Parameter: ZMAX <- "23.3838499"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-30.1697869"
Evaluating: -30.1697869-3.5
 Parameter: XMIN <- "-33.6697869"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "14.0424096"
Evaluating: 14.0424096-3.5
 Parameter: YMIN <- "10.5424096"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "19.8838499"
Evaluating: 19.8838499-3.5
 Parameter: ZMIN <- "16.3838499"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-26.6697869"
 Parameter: XMIN -> "-33.6697869"
 Parameter: YMAX -> "17.5424096"
 Parameter: YMIN -> "10.5424096"
 Parameter: ZMAX -> "23.3838499"
 Parameter: ZMIN -> "16.3838499"
 SELRPN>      2 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      2 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
 5549 POS      NA       53       NA      - 517 MEMB     DPPC     44       NC3           2.3485
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "53"
Evaluating: 53
 Parameter: J <- "53"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "53" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "53"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.665293787"
Evaluating: 120.112447*(0.665293787-0.5)
 Parameter: XPOS <- "19.8538412"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.100581993"
Evaluating: 120.112447*(0.100581993-0.5)
 Parameter: YPOS <- "-47.9750742"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.370844236"
Evaluating: 85*(0.370844236-0.5)+0
 Parameter: ZPOS <- "-10.9782399"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-10.9782399" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-10.9782399" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "53"
Evaluating: 53
 Parameter: J <- "53"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "53" and "53".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "53"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.548209238"
Evaluating: 120.112447*(0.548209238-0.5)
 Parameter: XPOS <- "5.79052954"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.330310851"
Evaluating: 120.112447*(0.330310851-0.5)
 Parameter: YPOS <- "-20.3817789"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.981873067"
Evaluating: 85*(0.981873067-0.5)+0
 Parameter: ZPOS <- "40.9592107"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "40.9592107" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "40.9592107" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -30.169787 XMAX =  -30.169787 XAVE =  -30.169787
    YMIN =   14.042410 YMAX =   14.042410 YAVE =   14.042410
    ZMIN =   19.883850 ZMAX =   19.883850 ZAVE =   19.883850
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "5.79052954"
 RDCMND substituted energy or value "?XAVE" to "-30.1697869"
Evaluating: 5.79052954--30.1697869
 Parameter: XTRAN <- "35.9603164"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-20.3817789"
 RDCMND substituted energy or value "?YAVE" to "14.0424096"
Evaluating: -20.3817789-14.0424096
 Parameter: YTRAN <- "-34.4241885"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "40.9592107"
 RDCMND substituted energy or value "?ZAVE" to "19.8838499"
Evaluating: 40.9592107-19.8838499
 Parameter: ZTRAN <- "21.0753608"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "35.9603164"
 Parameter: YTRAN -> "-34.4241885"
 Parameter: ZTRAN -> "21.0753608"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    35.960316  -34.424188   21.075361
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.482290363"
Evaluating: 0.482290363*360.0
 Parameter: XPHI <- "173.624531"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.604957504"
Evaluating: 0.604957504*360.0
 Parameter: YPHI <- "217.784701"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.927725425"
Evaluating: 0.927725425*360.0
 Parameter: ZPHI <- "333.981153"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "5.79052954"
 Parameter: YPOS -> "-20.3817789"
 Parameter: ZPOS -> "40.9592107"
 Parameter: XPHI -> "173.624531"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.993816    0.111043
    0.000000   -0.111043   -0.993816

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  173.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "5.79052954"
 Parameter: YPOS -> "-20.3817789"
 Parameter: ZPOS -> "40.9592107"
 Parameter: YPHI -> "217.784701"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.790319    0.000000    0.612696
    0.000000    1.000000    0.000000
   -0.612696    0.000000   -0.790319

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  142.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "5.79052954"
 Parameter: YPOS -> "-20.3817789"
 Parameter: ZPOS -> "40.9592107"
 Parameter: ZPHI -> "333.981153"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.898650   -0.438667    0.000000
    0.438667    0.898650    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   26.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    5.790530 XMAX =    5.790530 XAVE =    5.790530
    YMIN =  -20.381779 YMAX =  -20.381779 YAVE =  -20.381779
    ZMIN =   40.959211 ZMAX =   40.959211 ZAVE =   40.959211
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "5.79052957"
Evaluating: 5.79052957+3.5
 Parameter: XMAX <- "9.29052957"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-20.3817789"
Evaluating: -20.3817789+3.5
 Parameter: YMAX <- "-16.8817789"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "40.9592107"
Evaluating: 40.9592107+3.5
 Parameter: ZMAX <- "44.4592107"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "5.79052957"
Evaluating: 5.79052957-3.5
 Parameter: XMIN <- "2.29052957"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-20.3817789"
Evaluating: -20.3817789-3.5
 Parameter: YMIN <- "-23.8817789"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "40.9592107"
Evaluating: 40.9592107-3.5
 Parameter: ZMIN <- "37.4592107"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "9.29052957"
 Parameter: XMIN -> "2.29052957"
 Parameter: YMAX -> "-16.8817789"
 Parameter: YMIN -> "-23.8817789"
 Parameter: ZMAX -> "44.4592107"
 Parameter: ZMIN -> "37.4592107"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "54"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "54" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "54"
Evaluating: 54
 Parameter: J <- "54"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "54" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "54"
 Parameter: NPOS -> "53"
Evaluating: 54-53
 Parameter: J <- "1"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "1"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.976188769"
Evaluating: 120.112447*(0.976188769-0.5)
 Parameter: XPOS <- "57.1961983"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.275743165"
Evaluating: 120.112447*(0.275743165-0.5)
 Parameter: YPOS <- "-26.9360372"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.939719348"
Evaluating: 85*(0.939719348-0.5)+0
 Parameter: ZPOS <- "37.3761446"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "37.3761446" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "37.3761446" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "57.1961983"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 57.1961983-0
 Parameter: XTRAN <- "57.1961983"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-26.9360372"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -26.9360372-0
 Parameter: YTRAN <- "-26.9360372"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "37.3761446"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 37.3761446-0
 Parameter: ZTRAN <- "37.3761446"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "57.1961983"
 Parameter: YTRAN -> "-26.9360372"
 Parameter: ZTRAN -> "37.3761446"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    57.196198  -26.936037   37.376145
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.777395419"
Evaluating: 0.777395419*360.0
 Parameter: XPHI <- "279.862351"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.624772353"
Evaluating: 0.624772353*360.0
 Parameter: YPHI <- "224.918047"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.917153906"
Evaluating: 0.917153906*360.0
 Parameter: ZPHI <- "330.175406"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "57.1961983"
 Parameter: YPOS -> "-26.9360372"
 Parameter: ZPOS -> "37.3761446"
 Parameter: XPHI -> "279.862351"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.171282   -0.985222
    0.000000    0.985222    0.171282

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   80.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "57.1961983"
 Parameter: YPOS -> "-26.9360372"
 Parameter: ZPOS -> "37.3761446"
 Parameter: YPHI -> "224.918047"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.708117    0.000000    0.706095
    0.000000    1.000000    0.000000
   -0.706095    0.000000   -0.708117

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  135.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "57.1961983"
 Parameter: YPOS -> "-26.9360372"
 Parameter: ZPOS -> "37.3761446"
 Parameter: ZPHI -> "330.175406"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.867552   -0.497346    0.000000
    0.497346    0.867552    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   29.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   57.196198 XMAX =   57.196198 XAVE =   57.196198
    YMIN =  -26.936037 YMAX =  -26.936037 YAVE =  -26.936037
    ZMIN =   37.376145 ZMAX =   37.376145 ZAVE =   37.376145
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "57.1961983"
Evaluating: 57.1961983+3.5
 Parameter: XMAX <- "60.6961983"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-26.9360372"
Evaluating: -26.9360372+3.5
 Parameter: YMAX <- "-23.4360372"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "37.3761446"
Evaluating: 37.3761446+3.5
 Parameter: ZMAX <- "40.8761446"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "57.1961983"
Evaluating: 57.1961983-3.5
 Parameter: XMIN <- "53.6961983"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-26.9360372"
Evaluating: -26.9360372-3.5
 Parameter: YMIN <- "-30.4360372"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "37.3761446"
Evaluating: 37.3761446-3.5
 Parameter: ZMIN <- "33.8761446"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "60.6961983"
 Parameter: XMIN -> "53.6961983"
 Parameter: YMAX -> "-23.4360372"
 Parameter: YMIN -> "-30.4360372"
 Parameter: ZMAX -> "40.8761446"
 Parameter: ZMIN -> "33.8761446"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "55"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "55" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "55"
Evaluating: 55
 Parameter: J <- "55"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "55" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "55"
 Parameter: NPOS -> "53"
Evaluating: 55-53
 Parameter: J <- "2"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "2"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "9.931468978E-02"
Evaluating: 120.112447*(9.931468978E-02-0.5)
 Parameter: XPOS <- "-48.1272931"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.509863008"
Evaluating: 120.112447*(0.509863008-0.5)
 Parameter: YPOS <- "1.18467003"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.475563252"
Evaluating: 85*(0.475563252-0.5)+0
 Parameter: ZPOS <- "-2.07712358"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-2.07712358" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-2.07712358" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "55"
Evaluating: 55
 Parameter: J <- "55"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "55" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "55"
 Parameter: NPOS -> "53"
Evaluating: 55-53
 Parameter: J <- "2"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "2"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.158044129"
Evaluating: 120.112447*(0.158044129-0.5)
 Parameter: XPOS <- "-41.0731564"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.688852325"
Evaluating: 120.112447*(0.688852325-0.5)
 Parameter: YPOS <- "22.6835149"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.436123189"
Evaluating: 85*(0.436123189-0.5)+0
 Parameter: ZPOS <- "-5.42952894"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-5.42952894" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-5.42952894" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "55"
Evaluating: 55
 Parameter: J <- "55"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "55" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "55"
 Parameter: NPOS -> "53"
Evaluating: 55-53
 Parameter: J <- "2"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "2"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.850179853"
Evaluating: 120.112447*(0.850179853-0.5)
 Parameter: XPOS <- "42.060959"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.119853104"
Evaluating: 120.112447*(0.119853104-0.5)
 Parameter: YPOS <- "-45.6603739"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.158465082"
Evaluating: 85*(0.158465082-0.5)+0
 Parameter: ZPOS <- "-29.030468"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-29.030468" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "42.060959"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 42.060959-0
 Parameter: XTRAN <- "42.060959"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-45.6603739"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -45.6603739-0
 Parameter: YTRAN <- "-45.6603739"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-29.030468"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -29.030468-0
 Parameter: ZTRAN <- "-29.030468"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "42.060959"
 Parameter: YTRAN -> "-45.6603739"
 Parameter: ZTRAN -> "-29.030468"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    42.060959  -45.660374  -29.030468
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.386042665"
Evaluating: 0.386042665*360.0
 Parameter: XPHI <- "138.975359"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.655682934"
Evaluating: 0.655682934*360.0
 Parameter: YPHI <- "236.045856"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.176246207"
Evaluating: 0.176246207*360.0
 Parameter: ZPHI <- "63.4486345"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "42.060959"
 Parameter: YPOS -> "-45.6603739"
 Parameter: ZPOS -> "-29.030468"
 Parameter: XPHI -> "138.975359"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.754427    0.656384
    0.000000   -0.656384   -0.754427

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  138.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "42.060959"
 Parameter: YPOS -> "-45.6603739"
 Parameter: ZPOS -> "-29.030468"
 Parameter: YPHI -> "236.045856"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.558529    0.000000    0.829485
    0.000000    1.000000    0.000000
   -0.829485    0.000000   -0.558529

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  123.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "42.060959"
 Parameter: YPOS -> "-45.6603739"
 Parameter: ZPOS -> "-29.030468"
 Parameter: ZPHI -> "63.4486345"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.447000    0.894534    0.000000
   -0.894534    0.447000    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   63.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   42.060959 XMAX =   42.060959 XAVE =   42.060959
    YMIN =  -45.660374 YMAX =  -45.660374 YAVE =  -45.660374
    ZMIN =  -29.030468 ZMAX =  -29.030468 ZAVE =  -29.030468
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "42.060959"
Evaluating: 42.060959+3.5
 Parameter: XMAX <- "45.560959"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-45.6603739"
Evaluating: -45.6603739+3.5
 Parameter: YMAX <- "-42.1603739"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-29.030468"
Evaluating: -29.030468+3.5
 Parameter: ZMAX <- "-25.530468"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "42.060959"
Evaluating: 42.060959-3.5
 Parameter: XMIN <- "38.560959"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-45.6603739"
Evaluating: -45.6603739-3.5
 Parameter: YMIN <- "-49.1603739"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-29.030468"
Evaluating: -29.030468-3.5
 Parameter: ZMIN <- "-32.530468"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "45.560959"
 Parameter: XMIN -> "38.560959"
 Parameter: YMAX -> "-42.1603739"
 Parameter: YMIN -> "-49.1603739"
 Parameter: ZMAX -> "-25.530468"
 Parameter: ZMIN -> "-32.530468"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "56"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "56" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "56"
Evaluating: 56
 Parameter: J <- "56"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "56" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "56"
 Parameter: NPOS -> "53"
Evaluating: 56-53
 Parameter: J <- "3"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "3"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.490458635"
Evaluating: 120.112447*(0.490458635-0.5)
 Parameter: XPOS <- "-1.1460367"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.572756853"
Evaluating: 120.112447*(0.572756853-0.5)
 Parameter: YPOS <- "8.73900365"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.266969693"
Evaluating: 85*(0.266969693-0.5)+0
 Parameter: ZPOS <- "-19.8075761"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-19.8075761" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-1.1460367"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -1.1460367-0
 Parameter: XTRAN <- "-1.1460367"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "8.73900365"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 8.73900365-0
 Parameter: YTRAN <- "8.73900365"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-19.8075761"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -19.8075761-0
 Parameter: ZTRAN <- "-19.8075761"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-1.1460367"
 Parameter: YTRAN -> "8.73900365"
 Parameter: ZTRAN -> "-19.8075761"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    -1.146037    8.739004  -19.807576
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.790539633"
Evaluating: 0.790539633*360.0
 Parameter: XPHI <- "284.594268"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.347614111"
Evaluating: 0.347614111*360.0
 Parameter: YPHI <- "125.14108"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.195879259"
Evaluating: 0.195879259*360.0
 Parameter: ZPHI <- "70.5165332"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-1.1460367"
 Parameter: YPOS -> "8.73900365"
 Parameter: ZPOS -> "-19.8075761"
 Parameter: XPHI -> "284.594268"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.251973   -0.967734
    0.000000    0.967734    0.251973

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   75.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-1.1460367"
 Parameter: YPOS -> "8.73900365"
 Parameter: ZPOS -> "-19.8075761"
 Parameter: YPHI -> "125.14108"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.575592    0.000000   -0.817737
    0.000000    1.000000    0.000000
    0.817737    0.000000   -0.575592

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  125.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-1.1460367"
 Parameter: YPOS -> "8.73900365"
 Parameter: ZPOS -> "-19.8075761"
 Parameter: ZPHI -> "70.5165332"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.333535    0.942738    0.000000
   -0.942738    0.333535    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   70.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -1.146037 XMAX =   -1.146037 XAVE =   -1.146037
    YMIN =    8.739004 YMAX =    8.739004 YAVE =    8.739004
    ZMIN =  -19.807576 ZMAX =  -19.807576 ZAVE =  -19.807576
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-1.1460367"
Evaluating: -1.1460367+3.5
 Parameter: XMAX <- "2.3539633"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "8.73900365"
Evaluating: 8.73900365+3.5
 Parameter: YMAX <- "12.2390037"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-19.8075761"
Evaluating: -19.8075761+3.5
 Parameter: ZMAX <- "-16.3075761"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-1.1460367"
Evaluating: -1.1460367-3.5
 Parameter: XMIN <- "-4.6460367"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "8.73900365"
Evaluating: 8.73900365-3.5
 Parameter: YMIN <- "5.23900365"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-19.8075761"
Evaluating: -19.8075761-3.5
 Parameter: ZMIN <- "-23.3075761"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "2.3539633"
 Parameter: XMIN -> "-4.6460367"
 Parameter: YMAX -> "12.2390037"
 Parameter: YMIN -> "5.23900365"
 Parameter: ZMAX -> "-16.3075761"
 Parameter: ZMIN -> "-23.3075761"
 SELRPN>      2 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      2 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
 5552 NEG      CL       3        CL      -2761 MEMB     DPPC     231      NC3           3.4540
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "56"
Evaluating: 56
 Parameter: J <- "56"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "56" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "56"
 Parameter: NPOS -> "53"
Evaluating: 56-53
 Parameter: J <- "3"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "3"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.639638182"
Evaluating: 120.112447*(0.639638182-0.5)
 Parameter: XPOS <- "16.7722837"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.538731049"
Evaluating: 120.112447*(0.538731049-0.5)
 Parameter: YPOS <- "4.65208107"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.470750595"
Evaluating: 85*(0.470750595-0.5)+0
 Parameter: ZPOS <- "-2.48619943"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-2.48619943" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-2.48619943" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "56"
Evaluating: 56
 Parameter: J <- "56"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "56" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "56"
 Parameter: NPOS -> "53"
Evaluating: 56-53
 Parameter: J <- "3"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "3"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.458500861"
Evaluating: 120.112447*(0.458500861-0.5)
 Parameter: XPOS <- "-4.98456313"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.736100992"
Evaluating: 120.112447*(0.736100992-0.5)
 Parameter: YPOS <- "28.3586679"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.810753988"
Evaluating: 85*(0.810753988-0.5)+0
 Parameter: ZPOS <- "26.414089"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "26.414089" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "26.414089" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -1.146037 XMAX =   -1.146037 XAVE =   -1.146037
    YMIN =    8.739004 YMAX =    8.739004 YAVE =    8.739004
    ZMIN =  -19.807576 ZMAX =  -19.807576 ZAVE =  -19.807576
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-4.98456313"
 RDCMND substituted energy or value "?XAVE" to "-1.1460367"
Evaluating: -4.98456313--1.1460367
 Parameter: XTRAN <- "-3.83852643"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "28.3586679"
 RDCMND substituted energy or value "?YAVE" to "8.73900365"
Evaluating: 28.3586679-8.73900365
 Parameter: YTRAN <- "19.6196642"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "26.414089"
 RDCMND substituted energy or value "?ZAVE" to "-19.8075761"
Evaluating: 26.414089--19.8075761
 Parameter: ZTRAN <- "46.2216651"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-3.83852643"
 Parameter: YTRAN -> "19.6196642"
 Parameter: ZTRAN -> "46.2216651"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    -3.838526   19.619664   46.221665
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.683534562"
Evaluating: 0.683534562*360.0
 Parameter: XPHI <- "246.072442"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.629681641"
Evaluating: 0.629681641*360.0
 Parameter: YPHI <- "226.685391"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.96851017E-02"
Evaluating: 4.96851017E-02*360.0
 Parameter: ZPHI <- "17.8866366"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-4.98456313"
 Parameter: YPOS -> "28.3586679"
 Parameter: ZPOS -> "26.414089"
 Parameter: XPHI -> "246.072442"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.405581   -0.914059
    0.000000    0.914059   -0.405581

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  113.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-4.98456313"
 Parameter: YPOS -> "28.3586679"
 Parameter: ZPOS -> "26.414089"
 Parameter: YPHI -> "226.685391"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.686004    0.000000    0.727598
    0.000000    1.000000    0.000000
   -0.727598    0.000000   -0.686004

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  133.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-4.98456313"
 Parameter: YPOS -> "28.3586679"
 Parameter: ZPOS -> "26.414089"
 Parameter: ZPHI -> "17.8866366"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.951666    0.307135    0.000000
   -0.307135    0.951666    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   17.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -4.984563 XMAX =   -4.984563 XAVE =   -4.984563
    YMIN =   28.358668 YMAX =   28.358668 YAVE =   28.358668
    ZMIN =   26.414089 ZMAX =   26.414089 ZAVE =   26.414089
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-4.98456316"
Evaluating: -4.98456316+3.5
 Parameter: XMAX <- "-1.48456316"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "28.3586679"
Evaluating: 28.3586679+3.5
 Parameter: YMAX <- "31.8586679"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "26.414089"
Evaluating: 26.414089+3.5
 Parameter: ZMAX <- "29.914089"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-4.98456316"
Evaluating: -4.98456316-3.5
 Parameter: XMIN <- "-8.48456316"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "28.3586679"
Evaluating: 28.3586679-3.5
 Parameter: YMIN <- "24.8586679"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "26.414089"
Evaluating: 26.414089-3.5
 Parameter: ZMIN <- "22.914089"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-1.48456316"
 Parameter: XMIN -> "-8.48456316"
 Parameter: YMAX -> "31.8586679"
 Parameter: YMIN -> "24.8586679"
 Parameter: ZMAX -> "29.914089"
 Parameter: ZMIN -> "22.914089"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "57"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "57" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "57"
Evaluating: 57
 Parameter: J <- "57"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "57" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "57"
 Parameter: NPOS -> "53"
Evaluating: 57-53
 Parameter: J <- "4"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "4"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.470740845"
Evaluating: 120.112447*(0.470740845-0.5)
 Parameter: XPOS <- "-3.5143887"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.563197774"
Evaluating: 120.112447*(0.563197774-0.5)
 Parameter: YPOS <- "7.59083928"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.529708721"
Evaluating: 85*(0.529708721-0.5)+0
 Parameter: ZPOS <- "2.52524128"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "2.52524128" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "2.52524128" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "57"
Evaluating: 57
 Parameter: J <- "57"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "57" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "57"
 Parameter: NPOS -> "53"
Evaluating: 57-53
 Parameter: J <- "4"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "4"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.882313176"
Evaluating: 120.112447*(0.882313176-0.5)
 Parameter: XPOS <- "45.9205711"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.235352547"
Evaluating: 120.112447*(0.235352547-0.5)
 Parameter: YPOS <- "-31.7874532"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.80431343"
Evaluating: 85*(0.80431343-0.5)+0
 Parameter: ZPOS <- "25.8666416"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "25.8666416" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "25.8666416" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "45.9205711"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 45.9205711-0
 Parameter: XTRAN <- "45.9205711"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-31.7874532"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -31.7874532-0
 Parameter: YTRAN <- "-31.7874532"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "25.8666416"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 25.8666416-0
 Parameter: ZTRAN <- "25.8666416"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "45.9205711"
 Parameter: YTRAN -> "-31.7874532"
 Parameter: ZTRAN -> "25.8666416"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    45.920571  -31.787453   25.866642
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.454365876"
Evaluating: 0.454365876*360.0
 Parameter: XPHI <- "163.571715"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.466725246"
Evaluating: 0.466725246*360.0
 Parameter: YPHI <- "168.021089"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.346337952"
Evaluating: 0.346337952*360.0
 Parameter: ZPHI <- "124.681663"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "45.9205711"
 Parameter: YPOS -> "-31.7874532"
 Parameter: ZPOS -> "25.8666416"
 Parameter: XPHI -> "163.571715"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.959174    0.282815
    0.000000   -0.282815   -0.959174

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  163.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "45.9205711"
 Parameter: YPOS -> "-31.7874532"
 Parameter: ZPOS -> "25.8666416"
 Parameter: YPHI -> "168.021089"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.978224    0.000000   -0.207552
    0.000000    1.000000    0.000000
    0.207552    0.000000   -0.978224

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  168.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "45.9205711"
 Parameter: YPOS -> "-31.7874532"
 Parameter: ZPOS -> "25.8666416"
 Parameter: ZPHI -> "124.681663"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.569016    0.822326    0.000000
   -0.822326   -0.569016    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  124.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   45.920571 XMAX =   45.920571 XAVE =   45.920571
    YMIN =  -31.787453 YMAX =  -31.787453 YAVE =  -31.787453
    ZMIN =   25.866642 ZMAX =   25.866642 ZAVE =   25.866642
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "45.9205711"
Evaluating: 45.9205711+3.5
 Parameter: XMAX <- "49.4205711"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-31.7874532"
Evaluating: -31.7874532+3.5
 Parameter: YMAX <- "-28.2874532"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "25.8666416"
Evaluating: 25.8666416+3.5
 Parameter: ZMAX <- "29.3666416"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "45.9205711"
Evaluating: 45.9205711-3.5
 Parameter: XMIN <- "42.4205711"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-31.7874532"
Evaluating: -31.7874532-3.5
 Parameter: YMIN <- "-35.2874532"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "25.8666416"
Evaluating: 25.8666416-3.5
 Parameter: ZMIN <- "22.3666416"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "49.4205711"
 Parameter: XMIN -> "42.4205711"
 Parameter: YMAX -> "-28.2874532"
 Parameter: YMIN -> "-35.2874532"
 Parameter: ZMAX -> "29.3666416"
 Parameter: ZMIN -> "22.3666416"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "58"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "58" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "58"
Evaluating: 58
 Parameter: J <- "58"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "58" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "58"
 Parameter: NPOS -> "53"
Evaluating: 58-53
 Parameter: J <- "5"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "5"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.587124099"
Evaluating: 120.112447*(0.587124099-0.5)
 Parameter: XPOS <- "10.4646887"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.674713669"
Evaluating: 120.112447*(0.674713669-0.5)
 Parameter: YPOS <- "20.9852863"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.508655513"
Evaluating: 85*(0.508655513-0.5)+0
 Parameter: ZPOS <- "0.735718605"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "0.735718605" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "0.735718605" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "58"
Evaluating: 58
 Parameter: J <- "58"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "58" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "58"
 Parameter: NPOS -> "53"
Evaluating: 58-53
 Parameter: J <- "5"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "5"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.208198071"
Evaluating: 120.112447*(0.208198071-0.5)
 Parameter: XPOS <- "-35.0490437"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.366595197"
Evaluating: 120.112447*(0.366595197-0.5)
 Parameter: YPOS <- "-16.0235773"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.55299529"
Evaluating: 85*(0.55299529-0.5)+0
 Parameter: ZPOS <- "4.50459965"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "4.50459965" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "4.50459965" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "58"
Evaluating: 58
 Parameter: J <- "58"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "58" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "58"
 Parameter: NPOS -> "53"
Evaluating: 58-53
 Parameter: J <- "5"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "5"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.199318484"
Evaluating: 120.112447*(0.199318484-0.5)
 Parameter: XPOS <- "-36.1155927"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.530214679"
Evaluating: 120.112447*(0.530214679-0.5)
 Parameter: YPOS <- "3.62915903"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.422002518"
Evaluating: 85*(0.422002518-0.5)+0
 Parameter: ZPOS <- "-6.62978597"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-6.62978597" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-6.62978597" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "58"
Evaluating: 58
 Parameter: J <- "58"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "58" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "58"
 Parameter: NPOS -> "53"
Evaluating: 58-53
 Parameter: J <- "5"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "5"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.776543146"
Evaluating: 120.112447*(0.776543146-0.5)
 Parameter: XPOS <- "33.216274"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.806257869"
Evaluating: 120.112447*(0.806257869-0.5)
 Parameter: YPOS <- "36.7853821"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.785366493"
Evaluating: 85*(0.785366493-0.5)+0
 Parameter: ZPOS <- "24.2561519"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "24.2561519" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "24.2561519" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "33.216274"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 33.216274-0
 Parameter: XTRAN <- "33.216274"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "36.7853821"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 36.7853821-0
 Parameter: YTRAN <- "36.7853821"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "24.2561519"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 24.2561519-0
 Parameter: ZTRAN <- "24.2561519"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "33.216274"
 Parameter: YTRAN -> "36.7853821"
 Parameter: ZTRAN -> "24.2561519"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    33.216274   36.785382   24.256152
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.645062404"
Evaluating: 0.645062404*360.0
 Parameter: XPHI <- "232.222465"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.568556496"
Evaluating: 0.568556496*360.0
 Parameter: YPHI <- "204.680339"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.122296764"
Evaluating: 0.122296764*360.0
 Parameter: ZPHI <- "44.026835"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "33.216274"
 Parameter: YPOS -> "36.7853821"
 Parameter: ZPOS -> "24.2561519"
 Parameter: XPHI -> "232.222465"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.612597   -0.790395
    0.000000    0.790395   -0.612597

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  127.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "33.216274"
 Parameter: YPOS -> "36.7853821"
 Parameter: ZPOS -> "24.2561519"
 Parameter: YPHI -> "204.680339"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.908652    0.000000    0.417555
    0.000000    1.000000    0.000000
   -0.417555    0.000000   -0.908652

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  155.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "33.216274"
 Parameter: YPOS -> "36.7853821"
 Parameter: ZPOS -> "24.2561519"
 Parameter: ZPHI -> "44.026835"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.719014    0.694995    0.000000
   -0.694995    0.719014    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   44.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   33.216274 XMAX =   33.216274 XAVE =   33.216274
    YMIN =   36.785382 YMAX =   36.785382 YAVE =   36.785382
    ZMIN =   24.256152 ZMAX =   24.256152 ZAVE =   24.256152
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "33.216274"
Evaluating: 33.216274+3.5
 Parameter: XMAX <- "36.716274"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "36.7853821"
Evaluating: 36.7853821+3.5
 Parameter: YMAX <- "40.2853821"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "24.2561519"
Evaluating: 24.2561519+3.5
 Parameter: ZMAX <- "27.7561519"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "33.216274"
Evaluating: 33.216274-3.5
 Parameter: XMIN <- "29.716274"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "36.7853821"
Evaluating: 36.7853821-3.5
 Parameter: YMIN <- "33.2853821"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "24.2561519"
Evaluating: 24.2561519-3.5
 Parameter: ZMIN <- "20.7561519"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "36.716274"
 Parameter: XMIN -> "29.716274"
 Parameter: YMAX -> "40.2853821"
 Parameter: YMIN -> "33.2853821"
 Parameter: ZMAX -> "27.7561519"
 Parameter: ZMIN -> "20.7561519"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "59"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "59" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "59"
Evaluating: 59
 Parameter: J <- "59"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "59" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "59"
 Parameter: NPOS -> "53"
Evaluating: 59-53
 Parameter: J <- "6"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "6"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.12541007"
Evaluating: 120.112447*(0.12541007-0.5)
 Parameter: XPOS <- "-44.9929131"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.129035079"
Evaluating: 120.112447*(0.129035079-0.5)
 Parameter: YPOS <- "-44.5575044"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.459575843"
Evaluating: 85*(0.459575843-0.5)+0
 Parameter: ZPOS <- "-3.43605335"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-3.43605335" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-3.43605335" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "59"
Evaluating: 59
 Parameter: J <- "59"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "59" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "59"
 Parameter: NPOS -> "53"
Evaluating: 59-53
 Parameter: J <- "6"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "6"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.22654488"
Evaluating: 120.112447*(0.22654488-0.5)
 Parameter: XPOS <- "-32.8453636"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.73775663"
Evaluating: 120.112447*(0.73775663-0.5)
 Parameter: YPOS <- "28.5575306"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.180452253"
Evaluating: 85*(0.180452253-0.5)+0
 Parameter: ZPOS <- "-27.1615585"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-27.1615585" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-32.8453636"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -32.8453636-0
 Parameter: XTRAN <- "-32.8453636"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "28.5575306"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 28.5575306-0
 Parameter: YTRAN <- "28.5575306"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-27.1615585"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -27.1615585-0
 Parameter: ZTRAN <- "-27.1615585"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-32.8453636"
 Parameter: YTRAN -> "28.5575306"
 Parameter: ZTRAN -> "-27.1615585"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR   -32.845364   28.557531  -27.161559
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.902215464"
Evaluating: 0.902215464*360.0
 Parameter: XPHI <- "324.797567"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.952227871"
Evaluating: 0.952227871*360.0
 Parameter: YPHI <- "342.802034"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.861479055"
Evaluating: 0.861479055*360.0
 Parameter: ZPHI <- "310.13246"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-32.8453636"
 Parameter: YPOS -> "28.5575306"
 Parameter: ZPOS -> "-27.1615585"
 Parameter: XPHI -> "324.797567"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.817120   -0.576467
    0.000000    0.576467    0.817120

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   35.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-32.8453636"
 Parameter: YPOS -> "28.5575306"
 Parameter: ZPOS -> "-27.1615585"
 Parameter: YPHI -> "342.802034"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.955289    0.000000    0.295674
    0.000000    1.000000    0.000000
   -0.295674    0.000000    0.955289

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   17.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-32.8453636"
 Parameter: YPOS -> "28.5575306"
 Parameter: ZPOS -> "-27.1615585"
 Parameter: ZPHI -> "310.13246"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.644557   -0.764556    0.000000
    0.764556    0.644557    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   49.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -32.845364 XMAX =  -32.845364 XAVE =  -32.845364
    YMIN =   28.557531 YMAX =   28.557531 YAVE =   28.557531
    ZMIN =  -27.161559 ZMAX =  -27.161559 ZAVE =  -27.161559
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-32.8453636"
Evaluating: -32.8453636+3.5
 Parameter: XMAX <- "-29.3453636"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "28.5575306"
Evaluating: 28.5575306+3.5
 Parameter: YMAX <- "32.0575306"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-27.1615585"
Evaluating: -27.1615585+3.5
 Parameter: ZMAX <- "-23.6615585"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-32.8453636"
Evaluating: -32.8453636-3.5
 Parameter: XMIN <- "-36.3453636"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "28.5575306"
Evaluating: 28.5575306-3.5
 Parameter: YMIN <- "25.0575306"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-27.1615585"
Evaluating: -27.1615585-3.5
 Parameter: ZMIN <- "-30.6615585"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-29.3453636"
 Parameter: XMIN -> "-36.3453636"
 Parameter: YMAX -> "32.0575306"
 Parameter: YMIN -> "25.0575306"
 Parameter: ZMAX -> "-23.6615585"
 Parameter: ZMIN -> "-30.6615585"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "60"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "60" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "60"
Evaluating: 60
 Parameter: J <- "60"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "60" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "60"
 Parameter: NPOS -> "53"
Evaluating: 60-53
 Parameter: J <- "7"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "7"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.836840236"
Evaluating: 120.112447*(0.836840236-0.5)
 Parameter: XPOS <- "40.458705"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "5.347683505E-02"
Evaluating: 120.112447*(5.347683505E-02-0.5)
 Parameter: YPOS <- "-53.63299"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.337215027"
Evaluating: 85*(0.337215027-0.5)+0
 Parameter: ZPOS <- "-13.8367227"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-13.8367227" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-13.8367227" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "60"
Evaluating: 60
 Parameter: J <- "60"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "60" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "60"
 Parameter: NPOS -> "53"
Evaluating: 60-53
 Parameter: J <- "7"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "7"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.324904008"
Evaluating: 120.112447*(0.324904008-0.5)
 Parameter: XPOS <- "-21.0312081"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.384484968"
Evaluating: 120.112447*(0.384484968-0.5)
 Parameter: YPOS <- "-13.8747932"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.735355284"
Evaluating: 85*(0.735355284-0.5)+0
 Parameter: ZPOS <- "20.0051991"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "20.0051991" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "20.0051991" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-21.0312081"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -21.0312081-0
 Parameter: XTRAN <- "-21.0312081"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-13.8747932"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -13.8747932-0
 Parameter: YTRAN <- "-13.8747932"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "20.0051991"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 20.0051991-0
 Parameter: ZTRAN <- "20.0051991"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-21.0312081"
 Parameter: YTRAN -> "-13.8747932"
 Parameter: ZTRAN -> "20.0051991"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR   -21.031208  -13.874793   20.005199
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.176802123E-02"
Evaluating: 8.176802123E-02*360.0
 Parameter: XPHI <- "29.4364876"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.776711595"
Evaluating: 0.776711595*360.0
 Parameter: YPHI <- "279.616174"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.338994901"
Evaluating: 0.338994901*360.0
 Parameter: ZPHI <- "122.038164"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-21.0312081"
 Parameter: YPOS -> "-13.8747932"
 Parameter: ZPOS -> "20.0051991"
 Parameter: XPHI -> "29.4364876"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.870901    0.491458
    0.000000   -0.491458    0.870901

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   29.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-21.0312081"
 Parameter: YPOS -> "-13.8747932"
 Parameter: ZPOS -> "20.0051991"
 Parameter: YPHI -> "279.616174"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.167047    0.000000    0.985949
    0.000000    1.000000    0.000000
   -0.985949    0.000000    0.167047

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   80.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-21.0312081"
 Parameter: YPOS -> "-13.8747932"
 Parameter: ZPOS -> "20.0051991"
 Parameter: ZPHI -> "122.038164"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.530484    0.847695    0.000000
   -0.847695   -0.530484    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  122.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -21.031208 XMAX =  -21.031208 XAVE =  -21.031208
    YMIN =  -13.874793 YMAX =  -13.874793 YAVE =  -13.874793
    ZMIN =   20.005199 ZMAX =   20.005199 ZAVE =   20.005199
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-21.0312081"
Evaluating: -21.0312081+3.5
 Parameter: XMAX <- "-17.5312081"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-13.8747932"
Evaluating: -13.8747932+3.5
 Parameter: YMAX <- "-10.3747932"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "20.0051991"
Evaluating: 20.0051991+3.5
 Parameter: ZMAX <- "23.5051991"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-21.0312081"
Evaluating: -21.0312081-3.5
 Parameter: XMIN <- "-24.5312081"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-13.8747932"
Evaluating: -13.8747932-3.5
 Parameter: YMIN <- "-17.3747932"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "20.0051991"
Evaluating: 20.0051991-3.5
 Parameter: ZMIN <- "16.5051991"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-17.5312081"
 Parameter: XMIN -> "-24.5312081"
 Parameter: YMAX -> "-10.3747932"
 Parameter: YMIN -> "-17.3747932"
 Parameter: ZMAX -> "23.5051991"
 Parameter: ZMIN -> "16.5051991"
 SELRPN>      2 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      2 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
 5556 NEG      CL       7        CL      - 337 MEMB     DPPC     29       NC3           2.4402
 5556 NEG      CL       7        CL      - 469 MEMB     DPPC     40       NC3           2.8031
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "60"
Evaluating: 60
 Parameter: J <- "60"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "60" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "60"
 Parameter: NPOS -> "53"
Evaluating: 60-53
 Parameter: J <- "7"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "7"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.277502649"
Evaluating: 120.112447*(0.277502649-0.5)
 Parameter: XPOS <- "-26.7247013"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.372556302"
Evaluating: 120.112447*(0.372556302-0.5)
 Parameter: YPOS <- "-15.3075744"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.682430281"
Evaluating: 85*(0.682430281-0.5)+0
 Parameter: ZPOS <- "15.5065739"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "15.5065739" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "15.5065739" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -21.031208 XMAX =  -21.031208 XAVE =  -21.031208
    YMIN =  -13.874793 YMAX =  -13.874793 YAVE =  -13.874793
    ZMIN =   20.005199 ZMAX =   20.005199 ZAVE =   20.005199
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-26.7247013"
 RDCMND substituted energy or value "?XAVE" to "-21.0312081"
Evaluating: -26.7247013--21.0312081
 Parameter: XTRAN <- "-5.6934932"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-15.3075744"
 RDCMND substituted energy or value "?YAVE" to "-13.8747932"
Evaluating: -15.3075744--13.8747932
 Parameter: YTRAN <- "-1.4327812"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "15.5065739"
 RDCMND substituted energy or value "?ZAVE" to "20.0051991"
Evaluating: 15.5065739-20.0051991
 Parameter: ZTRAN <- "-4.4986252"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-5.6934932"
 Parameter: YTRAN -> "-1.4327812"
 Parameter: ZTRAN -> "-4.4986252"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    -5.693493   -1.432781   -4.498625
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.314561703"
Evaluating: 0.314561703*360.0
 Parameter: XPHI <- "113.242213"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.769614262"
Evaluating: 0.769614262*360.0
 Parameter: YPHI <- "277.061134"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.874015874"
Evaluating: 0.874015874*360.0
 Parameter: ZPHI <- "314.645715"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-26.7247013"
 Parameter: YPOS -> "-15.3075744"
 Parameter: ZPOS -> "15.5065739"
 Parameter: XPHI -> "113.242213"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.394619    0.918845
    0.000000   -0.918845   -0.394619

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  113.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-26.7247013"
 Parameter: YPOS -> "-15.3075744"
 Parameter: ZPOS -> "15.5065739"
 Parameter: YPHI -> "277.061134"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.122928    0.000000    0.992416
    0.000000    1.000000    0.000000
   -0.992416    0.000000    0.122928

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   82.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-26.7247013"
 Parameter: YPOS -> "-15.3075744"
 Parameter: ZPOS -> "15.5065739"
 Parameter: ZPHI -> "314.645715"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.702721   -0.711466    0.000000
    0.711466    0.702721    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   45.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -26.724701 XMAX =  -26.724701 XAVE =  -26.724701
    YMIN =  -15.307574 YMAX =  -15.307574 YAVE =  -15.307574
    ZMIN =   15.506574 ZMAX =   15.506574 ZAVE =   15.506574
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-26.7247013"
Evaluating: -26.7247013+3.5
 Parameter: XMAX <- "-23.2247013"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-15.3075744"
Evaluating: -15.3075744+3.5
 Parameter: YMAX <- "-11.8075744"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "15.5065739"
Evaluating: 15.5065739+3.5
 Parameter: ZMAX <- "19.0065739"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-26.7247013"
Evaluating: -26.7247013-3.5
 Parameter: XMIN <- "-30.2247013"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-15.3075744"
Evaluating: -15.3075744-3.5
 Parameter: YMIN <- "-18.8075744"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "15.5065739"
Evaluating: 15.5065739-3.5
 Parameter: ZMIN <- "12.0065739"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-23.2247013"
 Parameter: XMIN -> "-30.2247013"
 Parameter: YMAX -> "-11.8075744"
 Parameter: YMIN -> "-18.8075744"
 Parameter: ZMAX -> "19.0065739"
 Parameter: ZMIN -> "12.0065739"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      1 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "61"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "61" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "61"
Evaluating: 61
 Parameter: J <- "61"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "61" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "61"
 Parameter: NPOS -> "53"
Evaluating: 61-53
 Parameter: J <- "8"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "8"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.633144824"
Evaluating: 120.112447*(0.633144824-0.5)
 Parameter: XPOS <- "15.9923506"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "7.693485075E-03"
Evaluating: 120.112447*(7.693485075E-03-0.5)
 Parameter: YPOS <- "-59.1321402"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.467607226"
Evaluating: 85*(0.467607226-0.5)+0
 Parameter: ZPOS <- "-2.75338579"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-2.75338579" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-2.75338579" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "61"
Evaluating: 61
 Parameter: J <- "61"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "61" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "61"
 Parameter: NPOS -> "53"
Evaluating: 61-53
 Parameter: J <- "8"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "8"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.983755566"
Evaluating: 120.112447*(0.983755566-0.5)
 Parameter: XPOS <- "58.1050648"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.588331437"
Evaluating: 120.112447*(0.588331437-0.5)
 Parameter: YPOS <- "10.609705"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.57707031"
Evaluating: 85*(0.57707031-0.5)+0
 Parameter: ZPOS <- "6.55097635"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "6.55097635" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "6.55097635" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "61"
Evaluating: 61
 Parameter: J <- "61"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "61" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "61"
 Parameter: NPOS -> "53"
Evaluating: 61-53
 Parameter: J <- "8"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "8"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.951467836"
Evaluating: 120.112447*(0.951467836-0.5)
 Parameter: XPOS <- "54.2269065"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.443791947"
Evaluating: 120.112447*(0.443791947-0.5)
 Parameter: YPOS <- "-6.75128679"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.624762761"
Evaluating: 85*(0.624762761-0.5)+0
 Parameter: ZPOS <- "10.6048347"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "10.6048347" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "10.6048347" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "61"
Evaluating: 61
 Parameter: J <- "61"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "61" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "61"
 Parameter: NPOS -> "53"
Evaluating: 61-53
 Parameter: J <- "8"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "8"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.871296699"
Evaluating: 120.112447*(0.871296699-0.5)
 Parameter: XPOS <- "44.5973551"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.889560931"
Evaluating: 120.112447*(0.889560931-0.5)
 Parameter: YPOS <- "46.7911167"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.551328134"
Evaluating: 85*(0.551328134-0.5)+0
 Parameter: ZPOS <- "4.36289139"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "4.36289139" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "4.36289139" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "61"
Evaluating: 61
 Parameter: J <- "61"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "61" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "61"
 Parameter: NPOS -> "53"
Evaluating: 61-53
 Parameter: J <- "8"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "8"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "8.117977991E-02"
Evaluating: 120.112447*(8.117977991E-02-0.5)
 Parameter: XPOS <- "-50.3055215"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.353586447"
Evaluating: 120.112447*(0.353586447-0.5)
 Parameter: YPOS <- "-17.5860901"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.674993993"
Evaluating: 85*(0.674993993-0.5)+0
 Parameter: ZPOS <- "14.8744894"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "14.8744894" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "14.8744894" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "5"
Evaluating: 5+1
 Parameter: CNTRAND <- "6"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "6" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "61"
Evaluating: 61
 Parameter: J <- "61"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "61" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "61"
 Parameter: NPOS -> "53"
Evaluating: 61-53
 Parameter: J <- "8"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "8"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.387335967"
Evaluating: 120.112447*(0.387335967-0.5)
 Parameter: XPOS <- "-13.5323527"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.645805803"
Evaluating: 120.112447*(0.645805803-0.5)
 Parameter: YPOS <- "17.5130918"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.382689674"
Evaluating: 85*(0.382689674-0.5)+0
 Parameter: ZPOS <- "-9.97137771"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-9.97137771" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-9.97137771" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "6"
Evaluating: 6+1
 Parameter: CNTRAND <- "7"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "7" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "61"
Evaluating: 61
 Parameter: J <- "61"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "61" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "61"
 Parameter: NPOS -> "53"
Evaluating: 61-53
 Parameter: J <- "8"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "8"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.932186745"
Evaluating: 120.112447*(0.932186745-0.5)
 Parameter: XPOS <- "51.9110075"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.334120575"
Evaluating: 120.112447*(0.334120575-0.5)
 Parameter: YPOS <- "-19.9241836"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.106081384"
Evaluating: 85*(0.106081384-0.5)+0
 Parameter: ZPOS <- "-33.4830824"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-33.4830824" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "51.9110075"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 51.9110075-0
 Parameter: XTRAN <- "51.9110075"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-19.9241836"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -19.9241836-0
 Parameter: YTRAN <- "-19.9241836"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-33.4830824"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -33.4830824-0
 Parameter: ZTRAN <- "-33.4830824"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "51.9110075"
 Parameter: YTRAN -> "-19.9241836"
 Parameter: ZTRAN -> "-33.4830824"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    51.911007  -19.924184  -33.483082
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.587597883"
Evaluating: 0.587597883*360.0
 Parameter: XPHI <- "211.535238"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.239838688"
Evaluating: 0.239838688*360.0
 Parameter: YPHI <- "86.3419277"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.65985397"
Evaluating: 0.65985397*360.0
 Parameter: ZPHI <- "237.547429"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "51.9110075"
 Parameter: YPOS -> "-19.9241836"
 Parameter: ZPOS -> "-33.4830824"
 Parameter: XPHI -> "211.535238"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.852319   -0.523023
    0.000000    0.523023   -0.852319

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  148.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "51.9110075"
 Parameter: YPOS -> "-19.9241836"
 Parameter: ZPOS -> "-33.4830824"
 Parameter: YPHI -> "86.3419277"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.063802    0.000000   -0.997963
    0.000000    1.000000    0.000000
    0.997963    0.000000    0.063802

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   86.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "51.9110075"
 Parameter: YPOS -> "-19.9241836"
 Parameter: ZPOS -> "-33.4830824"
 Parameter: ZPHI -> "237.547429"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.536601   -0.843836    0.000000
    0.843836   -0.536601    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  122.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   51.911007 XMAX =   51.911007 XAVE =   51.911007
    YMIN =  -19.924184 YMAX =  -19.924184 YAVE =  -19.924184
    ZMIN =  -33.483082 ZMAX =  -33.483082 ZAVE =  -33.483082
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "51.9110075"
Evaluating: 51.9110075+3.5
 Parameter: XMAX <- "55.4110075"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-19.9241836"
Evaluating: -19.9241836+3.5
 Parameter: YMAX <- "-16.4241836"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-33.4830824"
Evaluating: -33.4830824+3.5
 Parameter: ZMAX <- "-29.9830824"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "51.9110075"
Evaluating: 51.9110075-3.5
 Parameter: XMIN <- "48.4110075"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-19.9241836"
Evaluating: -19.9241836-3.5
 Parameter: YMIN <- "-23.4241836"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-33.4830824"
Evaluating: -33.4830824-3.5
 Parameter: ZMIN <- "-36.9830824"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "55.4110075"
 Parameter: XMIN -> "48.4110075"
 Parameter: YMAX -> "-16.4241836"
 Parameter: YMIN -> "-23.4241836"
 Parameter: ZMAX -> "-29.9830824"
 Parameter: ZMIN -> "-36.9830824"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "62"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "62" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "62"
Evaluating: 62
 Parameter: J <- "62"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "62" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "62"
 Parameter: NPOS -> "53"
Evaluating: 62-53
 Parameter: J <- "9"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "9"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.880796569"
Evaluating: 120.112447*(0.880796569-0.5)
 Parameter: XPOS <- "45.7384077"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "7.393522357E-02"
Evaluating: 120.112447*(7.393522357E-02-0.5)
 Parameter: YPOS <- "-51.1756829"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.311676701"
Evaluating: 85*(0.311676701-0.5)+0
 Parameter: ZPOS <- "-16.0074804"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-16.0074804" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "45.7384077"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 45.7384077-0
 Parameter: XTRAN <- "45.7384077"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-51.1756829"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -51.1756829-0
 Parameter: YTRAN <- "-51.1756829"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-16.0074804"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -16.0074804-0
 Parameter: ZTRAN <- "-16.0074804"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "45.7384077"
 Parameter: YTRAN -> "-51.1756829"
 Parameter: ZTRAN -> "-16.0074804"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    45.738408  -51.175683  -16.007480
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.415027966"
Evaluating: 0.415027966*360.0
 Parameter: XPHI <- "149.410068"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.543291998"
Evaluating: 0.543291998*360.0
 Parameter: YPHI <- "195.585119"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.172499359"
Evaluating: 0.172499359*360.0
 Parameter: ZPHI <- "62.0997692"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "45.7384077"
 Parameter: YPOS -> "-51.1756829"
 Parameter: ZPOS -> "-16.0074804"
 Parameter: XPHI -> "149.410068"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.860831    0.508890
    0.000000   -0.508890   -0.860831

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  149.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "45.7384077"
 Parameter: YPOS -> "-51.1756829"
 Parameter: ZPOS -> "-16.0074804"
 Parameter: YPHI -> "195.585119"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.963232    0.000000    0.268670
    0.000000    1.000000    0.000000
   -0.268670    0.000000   -0.963232

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  164.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "45.7384077"
 Parameter: YPOS -> "-51.1756829"
 Parameter: ZPOS -> "-16.0074804"
 Parameter: ZPHI -> "62.0997692"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.467933    0.883764    0.000000
   -0.883764    0.467933    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   62.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   45.738408 XMAX =   45.738408 XAVE =   45.738408
    YMIN =  -51.175683 YMAX =  -51.175683 YAVE =  -51.175683
    ZMIN =  -16.007480 ZMAX =  -16.007480 ZAVE =  -16.007480
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "45.7384077"
Evaluating: 45.7384077+3.5
 Parameter: XMAX <- "49.2384077"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-51.1756829"
Evaluating: -51.1756829+3.5
 Parameter: YMAX <- "-47.6756829"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-16.0074804"
Evaluating: -16.0074804+3.5
 Parameter: ZMAX <- "-12.5074804"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "45.7384077"
Evaluating: 45.7384077-3.5
 Parameter: XMIN <- "42.2384077"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-51.1756829"
Evaluating: -51.1756829-3.5
 Parameter: YMIN <- "-54.6756829"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-16.0074804"
Evaluating: -16.0074804-3.5
 Parameter: ZMIN <- "-19.5074804"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "49.2384077"
 Parameter: XMIN -> "42.2384077"
 Parameter: YMAX -> "-47.6756829"
 Parameter: YMIN -> "-54.6756829"
 Parameter: ZMAX -> "-12.5074804"
 Parameter: ZMIN -> "-19.5074804"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      1 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
 5558 NEG      CL       9        CL      -5104 MEMB     DPPC     426      GL2           3.5403
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "62"
Evaluating: 62
 Parameter: J <- "62"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "62" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "62"
 Parameter: NPOS -> "53"
Evaluating: 62-53
 Parameter: J <- "9"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "9"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.81004409"
Evaluating: 120.112447*(0.81004409-0.5)
 Parameter: XPOS <- "37.2401543"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.742407816"
Evaluating: 120.112447*(0.742407816-0.5)
 Parameter: YPOS <- "29.116196"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.234484437"
Evaluating: 85*(0.234484437-0.5)+0
 Parameter: ZPOS <- "-22.5688229"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-22.5688229" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   45.738408 XMAX =   45.738408 XAVE =   45.738408
    YMIN =  -51.175683 YMAX =  -51.175683 YAVE =  -51.175683
    ZMIN =  -16.007480 ZMAX =  -16.007480 ZAVE =  -16.007480
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "37.2401543"
 RDCMND substituted energy or value "?XAVE" to "45.7384077"
Evaluating: 37.2401543-45.7384077
 Parameter: XTRAN <- "-8.4982534"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "29.116196"
 RDCMND substituted energy or value "?YAVE" to "-51.1756829"
Evaluating: 29.116196--51.1756829
 Parameter: YTRAN <- "80.2918789"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-22.5688229"
 RDCMND substituted energy or value "?ZAVE" to "-16.0074804"
Evaluating: -22.5688229--16.0074804
 Parameter: ZTRAN <- "-6.5613425"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-8.4982534"
 Parameter: YTRAN -> "80.2918789"
 Parameter: ZTRAN -> "-6.5613425"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    -8.498253   80.291879   -6.561343
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.149850942"
Evaluating: 0.149850942*360.0
 Parameter: XPHI <- "53.9463391"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.523039332"
Evaluating: 0.523039332*360.0
 Parameter: YPHI <- "188.29416"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.617731594"
Evaluating: 0.617731594*360.0
 Parameter: ZPHI <- "222.383374"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "37.2401543"
 Parameter: YPOS -> "29.116196"
 Parameter: ZPOS -> "-22.5688229"
 Parameter: XPHI -> "53.9463391"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.588543    0.808466
    0.000000   -0.808466    0.588543

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   53.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "37.2401543"
 Parameter: YPOS -> "29.116196"
 Parameter: ZPOS -> "-22.5688229"
 Parameter: YPHI -> "188.29416"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.989540    0.000000    0.144255
    0.000000    1.000000    0.000000
   -0.144255    0.000000   -0.989540

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  171.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "37.2401543"
 Parameter: YPOS -> "29.116196"
 Parameter: ZPOS -> "-22.5688229"
 Parameter: ZPHI -> "222.383374"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.738651   -0.674088    0.000000
    0.674088   -0.738651    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  137.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   37.240154 XMAX =   37.240154 XAVE =   37.240154
    YMIN =   29.116196 YMAX =   29.116196 YAVE =   29.116196
    ZMIN =  -22.568823 ZMAX =  -22.568823 ZAVE =  -22.568823
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "37.2401543"
Evaluating: 37.2401543+3.5
 Parameter: XMAX <- "40.7401543"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "29.116196"
Evaluating: 29.116196+3.5
 Parameter: YMAX <- "32.616196"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-22.5688229"
Evaluating: -22.5688229+3.5
 Parameter: ZMAX <- "-19.0688229"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "37.2401543"
Evaluating: 37.2401543-3.5
 Parameter: XMIN <- "33.7401543"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "29.116196"
Evaluating: 29.116196-3.5
 Parameter: YMIN <- "25.616196"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-22.5688229"
Evaluating: -22.5688229-3.5
 Parameter: ZMIN <- "-26.0688229"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "40.7401543"
 Parameter: XMIN -> "33.7401543"
 Parameter: YMAX -> "32.616196"
 Parameter: YMIN -> "25.616196"
 Parameter: ZMAX -> "-19.0688229"
 Parameter: ZMIN -> "-26.0688229"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      1 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "63"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "63" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "63"
Evaluating: 63
 Parameter: J <- "63"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "63" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "63"
 Parameter: NPOS -> "53"
Evaluating: 63-53
 Parameter: J <- "10"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "10"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.391451922"
Evaluating: 120.112447*(0.391451922-0.5)
 Parameter: XPOS <- "-13.0379753"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.914417278"
Evaluating: 120.112447*(0.914417278-0.5)
 Parameter: YPOS <- "49.7766733"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.772049317"
Evaluating: 85*(0.772049317-0.5)+0
 Parameter: ZPOS <- "23.1241919"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "23.1241919" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "23.1241919" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-13.0379753"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -13.0379753-0
 Parameter: XTRAN <- "-13.0379753"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "49.7766733"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 49.7766733-0
 Parameter: YTRAN <- "49.7766733"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "23.1241919"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 23.1241919-0
 Parameter: ZTRAN <- "23.1241919"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-13.0379753"
 Parameter: YTRAN -> "49.7766733"
 Parameter: ZTRAN -> "23.1241919"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR   -13.037975   49.776673   23.124192
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.291788715"
Evaluating: 0.291788715*360.0
 Parameter: XPHI <- "105.043937"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.741576337"
Evaluating: 0.741576337*360.0
 Parameter: YPHI <- "266.967481"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.596769614"
Evaluating: 0.596769614*360.0
 Parameter: ZPHI <- "214.837061"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-13.0379753"
 Parameter: YPOS -> "49.7766733"
 Parameter: ZPOS -> "23.1241919"
 Parameter: XPHI -> "105.043937"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.259560    0.965727
    0.000000   -0.965727   -0.259560

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  105.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-13.0379753"
 Parameter: YPOS -> "49.7766733"
 Parameter: ZPOS -> "23.1241919"
 Parameter: YPHI -> "266.967481"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.052903    0.000000    0.998600
    0.000000    1.000000    0.000000
   -0.998600    0.000000   -0.052903

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   93.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-13.0379753"
 Parameter: YPOS -> "49.7766733"
 Parameter: ZPOS -> "23.1241919"
 Parameter: ZPHI -> "214.837061"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.820780   -0.571245    0.000000
    0.571245   -0.820780    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  145.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -13.037975 XMAX =  -13.037975 XAVE =  -13.037975
    YMIN =   49.776673 YMAX =   49.776673 YAVE =   49.776673
    ZMIN =   23.124192 ZMAX =   23.124192 ZAVE =   23.124192
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-13.0379753"
Evaluating: -13.0379753+3.5
 Parameter: XMAX <- "-9.5379753"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "49.7766733"
Evaluating: 49.7766733+3.5
 Parameter: YMAX <- "53.2766733"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "23.1241919"
Evaluating: 23.1241919+3.5
 Parameter: ZMAX <- "26.6241919"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-13.0379753"
Evaluating: -13.0379753-3.5
 Parameter: XMIN <- "-16.5379753"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "49.7766733"
Evaluating: 49.7766733-3.5
 Parameter: YMIN <- "46.2766733"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "23.1241919"
Evaluating: 23.1241919-3.5
 Parameter: ZMIN <- "19.6241919"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-9.5379753"
 Parameter: XMIN -> "-16.5379753"
 Parameter: YMAX -> "53.2766733"
 Parameter: YMIN -> "46.2766733"
 Parameter: ZMAX -> "26.6241919"
 Parameter: ZMIN -> "19.6241919"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      1 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
 5559 NEG      CL       10       CL      -1729 MEMB     DPPC     145      NC3           3.6827
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "63"
Evaluating: 63
 Parameter: J <- "63"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "63" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "63"
 Parameter: NPOS -> "53"
Evaluating: 63-53
 Parameter: J <- "10"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "10"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "6.970170755E-02"
Evaluating: 120.112447*(6.970170755E-02-0.5)
 Parameter: XPOS <- "-51.6841808"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "2.867988736E-02"
Evaluating: 120.112447*(2.867988736E-02-0.5)
 Parameter: YPOS <- "-56.611412"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.513878105"
Evaluating: 85*(0.513878105-0.5)+0
 Parameter: ZPOS <- "1.17963892"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "1.17963892" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "1.17963892" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "63"
Evaluating: 63
 Parameter: J <- "63"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "63" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "63"
 Parameter: NPOS -> "53"
Evaluating: 63-53
 Parameter: J <- "10"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "10"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.739610321"
Evaluating: 120.112447*(0.739610321-0.5)
 Parameter: XPOS <- "28.780182"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "3.468111973E-02"
Evaluating: 120.112447*(3.468111973E-02-0.5)
 Parameter: YPOS <- "-55.8905893"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.592340006"
Evaluating: 85*(0.592340006-0.5)+0
 Parameter: ZPOS <- "7.84890051"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "7.84890051" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "7.84890051" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "63"
Evaluating: 63
 Parameter: J <- "63"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "63" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "63"
 Parameter: NPOS -> "53"
Evaluating: 63-53
 Parameter: J <- "10"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "10"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.42986434"
Evaluating: 120.112447*(0.42986434-0.5)
 Parameter: XPOS <- "-8.42416574"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.596532764"
Evaluating: 120.112447*(0.596532764-0.5)
 Parameter: YPOS <- "11.5947865"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "3.178483832E-02"
Evaluating: 85*(3.178483832E-02-0.5)+0
 Parameter: ZPOS <- "-39.7982887"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-39.7982887" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -13.037975 XMAX =  -13.037975 XAVE =  -13.037975
    YMIN =   49.776673 YMAX =   49.776673 YAVE =   49.776673
    ZMIN =   23.124192 ZMAX =   23.124192 ZAVE =   23.124192
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-8.42416574"
 RDCMND substituted energy or value "?XAVE" to "-13.0379753"
Evaluating: -8.42416574--13.0379753
 Parameter: XTRAN <- "4.61380956"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "11.5947865"
 RDCMND substituted energy or value "?YAVE" to "49.7766733"
Evaluating: 11.5947865-49.7766733
 Parameter: YTRAN <- "-38.1818868"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-39.7982887"
 RDCMND substituted energy or value "?ZAVE" to "23.1241919"
Evaluating: -39.7982887-23.1241919
 Parameter: ZTRAN <- "-62.9224806"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "4.61380956"
 Parameter: YTRAN -> "-38.1818868"
 Parameter: ZTRAN -> "-62.9224806"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR     4.613810  -38.181887  -62.922481
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.247845672"
Evaluating: 0.247845672*360.0
 Parameter: XPHI <- "89.2244419"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.638997434E-02"
Evaluating: 9.638997434E-02*360.0
 Parameter: YPHI <- "34.7003908"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.634264635"
Evaluating: 0.634264635*360.0
 Parameter: ZPHI <- "228.335269"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-8.42416574"
 Parameter: YPOS -> "11.5947865"
 Parameter: ZPOS -> "-39.7982887"
 Parameter: XPHI -> "89.2244419"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.013536    0.999908
    0.000000   -0.999908    0.013536

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   89.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-8.42416574"
 Parameter: YPOS -> "11.5947865"
 Parameter: ZPOS -> "-39.7982887"
 Parameter: YPHI -> "34.7003908"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.822140    0.000000   -0.569285
    0.000000    1.000000    0.000000
    0.569285    0.000000    0.822140

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   34.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-8.42416574"
 Parameter: YPOS -> "11.5947865"
 Parameter: ZPOS -> "-39.7982887"
 Parameter: ZPHI -> "228.335269"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.664771   -0.747048    0.000000
    0.747048   -0.664771    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  131.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -8.424166 XMAX =   -8.424166 XAVE =   -8.424166
    YMIN =   11.594786 YMAX =   11.594786 YAVE =   11.594786
    ZMIN =  -39.798289 ZMAX =  -39.798289 ZAVE =  -39.798289
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-8.42416574"
Evaluating: -8.42416574+3.5
 Parameter: XMAX <- "-4.92416574"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "11.5947865"
Evaluating: 11.5947865+3.5
 Parameter: YMAX <- "15.0947865"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-39.7982887"
Evaluating: -39.7982887+3.5
 Parameter: ZMAX <- "-36.2982887"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-8.42416574"
Evaluating: -8.42416574-3.5
 Parameter: XMIN <- "-11.9241657"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "11.5947865"
Evaluating: 11.5947865-3.5
 Parameter: YMIN <- "8.0947865"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-39.7982887"
Evaluating: -39.7982887-3.5
 Parameter: ZMIN <- "-43.2982887"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-4.92416574"
 Parameter: XMIN -> "-11.9241657"
 Parameter: YMAX -> "15.0947865"
 Parameter: YMIN -> "8.0947865"
 Parameter: ZMAX -> "-36.2982887"
 Parameter: ZMIN -> "-43.2982887"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "64"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "64" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "64"
Evaluating: 64
 Parameter: J <- "64"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "64" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "64"
 Parameter: NPOS -> "53"
Evaluating: 64-53
 Parameter: J <- "11"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "11"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.28842753"
Evaluating: 120.112447*(0.28842753-0.5)
 Parameter: XPOS <- "-25.4124871"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.259579381"
Evaluating: 120.112447*(0.259579381-0.5)
 Parameter: YPOS <- "-28.8775089"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "2.322737453E-02"
Evaluating: 85*(2.322737453E-02-0.5)+0
 Parameter: ZPOS <- "-40.5256732"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-40.5256732" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-25.4124871"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -25.4124871-0
 Parameter: XTRAN <- "-25.4124871"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-28.8775089"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -28.8775089-0
 Parameter: YTRAN <- "-28.8775089"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-40.5256732"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -40.5256732-0
 Parameter: ZTRAN <- "-40.5256732"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-25.4124871"
 Parameter: YTRAN -> "-28.8775089"
 Parameter: ZTRAN -> "-40.5256732"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR   -25.412487  -28.877509  -40.525673
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.57650007"
Evaluating: 0.57650007*360.0
 Parameter: XPHI <- "207.540025"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.597371708"
Evaluating: 0.597371708*360.0
 Parameter: YPHI <- "215.053815"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.392502045"
Evaluating: 0.392502045*360.0
 Parameter: ZPHI <- "141.300736"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-25.4124871"
 Parameter: YPOS -> "-28.8775089"
 Parameter: ZPOS -> "-40.5256732"
 Parameter: XPHI -> "207.540025"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.886688   -0.462368
    0.000000    0.462368   -0.886688

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  152.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-25.4124871"
 Parameter: YPOS -> "-28.8775089"
 Parameter: ZPOS -> "-40.5256732"
 Parameter: YPHI -> "215.053815"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.818613    0.000000    0.574346
    0.000000    1.000000    0.000000
   -0.574346    0.000000   -0.818613

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  144.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-25.4124871"
 Parameter: YPOS -> "-28.8775089"
 Parameter: ZPOS -> "-40.5256732"
 Parameter: ZPHI -> "141.300736"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.780438    0.625233    0.000000
   -0.625233   -0.780438    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  141.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -25.412487 XMAX =  -25.412487 XAVE =  -25.412487
    YMIN =  -28.877509 YMAX =  -28.877509 YAVE =  -28.877509
    ZMIN =  -40.525673 ZMAX =  -40.525673 ZAVE =  -40.525673
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-25.4124871"
Evaluating: -25.4124871+3.5
 Parameter: XMAX <- "-21.9124871"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-28.8775089"
Evaluating: -28.8775089+3.5
 Parameter: YMAX <- "-25.3775089"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-40.5256732"
Evaluating: -40.5256732+3.5
 Parameter: ZMAX <- "-37.0256732"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-25.4124871"
Evaluating: -25.4124871-3.5
 Parameter: XMIN <- "-28.9124871"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-28.8775089"
Evaluating: -28.8775089-3.5
 Parameter: YMIN <- "-32.3775089"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-40.5256732"
Evaluating: -40.5256732-3.5
 Parameter: ZMIN <- "-44.0256732"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-21.9124871"
 Parameter: XMIN -> "-28.9124871"
 Parameter: YMAX -> "-25.3775089"
 Parameter: YMIN -> "-32.3775089"
 Parameter: ZMAX -> "-37.0256732"
 Parameter: ZMIN -> "-44.0256732"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "65"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "65" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "65"
Evaluating: 65
 Parameter: J <- "65"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "65" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "65"
 Parameter: NPOS -> "53"
Evaluating: 65-53
 Parameter: J <- "12"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "12"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.802164766"
Evaluating: 120.112447*(0.802164766-0.5)
 Parameter: XPOS <- "36.2937494"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.836256512"
Evaluating: 120.112447*(0.836256512-0.5)
 Parameter: YPOS <- "40.3885925"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.204405041"
Evaluating: 85*(0.204405041-0.5)+0
 Parameter: ZPOS <- "-25.1255715"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-25.1255715" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "36.2937494"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 36.2937494-0
 Parameter: XTRAN <- "36.2937494"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "40.3885925"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 40.3885925-0
 Parameter: YTRAN <- "40.3885925"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-25.1255715"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -25.1255715-0
 Parameter: ZTRAN <- "-25.1255715"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "36.2937494"
 Parameter: YTRAN -> "40.3885925"
 Parameter: ZTRAN -> "-25.1255715"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    36.293749   40.388593  -25.125571
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.641077717"
Evaluating: 0.641077717*360.0
 Parameter: XPHI <- "230.787978"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.367032724"
Evaluating: 0.367032724*360.0
 Parameter: YPHI <- "132.131781"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.340093538"
Evaluating: 0.340093538*360.0
 Parameter: ZPHI <- "122.433674"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "36.2937494"
 Parameter: YPOS -> "40.3885925"
 Parameter: ZPOS -> "-25.1255715"
 Parameter: XPHI -> "230.787978"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.632192   -0.774812
    0.000000    0.774812   -0.632192

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  129.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "36.2937494"
 Parameter: YPOS -> "40.3885925"
 Parameter: ZPOS -> "-25.1255715"
 Parameter: YPHI -> "132.131781"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.670838    0.000000   -0.741604
    0.000000    1.000000    0.000000
    0.741604    0.000000   -0.670838

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  132.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "36.2937494"
 Parameter: YPOS -> "40.3885925"
 Parameter: ZPOS -> "-25.1255715"
 Parameter: ZPHI -> "122.433674"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.536323    0.844013    0.000000
   -0.844013   -0.536323    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  122.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   36.293749 XMAX =   36.293749 XAVE =   36.293749
    YMIN =   40.388593 YMAX =   40.388593 YAVE =   40.388593
    ZMIN =  -25.125571 ZMAX =  -25.125571 ZAVE =  -25.125571
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "36.2937494"
Evaluating: 36.2937494+3.5
 Parameter: XMAX <- "39.7937494"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "40.3885925"
Evaluating: 40.3885925+3.5
 Parameter: YMAX <- "43.8885925"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-25.1255715"
Evaluating: -25.1255715+3.5
 Parameter: ZMAX <- "-21.6255715"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "36.2937494"
Evaluating: 36.2937494-3.5
 Parameter: XMIN <- "32.7937494"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "40.3885925"
Evaluating: 40.3885925-3.5
 Parameter: YMIN <- "36.8885925"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-25.1255715"
Evaluating: -25.1255715-3.5
 Parameter: ZMIN <- "-28.6255715"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "39.7937494"
 Parameter: XMIN -> "32.7937494"
 Parameter: YMAX -> "43.8885925"
 Parameter: YMIN -> "36.8885925"
 Parameter: ZMAX -> "-21.6255715"
 Parameter: ZMIN -> "-28.6255715"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "66"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "66" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "66"
Evaluating: 66
 Parameter: J <- "66"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "66" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "66"
 Parameter: NPOS -> "53"
Evaluating: 66-53
 Parameter: J <- "13"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "13"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.166850737"
Evaluating: 120.112447*(0.166850737-0.5)
 Parameter: XPOS <- "-40.0153732"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.429211747"
Evaluating: 120.112447*(0.429211747-0.5)
 Parameter: YPOS <- "-8.50255029"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.621262701"
Evaluating: 85*(0.621262701-0.5)+0
 Parameter: ZPOS <- "10.3073296"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "10.3073296" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "10.3073296" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "66"
Evaluating: 66
 Parameter: J <- "66"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "66" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "66"
 Parameter: NPOS -> "53"
Evaluating: 66-53
 Parameter: J <- "13"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "13"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.169236355"
Evaluating: 120.112447*(0.169236355-0.5)
 Parameter: XPOS <- "-39.7288308"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.494774528"
Evaluating: 120.112447*(0.494774528-0.5)
 Parameter: YPOS <- "-0.627644229"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.207476595"
Evaluating: 85*(0.207476595-0.5)+0
 Parameter: ZPOS <- "-24.8644894"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-24.8644894" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-39.7288308"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -39.7288308-0
 Parameter: XTRAN <- "-39.7288308"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-0.627644229"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -0.627644229-0
 Parameter: YTRAN <- "-0.627644229"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-24.8644894"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -24.8644894-0
 Parameter: ZTRAN <- "-24.8644894"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-39.7288308"
 Parameter: YTRAN -> "-0.627644229"
 Parameter: ZTRAN -> "-24.8644894"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR   -39.728831   -0.627644  -24.864489
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.891209964"
Evaluating: 0.891209964*360.0
 Parameter: XPHI <- "320.835587"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.561491452"
Evaluating: 0.561491452*360.0
 Parameter: YPHI <- "202.136923"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.11782148E-02"
Evaluating: 5.11782148E-02*360.0
 Parameter: ZPHI <- "18.4241573"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-39.7288308"
 Parameter: YPOS -> "-0.627644229"
 Parameter: ZPOS -> "-24.8644894"
 Parameter: XPHI -> "320.835587"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.775337   -0.631548
    0.000000    0.631548    0.775337

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   39.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-39.7288308"
 Parameter: YPOS -> "-0.627644229"
 Parameter: ZPOS -> "-24.8644894"
 Parameter: YPHI -> "202.136923"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.926286    0.000000    0.376821
    0.000000    1.000000    0.000000
   -0.376821    0.000000   -0.926286

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  157.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-39.7288308"
 Parameter: YPOS -> "-0.627644229"
 Parameter: ZPOS -> "-24.8644894"
 Parameter: ZPHI -> "18.4241573"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.948743    0.316049    0.000000
   -0.316049    0.948743    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   18.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -39.728831 XMAX =  -39.728831 XAVE =  -39.728831
    YMIN =   -0.627644 YMAX =   -0.627644 YAVE =   -0.627644
    ZMIN =  -24.864489 ZMAX =  -24.864489 ZAVE =  -24.864489
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-39.7288308"
Evaluating: -39.7288308+3.5
 Parameter: XMAX <- "-36.2288308"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-0.627644229"
Evaluating: -0.627644229+3.5
 Parameter: YMAX <- "2.87235577"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-24.8644894"
Evaluating: -24.8644894+3.5
 Parameter: ZMAX <- "-21.3644894"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-39.7288308"
Evaluating: -39.7288308-3.5
 Parameter: XMIN <- "-43.2288308"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-0.627644229"
Evaluating: -0.627644229-3.5
 Parameter: YMIN <- "-4.12764423"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-24.8644894"
Evaluating: -24.8644894-3.5
 Parameter: ZMIN <- "-28.3644894"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-36.2288308"
 Parameter: XMIN -> "-43.2288308"
 Parameter: YMAX -> "2.87235577"
 Parameter: YMIN -> "-4.12764423"
 Parameter: ZMAX -> "-21.3644894"
 Parameter: ZMIN -> "-28.3644894"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "67"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "67" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "67"
Evaluating: 67
 Parameter: J <- "67"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "67" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "67"
 Parameter: NPOS -> "53"
Evaluating: 67-53
 Parameter: J <- "14"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "14"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "2.466641657E-02"
Evaluating: 120.112447*(2.466641657E-02-0.5)
 Parameter: XPOS <- "-57.0934798"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.84892836"
Evaluating: 120.112447*(0.84892836-0.5)
 Parameter: YPOS <- "41.9106391"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.610355655"
Evaluating: 85*(0.610355655-0.5)+0
 Parameter: ZPOS <- "9.38023067"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "9.38023067" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "9.38023067" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "67"
Evaluating: 67
 Parameter: J <- "67"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "67" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "67"
 Parameter: NPOS -> "53"
Evaluating: 67-53
 Parameter: J <- "14"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "14"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "5.085125594E-02"
Evaluating: 120.112447*(5.085125594E-02-0.5)
 Parameter: XPOS <- "-53.9483547"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.665429163"
Evaluating: 120.112447*(0.665429163-0.5)
 Parameter: YPOS <- "19.8701016"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.108823319"
Evaluating: 85*(0.108823319-0.5)+0
 Parameter: ZPOS <- "-33.2500179"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-33.2500179" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-53.9483547"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -53.9483547-0
 Parameter: XTRAN <- "-53.9483547"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "19.8701016"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 19.8701016-0
 Parameter: YTRAN <- "19.8701016"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-33.2500179"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -33.2500179-0
 Parameter: ZTRAN <- "-33.2500179"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-53.9483547"
 Parameter: YTRAN -> "19.8701016"
 Parameter: ZTRAN -> "-33.2500179"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR   -53.948355   19.870102  -33.250018
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.423000147"
Evaluating: 0.423000147*360.0
 Parameter: XPHI <- "152.280053"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.104749476E-02"
Evaluating: 3.104749476E-02*360.0
 Parameter: YPHI <- "11.1770981"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.128581963E-02"
Evaluating: 1.128581963E-02*360.0
 Parameter: ZPHI <- "4.06289507"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-53.9483547"
 Parameter: YPOS -> "19.8701016"
 Parameter: ZPOS -> "-33.2500179"
 Parameter: XPHI -> "152.280053"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.885232    0.465150
    0.000000   -0.465150   -0.885232

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  152.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-53.9483547"
 Parameter: YPOS -> "19.8701016"
 Parameter: ZPOS -> "-33.2500179"
 Parameter: YPHI -> "11.1770981"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.981033    0.000000   -0.193842
    0.000000    1.000000    0.000000
    0.193842    0.000000    0.981033

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   11.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-53.9483547"
 Parameter: YPOS -> "19.8701016"
 Parameter: ZPOS -> "-33.2500179"
 Parameter: ZPHI -> "4.06289507"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.997487    0.070851    0.000000
   -0.070851    0.997487    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    4.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -53.948355 XMAX =  -53.948355 XAVE =  -53.948355
    YMIN =   19.870102 YMAX =   19.870102 YAVE =   19.870102
    ZMIN =  -33.250018 ZMAX =  -33.250018 ZAVE =  -33.250018
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-53.9483547"
Evaluating: -53.9483547+3.5
 Parameter: XMAX <- "-50.4483547"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "19.8701016"
Evaluating: 19.8701016+3.5
 Parameter: YMAX <- "23.3701016"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-33.2500179"
Evaluating: -33.2500179+3.5
 Parameter: ZMAX <- "-29.7500179"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-53.9483547"
Evaluating: -53.9483547-3.5
 Parameter: XMIN <- "-57.4483547"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "19.8701016"
Evaluating: 19.8701016-3.5
 Parameter: YMIN <- "16.3701016"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-33.2500179"
Evaluating: -33.2500179-3.5
 Parameter: ZMIN <- "-36.7500179"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-50.4483547"
 Parameter: XMIN -> "-57.4483547"
 Parameter: YMAX -> "23.3701016"
 Parameter: YMIN -> "16.3701016"
 Parameter: ZMAX -> "-29.7500179"
 Parameter: ZMIN -> "-36.7500179"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "68"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "68" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "68"
Evaluating: 68
 Parameter: J <- "68"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "68" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "68"
 Parameter: NPOS -> "53"
Evaluating: 68-53
 Parameter: J <- "15"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "15"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.890911232"
Evaluating: 120.112447*(0.890911232-0.5)
 Parameter: XPOS <- "46.9533046"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.426602243"
Evaluating: 120.112447*(0.426602243-0.5)
 Parameter: YPOS <- "-8.8159842"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.419078761"
Evaluating: 85*(0.419078761-0.5)+0
 Parameter: ZPOS <- "-6.87830532"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-6.87830532" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-6.87830532" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "68"
Evaluating: 68
 Parameter: J <- "68"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "68" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "68"
 Parameter: NPOS -> "53"
Evaluating: 68-53
 Parameter: J <- "15"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "15"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.93431407"
Evaluating: 120.112447*(0.93431407-0.5)
 Parameter: XPOS <- "52.1665257"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.260043141"
Evaluating: 120.112447*(0.260043141-0.5)
 Parameter: YPOS <- "-28.8218055"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "4.149094011E-02"
Evaluating: 85*(4.149094011E-02-0.5)+0
 Parameter: ZPOS <- "-38.9732701"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-38.9732701" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "52.1665257"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 52.1665257-0
 Parameter: XTRAN <- "52.1665257"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-28.8218055"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -28.8218055-0
 Parameter: YTRAN <- "-28.8218055"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-38.9732701"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -38.9732701-0
 Parameter: ZTRAN <- "-38.9732701"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "52.1665257"
 Parameter: YTRAN -> "-28.8218055"
 Parameter: ZTRAN -> "-38.9732701"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    52.166526  -28.821805  -38.973270
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.581126127"
Evaluating: 0.581126127*360.0
 Parameter: XPHI <- "209.205406"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.89108401E-02"
Evaluating: 7.89108401E-02*360.0
 Parameter: YPHI <- "28.4079024"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.971306164"
Evaluating: 0.971306164*360.0
 Parameter: ZPHI <- "349.670219"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "52.1665257"
 Parameter: YPOS -> "-28.8218055"
 Parameter: ZPOS -> "-38.9732701"
 Parameter: XPHI -> "209.205406"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.872876   -0.487942
    0.000000    0.487942   -0.872876

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  150.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "52.1665257"
 Parameter: YPOS -> "-28.8218055"
 Parameter: ZPOS -> "-38.9732701"
 Parameter: YPHI -> "28.4079024"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.879583    0.000000   -0.475746
    0.000000    1.000000    0.000000
    0.475746    0.000000    0.879583

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   28.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "52.1665257"
 Parameter: YPOS -> "-28.8218055"
 Parameter: ZPOS -> "-38.9732701"
 Parameter: ZPHI -> "349.670219"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.983792   -0.179314    0.000000
    0.179314    0.983792    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   10.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   52.166526 XMAX =   52.166526 XAVE =   52.166526
    YMIN =  -28.821805 YMAX =  -28.821805 YAVE =  -28.821805
    ZMIN =  -38.973270 ZMAX =  -38.973270 ZAVE =  -38.973270
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "52.1665257"
Evaluating: 52.1665257+3.5
 Parameter: XMAX <- "55.6665257"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-28.8218055"
Evaluating: -28.8218055+3.5
 Parameter: YMAX <- "-25.3218055"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-38.9732701"
Evaluating: -38.9732701+3.5
 Parameter: ZMAX <- "-35.4732701"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "52.1665257"
Evaluating: 52.1665257-3.5
 Parameter: XMIN <- "48.6665257"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-28.8218055"
Evaluating: -28.8218055-3.5
 Parameter: YMIN <- "-32.3218055"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-38.9732701"
Evaluating: -38.9732701-3.5
 Parameter: ZMIN <- "-42.4732701"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "55.6665257"
 Parameter: XMIN -> "48.6665257"
 Parameter: YMAX -> "-25.3218055"
 Parameter: YMIN -> "-32.3218055"
 Parameter: ZMAX -> "-35.4732701"
 Parameter: ZMIN -> "-42.4732701"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "69"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "69" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "69"
Evaluating: 69
 Parameter: J <- "69"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "69" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "69"
 Parameter: NPOS -> "53"
Evaluating: 69-53
 Parameter: J <- "16"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "16"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.672089977"
Evaluating: 120.112447*(0.672089977-0.5)
 Parameter: XPOS <- "20.6701482"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "8.981147534E-02"
Evaluating: 120.112447*(8.981147534E-02-0.5)
 Parameter: YPOS <- "-49.2687474"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.95272787"
Evaluating: 85*(0.95272787-0.5)+0
 Parameter: ZPOS <- "38.4818689"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "38.4818689" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "38.4818689" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "20.6701482"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 20.6701482-0
 Parameter: XTRAN <- "20.6701482"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-49.2687474"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -49.2687474-0
 Parameter: YTRAN <- "-49.2687474"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "38.4818689"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 38.4818689-0
 Parameter: ZTRAN <- "38.4818689"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "20.6701482"
 Parameter: YTRAN -> "-49.2687474"
 Parameter: ZTRAN -> "38.4818689"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    20.670148  -49.268747   38.481869
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.87245359"
Evaluating: 0.87245359*360.0
 Parameter: XPHI <- "314.083292"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.531090491"
Evaluating: 0.531090491*360.0
 Parameter: YPHI <- "191.192577"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.866239316"
Evaluating: 0.866239316*360.0
 Parameter: ZPHI <- "311.846154"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "20.6701482"
 Parameter: YPOS -> "-49.2687474"
 Parameter: ZPOS -> "38.4818689"
 Parameter: XPHI -> "314.083292"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.695703   -0.718329
    0.000000    0.718329    0.695703

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   45.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "20.6701482"
 Parameter: YPOS -> "-49.2687474"
 Parameter: ZPOS -> "38.4818689"
 Parameter: YPHI -> "191.192577"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.980980    0.000000    0.194107
    0.000000    1.000000    0.000000
   -0.194107    0.000000   -0.980980

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  168.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "20.6701482"
 Parameter: YPOS -> "-49.2687474"
 Parameter: ZPOS -> "38.4818689"
 Parameter: ZPHI -> "311.846154"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.667133   -0.744939    0.000000
    0.744939    0.667133    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   48.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   20.670148 XMAX =   20.670148 XAVE =   20.670148
    YMIN =  -49.268747 YMAX =  -49.268747 YAVE =  -49.268747
    ZMIN =   38.481869 ZMAX =   38.481869 ZAVE =   38.481869
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "20.6701482"
Evaluating: 20.6701482+3.5
 Parameter: XMAX <- "24.1701482"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-49.2687474"
Evaluating: -49.2687474+3.5
 Parameter: YMAX <- "-45.7687474"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "38.4818689"
Evaluating: 38.4818689+3.5
 Parameter: ZMAX <- "41.9818689"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "20.6701482"
Evaluating: 20.6701482-3.5
 Parameter: XMIN <- "17.1701482"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-49.2687474"
Evaluating: -49.2687474-3.5
 Parameter: YMIN <- "-52.7687474"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "38.4818689"
Evaluating: 38.4818689-3.5
 Parameter: ZMIN <- "34.9818689"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "24.1701482"
 Parameter: XMIN -> "17.1701482"
 Parameter: YMAX -> "-45.7687474"
 Parameter: YMIN -> "-52.7687474"
 Parameter: ZMAX -> "41.9818689"
 Parameter: ZMIN -> "34.9818689"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "70"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "70" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "70"
Evaluating: 70
 Parameter: J <- "70"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "70" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "70"
 Parameter: NPOS -> "53"
Evaluating: 70-53
 Parameter: J <- "17"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "17"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "7.346636358E-02"
Evaluating: 120.112447*(7.346636358E-02-0.5)
 Parameter: XPOS <- "-51.2319988"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.935149601"
Evaluating: 120.112447*(0.935149601-0.5)
 Parameter: YPOS <- "52.2668834"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.661296873"
Evaluating: 85*(0.661296873-0.5)+0
 Parameter: ZPOS <- "13.7102342"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "13.7102342" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "13.7102342" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "70"
Evaluating: 70
 Parameter: J <- "70"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "70" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "70"
 Parameter: NPOS -> "53"
Evaluating: 70-53
 Parameter: J <- "17"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "17"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.68717779"
Evaluating: 120.112447*(0.68717779-0.5)
 Parameter: XPOS <- "22.4823824"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.747075934"
Evaluating: 120.112447*(0.747075934-0.5)
 Parameter: YPOS <- "29.676895"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.961451212"
Evaluating: 85*(0.961451212-0.5)+0
 Parameter: ZPOS <- "39.223353"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "39.223353" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "39.223353" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "22.4823824"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 22.4823824-0
 Parameter: XTRAN <- "22.4823824"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "29.676895"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 29.676895-0
 Parameter: YTRAN <- "29.676895"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "39.223353"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 39.223353-0
 Parameter: ZTRAN <- "39.223353"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "22.4823824"
 Parameter: YTRAN -> "29.676895"
 Parameter: ZTRAN -> "39.223353"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    22.482382   29.676895   39.223353
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.315177349E-02"
Evaluating: 8.315177349E-02*360.0
 Parameter: XPHI <- "29.9346385"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.082151809E-02"
Evaluating: 9.082151809E-02*360.0
 Parameter: YPHI <- "32.6957465"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.947355942"
Evaluating: 0.947355942*360.0
 Parameter: ZPHI <- "341.048139"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "22.4823824"
 Parameter: YPOS -> "29.676895"
 Parameter: ZPOS -> "39.223353"
 Parameter: XPHI -> "29.9346385"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.866595    0.499012
    0.000000   -0.499012    0.866595

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   29.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "22.4823824"
 Parameter: YPOS -> "29.676895"
 Parameter: ZPOS -> "39.223353"
 Parameter: YPHI -> "32.6957465"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.841551    0.000000   -0.540178
    0.000000    1.000000    0.000000
    0.540178    0.000000    0.841551

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   32.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "22.4823824"
 Parameter: YPOS -> "29.676895"
 Parameter: ZPOS -> "39.223353"
 Parameter: ZPHI -> "341.048139"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.945792   -0.324774    0.000000
    0.324774    0.945792    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   18.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   22.482382 XMAX =   22.482382 XAVE =   22.482382
    YMIN =   29.676895 YMAX =   29.676895 YAVE =   29.676895
    ZMIN =   39.223353 ZMAX =   39.223353 ZAVE =   39.223353
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "22.4823824"
Evaluating: 22.4823824+3.5
 Parameter: XMAX <- "25.9823824"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "29.676895"
Evaluating: 29.676895+3.5
 Parameter: YMAX <- "33.176895"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "39.223353"
Evaluating: 39.223353+3.5
 Parameter: ZMAX <- "42.723353"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "22.4823824"
Evaluating: 22.4823824-3.5
 Parameter: XMIN <- "18.9823824"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "29.676895"
Evaluating: 29.676895-3.5
 Parameter: YMIN <- "26.176895"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "39.223353"
Evaluating: 39.223353-3.5
 Parameter: ZMIN <- "35.723353"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "25.9823824"
 Parameter: XMIN -> "18.9823824"
 Parameter: YMAX -> "33.176895"
 Parameter: YMIN -> "26.176895"
 Parameter: ZMAX -> "42.723353"
 Parameter: ZMIN -> "35.723353"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "71"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "71" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "71"
Evaluating: 71
 Parameter: J <- "71"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "71" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "71"
 Parameter: NPOS -> "53"
Evaluating: 71-53
 Parameter: J <- "18"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "18"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.579367358"
Evaluating: 120.112447*(0.579367358-0.5)
 Parameter: XPOS <- "9.53300758"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.985148443"
Evaluating: 120.112447*(0.985148443-0.5)
 Parameter: YPOS <- "58.2723666"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.109194621"
Evaluating: 85*(0.109194621-0.5)+0
 Parameter: ZPOS <- "-33.2184572"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-33.2184572" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "9.53300758"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 9.53300758-0
 Parameter: XTRAN <- "9.53300758"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "58.2723666"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 58.2723666-0
 Parameter: YTRAN <- "58.2723666"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-33.2184572"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -33.2184572-0
 Parameter: ZTRAN <- "-33.2184572"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "9.53300758"
 Parameter: YTRAN -> "58.2723666"
 Parameter: ZTRAN -> "-33.2184572"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR     9.533008   58.272367  -33.218457
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.386683714"
Evaluating: 0.386683714*360.0
 Parameter: XPHI <- "139.206137"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.242275141"
Evaluating: 0.242275141*360.0
 Parameter: YPHI <- "87.2190508"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.884504077"
Evaluating: 0.884504077*360.0
 Parameter: ZPHI <- "318.421468"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "9.53300758"
 Parameter: YPOS -> "58.2723666"
 Parameter: ZPOS -> "-33.2184572"
 Parameter: XPHI -> "139.206137"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.757065    0.653340
    0.000000   -0.653340   -0.757065

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  139.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "9.53300758"
 Parameter: YPOS -> "58.2723666"
 Parameter: ZPOS -> "-33.2184572"
 Parameter: YPHI -> "87.2190508"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.048518    0.000000   -0.998822
    0.000000    1.000000    0.000000
    0.998822    0.000000    0.048518

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   87.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "9.53300758"
 Parameter: YPOS -> "58.2723666"
 Parameter: ZPOS -> "-33.2184572"
 Parameter: ZPHI -> "318.421468"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.748047   -0.663646    0.000000
    0.663646    0.748047    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   41.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    9.533008 XMAX =    9.533008 XAVE =    9.533008
    YMIN =   58.272367 YMAX =   58.272367 YAVE =   58.272367
    ZMIN =  -33.218457 ZMAX =  -33.218457 ZAVE =  -33.218457
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "9.53300758"
Evaluating: 9.53300758+3.5
 Parameter: XMAX <- "13.0330076"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "58.2723666"
Evaluating: 58.2723666+3.5
 Parameter: YMAX <- "61.7723666"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-33.2184572"
Evaluating: -33.2184572+3.5
 Parameter: ZMAX <- "-29.7184572"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "9.53300758"
Evaluating: 9.53300758-3.5
 Parameter: XMIN <- "6.03300758"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "58.2723666"
Evaluating: 58.2723666-3.5
 Parameter: YMIN <- "54.7723666"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-33.2184572"
Evaluating: -33.2184572-3.5
 Parameter: ZMIN <- "-36.7184572"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "13.0330076"
 Parameter: XMIN -> "6.03300758"
 Parameter: YMAX -> "61.7723666"
 Parameter: YMIN -> "54.7723666"
 Parameter: ZMAX -> "-29.7184572"
 Parameter: ZMIN -> "-36.7184572"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "72"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "72" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "72"
Evaluating: 72
 Parameter: J <- "72"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "72" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "72"
 Parameter: NPOS -> "53"
Evaluating: 72-53
 Parameter: J <- "19"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "19"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.543997415"
Evaluating: 120.112447*(0.543997415-0.5)
 Parameter: XPOS <- "5.28463718"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.323528477"
Evaluating: 120.112447*(0.323528477-0.5)
 Parameter: YPOS <- "-21.1964265"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "7.467146289E-02"
Evaluating: 85*(7.467146289E-02-0.5)+0
 Parameter: ZPOS <- "-36.1529257"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-36.1529257" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "5.28463718"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 5.28463718-0
 Parameter: XTRAN <- "5.28463718"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-21.1964265"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -21.1964265-0
 Parameter: YTRAN <- "-21.1964265"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-36.1529257"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -36.1529257-0
 Parameter: ZTRAN <- "-36.1529257"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "5.28463718"
 Parameter: YTRAN -> "-21.1964265"
 Parameter: ZTRAN -> "-36.1529257"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR     5.284637  -21.196427  -36.152926
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.125648924"
Evaluating: 0.125648924*360.0
 Parameter: XPHI <- "45.2336126"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.434478014"
Evaluating: 0.434478014*360.0
 Parameter: YPHI <- "156.412085"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.92079189E-02"
Evaluating: 6.92079189E-02*360.0
 Parameter: ZPHI <- "24.9148508"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "5.28463718"
 Parameter: YPOS -> "-21.1964265"
 Parameter: ZPOS -> "-36.1529257"
 Parameter: XPHI -> "45.2336126"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.704218    0.709984
    0.000000   -0.709984    0.704218

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   45.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "5.28463718"
 Parameter: YPOS -> "-21.1964265"
 Parameter: ZPOS -> "-36.1529257"
 Parameter: YPHI -> "156.412085"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.916447    0.000000   -0.400156
    0.000000    1.000000    0.000000
    0.400156    0.000000   -0.916447

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  156.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "5.28463718"
 Parameter: YPOS -> "-21.1964265"
 Parameter: ZPOS -> "-36.1529257"
 Parameter: ZPHI -> "24.9148508"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.906935    0.421271    0.000000
   -0.421271    0.906935    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   24.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    5.284637 XMAX =    5.284637 XAVE =    5.284637
    YMIN =  -21.196427 YMAX =  -21.196427 YAVE =  -21.196427
    ZMIN =  -36.152926 ZMAX =  -36.152926 ZAVE =  -36.152926
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "5.28463718"
Evaluating: 5.28463718+3.5
 Parameter: XMAX <- "8.78463718"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-21.1964265"
Evaluating: -21.1964265+3.5
 Parameter: YMAX <- "-17.6964265"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-36.1529257"
Evaluating: -36.1529257+3.5
 Parameter: ZMAX <- "-32.6529257"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "5.28463718"
Evaluating: 5.28463718-3.5
 Parameter: XMIN <- "1.78463718"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-21.1964265"
Evaluating: -21.1964265-3.5
 Parameter: YMIN <- "-24.6964265"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-36.1529257"
Evaluating: -36.1529257-3.5
 Parameter: ZMIN <- "-39.6529257"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "8.78463718"
 Parameter: XMIN -> "1.78463718"
 Parameter: YMAX -> "-17.6964265"
 Parameter: YMIN -> "-24.6964265"
 Parameter: ZMAX -> "-32.6529257"
 Parameter: ZMIN -> "-39.6529257"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "73"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "73" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "73"
Evaluating: 73
 Parameter: J <- "73"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "73" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "73"
 Parameter: NPOS -> "53"
Evaluating: 73-53
 Parameter: J <- "20"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "20"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.910358285"
Evaluating: 120.112447*(0.910358285-0.5)
 Parameter: XPOS <- "49.2891378"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "2.602072345E-02"
Evaluating: 120.112447*(2.602072345E-02-0.5)
 Parameter: YPOS <- "-56.9308107"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.996230537"
Evaluating: 85*(0.996230537-0.5)+0
 Parameter: ZPOS <- "42.1795956"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "42.1795956" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "42.1795956" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "49.2891378"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 49.2891378-0
 Parameter: XTRAN <- "49.2891378"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-56.9308107"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -56.9308107-0
 Parameter: YTRAN <- "-56.9308107"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "42.1795956"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 42.1795956-0
 Parameter: ZTRAN <- "42.1795956"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "49.2891378"
 Parameter: YTRAN -> "-56.9308107"
 Parameter: ZTRAN -> "42.1795956"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    49.289138  -56.930811   42.179596
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.640653519"
Evaluating: 0.640653519*360.0
 Parameter: XPHI <- "230.635267"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.892989874"
Evaluating: 0.892989874*360.0
 Parameter: YPHI <- "321.476355"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.346160686"
Evaluating: 0.346160686*360.0
 Parameter: ZPHI <- "124.617847"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "49.2891378"
 Parameter: YPOS -> "-56.9308107"
 Parameter: ZPOS -> "42.1795956"
 Parameter: XPHI -> "230.635267"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.634255   -0.773124
    0.000000    0.773124   -0.634255

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  129.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "49.2891378"
 Parameter: YPOS -> "-56.9308107"
 Parameter: ZPOS -> "42.1795956"
 Parameter: YPHI -> "321.476355"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.782351    0.000000    0.622838
    0.000000    1.000000    0.000000
   -0.622838    0.000000    0.782351

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   38.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "49.2891378"
 Parameter: YPOS -> "-56.9308107"
 Parameter: ZPOS -> "42.1795956"
 Parameter: ZPHI -> "124.617847"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.568100    0.822959    0.000000
   -0.822959   -0.568100    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  124.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   49.289138 XMAX =   49.289138 XAVE =   49.289138
    YMIN =  -56.930811 YMAX =  -56.930811 YAVE =  -56.930811
    ZMIN =   42.179596 ZMAX =   42.179596 ZAVE =   42.179596
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "49.2891378"
Evaluating: 49.2891378+3.5
 Parameter: XMAX <- "52.7891378"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-56.9308107"
Evaluating: -56.9308107+3.5
 Parameter: YMAX <- "-53.4308107"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "42.1795956"
Evaluating: 42.1795956+3.5
 Parameter: ZMAX <- "45.6795956"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "49.2891378"
Evaluating: 49.2891378-3.5
 Parameter: XMIN <- "45.7891378"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-56.9308107"
Evaluating: -56.9308107-3.5
 Parameter: YMIN <- "-60.4308107"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "42.1795956"
Evaluating: 42.1795956-3.5
 Parameter: ZMIN <- "38.6795956"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "52.7891378"
 Parameter: XMIN -> "45.7891378"
 Parameter: YMAX -> "-53.4308107"
 Parameter: YMIN -> "-60.4308107"
 Parameter: ZMAX -> "45.6795956"
 Parameter: ZMIN -> "38.6795956"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "74"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "74" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "74"
Evaluating: 74
 Parameter: J <- "74"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "74" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "74"
 Parameter: NPOS -> "53"
Evaluating: 74-53
 Parameter: J <- "21"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "21"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.927211541"
Evaluating: 120.112447*(0.927211541-0.5)
 Parameter: XPOS <- "51.3134236"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.515997387"
Evaluating: 120.112447*(0.515997387-0.5)
 Parameter: YPOS <- "1.9214853"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.281405803"
Evaluating: 85*(0.281405803-0.5)+0
 Parameter: ZPOS <- "-18.5805067"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-18.5805067" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "51.3134236"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 51.3134236-0
 Parameter: XTRAN <- "51.3134236"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "1.9214853"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 1.9214853-0
 Parameter: YTRAN <- "1.9214853"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-18.5805067"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -18.5805067-0
 Parameter: ZTRAN <- "-18.5805067"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "51.3134236"
 Parameter: YTRAN -> "1.9214853"
 Parameter: ZTRAN -> "-18.5805067"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    51.313424    1.921485  -18.580507
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.771288114"
Evaluating: 0.771288114*360.0
 Parameter: XPHI <- "277.663721"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.382820802"
Evaluating: 0.382820802*360.0
 Parameter: YPHI <- "137.815489"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.28602054"
Evaluating: 0.28602054*360.0
 Parameter: ZPHI <- "102.967394"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "51.3134236"
 Parameter: YPOS -> "1.9214853"
 Parameter: ZPOS -> "-18.5805067"
 Parameter: XPHI -> "277.663721"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.133359   -0.991068
    0.000000    0.991068    0.133359

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   82.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "51.3134236"
 Parameter: YPOS -> "1.9214853"
 Parameter: ZPOS -> "-18.5805067"
 Parameter: YPHI -> "137.815489"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.740986    0.000000   -0.671520
    0.000000    1.000000    0.000000
    0.671520    0.000000   -0.740986

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  137.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "51.3134236"
 Parameter: YPOS -> "1.9214853"
 Parameter: ZPOS -> "-18.5805067"
 Parameter: ZPHI -> "102.967394"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.224397    0.974498    0.000000
   -0.974498   -0.224397    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  102.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   51.313424 XMAX =   51.313424 XAVE =   51.313424
    YMIN =    1.921485 YMAX =    1.921485 YAVE =    1.921485
    ZMIN =  -18.580507 ZMAX =  -18.580507 ZAVE =  -18.580507
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "51.3134236"
Evaluating: 51.3134236+3.5
 Parameter: XMAX <- "54.8134236"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "1.9214853"
Evaluating: 1.9214853+3.5
 Parameter: YMAX <- "5.4214853"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-18.5805067"
Evaluating: -18.5805067+3.5
 Parameter: ZMAX <- "-15.0805067"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "51.3134236"
Evaluating: 51.3134236-3.5
 Parameter: XMIN <- "47.8134236"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "1.9214853"
Evaluating: 1.9214853-3.5
 Parameter: YMIN <- "-1.5785147"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-18.5805067"
Evaluating: -18.5805067-3.5
 Parameter: ZMIN <- "-22.0805067"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "54.8134236"
 Parameter: XMIN -> "47.8134236"
 Parameter: YMAX -> "5.4214853"
 Parameter: YMIN -> "-1.5785147"
 Parameter: ZMAX -> "-15.0805067"
 Parameter: ZMIN -> "-22.0805067"
 SELRPN>      2 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      2 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
 5570 NEG      CL       21       CL      -4141 MEMB     DPPC     346      NC3           2.8428
 5570 NEG      CL       21       CL      -4333 MEMB     DPPC     362      NC3           3.7073
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "74"
Evaluating: 74
 Parameter: J <- "74"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "74" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "74"
 Parameter: NPOS -> "53"
Evaluating: 74-53
 Parameter: J <- "21"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "21"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.133791828"
Evaluating: 120.112447*(0.133791828-0.5)
 Parameter: XPOS <- "-43.9861597"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.113649508"
Evaluating: 120.112447*(0.113649508-0.5)
 Parameter: YPOS <- "-46.405503"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.157915828"
Evaluating: 85*(0.157915828-0.5)+0
 Parameter: ZPOS <- "-29.0771546"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-29.0771546" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   51.313424 XMAX =   51.313424 XAVE =   51.313424
    YMIN =    1.921485 YMAX =    1.921485 YAVE =    1.921485
    ZMIN =  -18.580507 ZMAX =  -18.580507 ZAVE =  -18.580507
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-43.9861597"
 RDCMND substituted energy or value "?XAVE" to "51.3134236"
Evaluating: -43.9861597-51.3134236
 Parameter: XTRAN <- "-95.2995833"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-46.405503"
 RDCMND substituted energy or value "?YAVE" to "1.9214853"
Evaluating: -46.405503-1.9214853
 Parameter: YTRAN <- "-48.3269883"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-29.0771546"
 RDCMND substituted energy or value "?ZAVE" to "-18.5805067"
Evaluating: -29.0771546--18.5805067
 Parameter: ZTRAN <- "-10.4966479"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-95.2995833"
 Parameter: YTRAN -> "-48.3269883"
 Parameter: ZTRAN -> "-10.4966479"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR   -95.299583  -48.326988  -10.496648
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.649387479"
Evaluating: 0.649387479*360.0
 Parameter: XPHI <- "233.779492"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.397201306"
Evaluating: 0.397201306*360.0
 Parameter: YPHI <- "142.99247"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.704338397"
Evaluating: 0.704338397*360.0
 Parameter: ZPHI <- "253.561823"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-43.9861597"
 Parameter: YPOS -> "-46.405503"
 Parameter: ZPOS -> "-29.0771546"
 Parameter: XPHI -> "233.779492"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.590894   -0.806749
    0.000000    0.806749   -0.590894

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  126.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-43.9861597"
 Parameter: YPOS -> "-46.405503"
 Parameter: ZPOS -> "-29.0771546"
 Parameter: YPHI -> "142.99247"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.798556    0.000000   -0.601920
    0.000000    1.000000    0.000000
    0.601920    0.000000   -0.798556

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  142.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-43.9861597"
 Parameter: YPOS -> "-46.405503"
 Parameter: ZPOS -> "-29.0771546"
 Parameter: ZPHI -> "253.561823"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.282981   -0.959126    0.000000
    0.959126   -0.282981    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  106.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -43.986160 XMAX =  -43.986160 XAVE =  -43.986160
    YMIN =  -46.405503 YMAX =  -46.405503 YAVE =  -46.405503
    ZMIN =  -29.077155 ZMAX =  -29.077155 ZAVE =  -29.077155
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-43.9861597"
Evaluating: -43.9861597+3.5
 Parameter: XMAX <- "-40.4861597"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-46.405503"
Evaluating: -46.405503+3.5
 Parameter: YMAX <- "-42.905503"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-29.0771546"
Evaluating: -29.0771546+3.5
 Parameter: ZMAX <- "-25.5771546"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-43.9861597"
Evaluating: -43.9861597-3.5
 Parameter: XMIN <- "-47.4861597"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-46.405503"
Evaluating: -46.405503-3.5
 Parameter: YMIN <- "-49.905503"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-29.0771546"
Evaluating: -29.0771546-3.5
 Parameter: ZMIN <- "-32.5771546"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-40.4861597"
 Parameter: XMIN -> "-47.4861597"
 Parameter: YMAX -> "-42.905503"
 Parameter: YMIN -> "-49.905503"
 Parameter: ZMAX -> "-25.5771546"
 Parameter: ZMIN -> "-32.5771546"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "75"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "75" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "75"
Evaluating: 75
 Parameter: J <- "75"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "75" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "75"
 Parameter: NPOS -> "53"
Evaluating: 75-53
 Parameter: J <- "22"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "22"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.250802269"
Evaluating: 120.112447*(0.250802269-0.5)
 Parameter: XPOS <- "-29.9317493"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.300731637"
Evaluating: 120.112447*(0.300731637-0.5)
 Parameter: YPOS <- "-23.9346107"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.887204041"
Evaluating: 85*(0.887204041-0.5)+0
 Parameter: ZPOS <- "32.9123435"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "32.9123435" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "32.9123435" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-29.9317493"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -29.9317493-0
 Parameter: XTRAN <- "-29.9317493"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-23.9346107"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -23.9346107-0
 Parameter: YTRAN <- "-23.9346107"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "32.9123435"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 32.9123435-0
 Parameter: ZTRAN <- "32.9123435"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-29.9317493"
 Parameter: YTRAN -> "-23.9346107"
 Parameter: ZTRAN -> "32.9123435"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR   -29.931749  -23.934611   32.912343
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.671030315"
Evaluating: 0.671030315*360.0
 Parameter: XPHI <- "241.570913"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.752009579"
Evaluating: 0.752009579*360.0
 Parameter: YPHI <- "270.723448"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.764545943"
Evaluating: 0.764545943*360.0
 Parameter: ZPHI <- "275.236539"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-29.9317493"
 Parameter: YPOS -> "-23.9346107"
 Parameter: ZPOS -> "32.9123435"
 Parameter: XPHI -> "241.570913"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.476071   -0.879407
    0.000000    0.879407   -0.476071

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  118.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-29.9317493"
 Parameter: YPOS -> "-23.9346107"
 Parameter: ZPOS -> "32.9123435"
 Parameter: YPHI -> "270.723448"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.012626    0.000000    0.999920
    0.000000    1.000000    0.000000
   -0.999920    0.000000    0.012626

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   89.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-29.9317493"
 Parameter: YPOS -> "-23.9346107"
 Parameter: ZPOS -> "32.9123435"
 Parameter: ZPHI -> "275.236539"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.091268   -0.995826    0.000000
    0.995826    0.091268    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   84.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -29.931749 XMAX =  -29.931749 XAVE =  -29.931749
    YMIN =  -23.934611 YMAX =  -23.934611 YAVE =  -23.934611
    ZMIN =   32.912343 ZMAX =   32.912343 ZAVE =   32.912343
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-29.9317493"
Evaluating: -29.9317493+3.5
 Parameter: XMAX <- "-26.4317493"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-23.9346107"
Evaluating: -23.9346107+3.5
 Parameter: YMAX <- "-20.4346107"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "32.9123435"
Evaluating: 32.9123435+3.5
 Parameter: ZMAX <- "36.4123435"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-29.9317493"
Evaluating: -29.9317493-3.5
 Parameter: XMIN <- "-33.4317493"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-23.9346107"
Evaluating: -23.9346107-3.5
 Parameter: YMIN <- "-27.4346107"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "32.9123435"
Evaluating: 32.9123435-3.5
 Parameter: ZMIN <- "29.4123435"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-26.4317493"
 Parameter: XMIN -> "-33.4317493"
 Parameter: YMAX -> "-20.4346107"
 Parameter: YMIN -> "-27.4346107"
 Parameter: ZMAX -> "36.4123435"
 Parameter: ZMIN -> "29.4123435"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "76"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "76" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "76"
Evaluating: 76
 Parameter: J <- "76"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "76" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "76"
 Parameter: NPOS -> "53"
Evaluating: 76-53
 Parameter: J <- "23"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "23"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.412952644"
Evaluating: 120.112447*(0.412952644-0.5)
 Parameter: XPOS <- "-10.4554709"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.303842023"
Evaluating: 120.112447*(0.303842023-0.5)
 Parameter: YPOS <- "-23.5610146"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.654829663"
Evaluating: 85*(0.654829663-0.5)+0
 Parameter: ZPOS <- "13.1605214"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "13.1605214" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "13.1605214" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "76"
Evaluating: 76
 Parameter: J <- "76"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "76" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "76"
 Parameter: NPOS -> "53"
Evaluating: 76-53
 Parameter: J <- "23"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "23"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.90766152"
Evaluating: 120.112447*(0.90766152-0.5)
 Parameter: XPOS <- "48.9652227"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.663080676"
Evaluating: 120.112447*(0.663080676-0.5)
 Parameter: YPOS <- "19.5880191"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.774347246"
Evaluating: 85*(0.774347246-0.5)+0
 Parameter: ZPOS <- "23.3195159"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "23.3195159" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "23.3195159" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "48.9652227"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 48.9652227-0
 Parameter: XTRAN <- "48.9652227"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "19.5880191"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 19.5880191-0
 Parameter: YTRAN <- "19.5880191"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "23.3195159"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 23.3195159-0
 Parameter: ZTRAN <- "23.3195159"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "48.9652227"
 Parameter: YTRAN -> "19.5880191"
 Parameter: ZTRAN -> "23.3195159"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    48.965223   19.588019   23.319516
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.900974612"
Evaluating: 0.900974612*360.0
 Parameter: XPHI <- "324.35086"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.520566746"
Evaluating: 0.520566746*360.0
 Parameter: YPHI <- "187.404029"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.934840777"
Evaluating: 0.934840777*360.0
 Parameter: ZPHI <- "336.54268"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "48.9652227"
 Parameter: YPOS -> "19.5880191"
 Parameter: ZPOS -> "23.3195159"
 Parameter: XPHI -> "324.35086"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.812601   -0.582820
    0.000000    0.582820    0.812601

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   35.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "48.9652227"
 Parameter: YPOS -> "19.5880191"
 Parameter: ZPOS -> "23.3195159"
 Parameter: YPHI -> "187.404029"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.991662    0.000000    0.128865
    0.000000    1.000000    0.000000
   -0.128865    0.000000   -0.991662

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  172.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "48.9652227"
 Parameter: YPOS -> "19.5880191"
 Parameter: ZPOS -> "23.3195159"
 Parameter: ZPHI -> "336.54268"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.917357   -0.398066    0.000000
    0.398066    0.917357    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   23.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   48.965223 XMAX =   48.965223 XAVE =   48.965223
    YMIN =   19.588019 YMAX =   19.588019 YAVE =   19.588019
    ZMIN =   23.319516 ZMAX =   23.319516 ZAVE =   23.319516
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "48.9652227"
Evaluating: 48.9652227+3.5
 Parameter: XMAX <- "52.4652227"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "19.5880191"
Evaluating: 19.5880191+3.5
 Parameter: YMAX <- "23.0880191"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "23.3195159"
Evaluating: 23.3195159+3.5
 Parameter: ZMAX <- "26.8195159"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "48.9652227"
Evaluating: 48.9652227-3.5
 Parameter: XMIN <- "45.4652227"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "19.5880191"
Evaluating: 19.5880191-3.5
 Parameter: YMIN <- "16.0880191"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "23.3195159"
Evaluating: 23.3195159-3.5
 Parameter: ZMIN <- "19.8195159"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "52.4652227"
 Parameter: XMIN -> "45.4652227"
 Parameter: YMAX -> "23.0880191"
 Parameter: YMIN -> "16.0880191"
 Parameter: ZMAX -> "26.8195159"
 Parameter: ZMIN -> "19.8195159"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      1 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
 5572 NEG      CL       23       CL      -1705 MEMB     DPPC     143      NC3           3.7243
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "76"
Evaluating: 76
 Parameter: J <- "76"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "76" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "76"
 Parameter: NPOS -> "53"
Evaluating: 76-53
 Parameter: J <- "23"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "23"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.42993037"
Evaluating: 120.112447*(0.42993037-0.5)
 Parameter: XPOS <- "-8.41623472"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.500533897"
Evaluating: 120.112447*(0.500533897-0.5)
 Parameter: YPOS <- "6.412767512E-02"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.588494857"
Evaluating: 85*(0.588494857-0.5)+0
 Parameter: ZPOS <- "7.52206284"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "7.52206284" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "7.52206284" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "76"
Evaluating: 76
 Parameter: J <- "76"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "76" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "76"
 Parameter: NPOS -> "53"
Evaluating: 76-53
 Parameter: J <- "23"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "23"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.365604482"
Evaluating: 120.112447*(0.365604482-0.5)
 Parameter: XPOS <- "-16.1425745"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.31427557"
Evaluating: 120.112447*(0.31427557-0.5)
 Parameter: YPOS <- "-22.3078158"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.911757517"
Evaluating: 85*(0.911757517-0.5)+0
 Parameter: ZPOS <- "34.9993889"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "34.9993889" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "34.9993889" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   48.965223 XMAX =   48.965223 XAVE =   48.965223
    YMIN =   19.588019 YMAX =   19.588019 YAVE =   19.588019
    ZMIN =   23.319516 ZMAX =   23.319516 ZAVE =   23.319516
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-16.1425745"
 RDCMND substituted energy or value "?XAVE" to "48.9652227"
Evaluating: -16.1425745-48.9652227
 Parameter: XTRAN <- "-65.1077972"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-22.3078158"
 RDCMND substituted energy or value "?YAVE" to "19.5880191"
Evaluating: -22.3078158-19.5880191
 Parameter: YTRAN <- "-41.8958349"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "34.9993889"
 RDCMND substituted energy or value "?ZAVE" to "23.3195159"
Evaluating: 34.9993889-23.3195159
 Parameter: ZTRAN <- "11.679873"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-65.1077972"
 Parameter: YTRAN -> "-41.8958349"
 Parameter: ZTRAN -> "11.679873"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR   -65.107797  -41.895835   11.679873
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.896867375"
Evaluating: 0.896867375*360.0
 Parameter: XPHI <- "322.872255"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.740105892"
Evaluating: 0.740105892*360.0
 Parameter: YPHI <- "266.438121"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.652123748"
Evaluating: 0.652123748*360.0
 Parameter: ZPHI <- "234.764549"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-16.1425745"
 Parameter: YPOS -> "-22.3078158"
 Parameter: ZPOS -> "34.9993889"
 Parameter: XPHI -> "322.872255"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.797292   -0.603594
    0.000000    0.603594    0.797292

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   37.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-16.1425745"
 Parameter: YPOS -> "-22.3078158"
 Parameter: ZPOS -> "34.9993889"
 Parameter: YPHI -> "266.438121"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.062126    0.000000    0.998068
    0.000000    1.000000    0.000000
   -0.998068    0.000000   -0.062126

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   93.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-16.1425745"
 Parameter: YPOS -> "-22.3078158"
 Parameter: ZPOS -> "34.9993889"
 Parameter: ZPHI -> "234.764549"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.576938   -0.816788    0.000000
    0.816788   -0.576938    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  125.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -16.142575 XMAX =  -16.142575 XAVE =  -16.142575
    YMIN =  -22.307816 YMAX =  -22.307816 YAVE =  -22.307816
    ZMIN =   34.999389 ZMAX =   34.999389 ZAVE =   34.999389
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-16.1425745"
Evaluating: -16.1425745+3.5
 Parameter: XMAX <- "-12.6425745"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-22.3078158"
Evaluating: -22.3078158+3.5
 Parameter: YMAX <- "-18.8078158"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "34.9993889"
Evaluating: 34.9993889+3.5
 Parameter: ZMAX <- "38.4993889"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-16.1425745"
Evaluating: -16.1425745-3.5
 Parameter: XMIN <- "-19.6425745"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-22.3078158"
Evaluating: -22.3078158-3.5
 Parameter: YMIN <- "-25.8078158"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "34.9993889"
Evaluating: 34.9993889-3.5
 Parameter: ZMIN <- "31.4993889"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-12.6425745"
 Parameter: XMIN -> "-19.6425745"
 Parameter: YMAX -> "-18.8078158"
 Parameter: YMIN -> "-25.8078158"
 Parameter: ZMAX -> "38.4993889"
 Parameter: ZMIN -> "31.4993889"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "77"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "77" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "77"
Evaluating: 77
 Parameter: J <- "77"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "77" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "77"
 Parameter: NPOS -> "53"
Evaluating: 77-53
 Parameter: J <- "24"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "24"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.479474442"
Evaluating: 120.112447*(0.479474442-0.5)
 Parameter: XPOS <- "-2.465375"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.877249747"
Evaluating: 120.112447*(0.877249747-0.5)
 Parameter: YPOS <- "45.3123902"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.248066479"
Evaluating: 85*(0.248066479-0.5)+0
 Parameter: ZPOS <- "-21.4143493"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-21.4143493" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-2.465375"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -2.465375-0
 Parameter: XTRAN <- "-2.465375"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "45.3123902"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 45.3123902-0
 Parameter: YTRAN <- "45.3123902"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-21.4143493"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -21.4143493-0
 Parameter: ZTRAN <- "-21.4143493"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-2.465375"
 Parameter: YTRAN -> "45.3123902"
 Parameter: ZTRAN -> "-21.4143493"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    -2.465375   45.312390  -21.414349
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.831045595"
Evaluating: 0.831045595*360.0
 Parameter: XPHI <- "299.176414"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.253962476"
Evaluating: 0.253962476*360.0
 Parameter: YPHI <- "91.4264914"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.627822768"
Evaluating: 0.627822768*360.0
 Parameter: ZPHI <- "226.016196"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-2.465375"
 Parameter: YPOS -> "45.3123902"
 Parameter: ZPOS -> "-21.4143493"
 Parameter: XPHI -> "299.176414"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.487500   -0.873123
    0.000000    0.873123    0.487500

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   60.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-2.465375"
 Parameter: YPOS -> "45.3123902"
 Parameter: ZPOS -> "-21.4143493"
 Parameter: YPHI -> "91.4264914"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.024894    0.000000   -0.999690
    0.000000    1.000000    0.000000
    0.999690    0.000000   -0.024894

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   91.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-2.465375"
 Parameter: YPOS -> "45.3123902"
 Parameter: ZPOS -> "-21.4143493"
 Parameter: ZPHI -> "226.016196"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.694455   -0.719536    0.000000
    0.719536   -0.694455    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  133.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -2.465375 XMAX =   -2.465375 XAVE =   -2.465375
    YMIN =   45.312390 YMAX =   45.312390 YAVE =   45.312390
    ZMIN =  -21.414349 ZMAX =  -21.414349 ZAVE =  -21.414349
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-2.465375"
Evaluating: -2.465375+3.5
 Parameter: XMAX <- "1.034625"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "45.3123902"
Evaluating: 45.3123902+3.5
 Parameter: YMAX <- "48.8123902"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-21.4143493"
Evaluating: -21.4143493+3.5
 Parameter: ZMAX <- "-17.9143493"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-2.465375"
Evaluating: -2.465375-3.5
 Parameter: XMIN <- "-5.965375"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "45.3123902"
Evaluating: 45.3123902-3.5
 Parameter: YMIN <- "41.8123902"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-21.4143493"
Evaluating: -21.4143493-3.5
 Parameter: ZMIN <- "-24.9143493"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "1.034625"
 Parameter: XMIN -> "-5.965375"
 Parameter: YMAX -> "48.8123902"
 Parameter: YMIN -> "41.8123902"
 Parameter: ZMAX -> "-17.9143493"
 Parameter: ZMIN -> "-24.9143493"
 SELRPN>      2 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      2 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
 5573 NEG      CL       24       CL      -3817 MEMB     DPPC     319      NC3           2.0390
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "77"
Evaluating: 77
 Parameter: J <- "77"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "77" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "77"
 Parameter: NPOS -> "53"
Evaluating: 77-53
 Parameter: J <- "24"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "24"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.102693062"
Evaluating: 120.112447*(0.102693062-0.5)
 Parameter: XPOS <- "-47.7215085"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.851051221"
Evaluating: 120.112447*(0.851051221-0.5)
 Parameter: YPOS <- "42.1656212"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.156856364"
Evaluating: 85*(0.156856364-0.5)+0
 Parameter: ZPOS <- "-29.1672091"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-29.1672091" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -2.465375 XMAX =   -2.465375 XAVE =   -2.465375
    YMIN =   45.312390 YMAX =   45.312390 YAVE =   45.312390
    ZMIN =  -21.414349 ZMAX =  -21.414349 ZAVE =  -21.414349
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-47.7215085"
 RDCMND substituted energy or value "?XAVE" to "-2.465375"
Evaluating: -47.7215085--2.465375
 Parameter: XTRAN <- "-45.2561335"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "42.1656212"
 RDCMND substituted energy or value "?YAVE" to "45.3123902"
Evaluating: 42.1656212-45.3123902
 Parameter: YTRAN <- "-3.146769"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-29.1672091"
 RDCMND substituted energy or value "?ZAVE" to "-21.4143493"
Evaluating: -29.1672091--21.4143493
 Parameter: ZTRAN <- "-7.7528598"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-45.2561335"
 Parameter: YTRAN -> "-3.146769"
 Parameter: ZTRAN -> "-7.7528598"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR   -45.256133   -3.146769   -7.752860
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.964593585"
Evaluating: 0.964593585*360.0
 Parameter: XPHI <- "347.253691"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.701531719"
Evaluating: 0.701531719*360.0
 Parameter: YPHI <- "252.551419"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.345065169"
Evaluating: 0.345065169*360.0
 Parameter: ZPHI <- "124.223461"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-47.7215085"
 Parameter: YPOS -> "42.1656212"
 Parameter: ZPOS -> "-29.1672091"
 Parameter: XPHI -> "347.253691"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.975357   -0.220635
    0.000000    0.220635    0.975357

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   12.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-47.7215085"
 Parameter: YPOS -> "42.1656212"
 Parameter: ZPOS -> "-29.1672091"
 Parameter: YPHI -> "252.551419"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.299850    0.000000    0.953986
    0.000000    1.000000    0.000000
   -0.953986    0.000000   -0.299850

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  107.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-47.7215085"
 Parameter: YPOS -> "42.1656212"
 Parameter: ZPOS -> "-29.1672091"
 Parameter: ZPHI -> "124.223461"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.562422    0.826850    0.000000
   -0.826850   -0.562422    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  124.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -47.721508 XMAX =  -47.721508 XAVE =  -47.721508
    YMIN =   42.165621 YMAX =   42.165621 YAVE =   42.165621
    ZMIN =  -29.167209 ZMAX =  -29.167209 ZAVE =  -29.167209
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-47.7215085"
Evaluating: -47.7215085+3.5
 Parameter: XMAX <- "-44.2215085"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "42.1656212"
Evaluating: 42.1656212+3.5
 Parameter: YMAX <- "45.6656212"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-29.1672091"
Evaluating: -29.1672091+3.5
 Parameter: ZMAX <- "-25.6672091"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-47.7215085"
Evaluating: -47.7215085-3.5
 Parameter: XMIN <- "-51.2215085"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "42.1656212"
Evaluating: 42.1656212-3.5
 Parameter: YMIN <- "38.6656212"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-29.1672091"
Evaluating: -29.1672091-3.5
 Parameter: ZMIN <- "-32.6672091"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-44.2215085"
 Parameter: XMIN -> "-51.2215085"
 Parameter: YMAX -> "45.6656212"
 Parameter: YMIN -> "38.6656212"
 Parameter: ZMAX -> "-25.6672091"
 Parameter: ZMIN -> "-32.6672091"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "78"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "78" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "78"
Evaluating: 78
 Parameter: J <- "78"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "78" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "78"
 Parameter: NPOS -> "53"
Evaluating: 78-53
 Parameter: J <- "25"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "25"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.593757019"
Evaluating: 120.112447*(0.593757019-0.5)
 Parameter: XPOS <- "11.261385"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.990826134"
Evaluating: 120.112447*(0.990826134-0.5)
 Parameter: YPOS <- "58.954328"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.757811283"
Evaluating: 85*(0.757811283-0.5)+0
 Parameter: ZPOS <- "21.9139591"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "21.9139591" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "21.9139591" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "11.261385"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 11.261385-0
 Parameter: XTRAN <- "11.261385"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "58.954328"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 58.954328-0
 Parameter: YTRAN <- "58.954328"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "21.9139591"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 21.9139591-0
 Parameter: ZTRAN <- "21.9139591"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "11.261385"
 Parameter: YTRAN -> "58.954328"
 Parameter: ZTRAN -> "21.9139591"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    11.261385   58.954328   21.913959
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.118100907"
Evaluating: 0.118100907*360.0
 Parameter: XPHI <- "42.5163265"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.626483759"
Evaluating: 0.626483759*360.0
 Parameter: YPHI <- "225.534153"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.726327073"
Evaluating: 0.726327073*360.0
 Parameter: ZPHI <- "261.477746"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "11.261385"
 Parameter: YPOS -> "58.954328"
 Parameter: ZPOS -> "21.9139591"
 Parameter: XPHI -> "42.5163265"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.737085    0.675800
    0.000000   -0.675800    0.737085

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   42.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "11.261385"
 Parameter: YPOS -> "58.954328"
 Parameter: ZPOS -> "21.9139591"
 Parameter: YPHI -> "225.534153"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.700484    0.000000    0.713668
    0.000000    1.000000    0.000000
   -0.713668    0.000000   -0.700484

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  134.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "11.261385"
 Parameter: YPOS -> "58.954328"
 Parameter: ZPOS -> "21.9139591"
 Parameter: ZPHI -> "261.477746"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.148194   -0.988958    0.000000
    0.988958   -0.148194    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   98.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   11.261385 XMAX =   11.261385 XAVE =   11.261385
    YMIN =   58.954328 YMAX =   58.954328 YAVE =   58.954328
    ZMIN =   21.913959 ZMAX =   21.913959 ZAVE =   21.913959
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "11.261385"
Evaluating: 11.261385+3.5
 Parameter: XMAX <- "14.761385"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "58.954328"
Evaluating: 58.954328+3.5
 Parameter: YMAX <- "62.454328"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "21.9139591"
Evaluating: 21.9139591+3.5
 Parameter: ZMAX <- "25.4139591"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "11.261385"
Evaluating: 11.261385-3.5
 Parameter: XMIN <- "7.761385"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "58.954328"
Evaluating: 58.954328-3.5
 Parameter: YMIN <- "55.454328"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "21.9139591"
Evaluating: 21.9139591-3.5
 Parameter: ZMIN <- "18.4139591"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "14.761385"
 Parameter: XMIN -> "7.761385"
 Parameter: YMAX -> "62.454328"
 Parameter: YMIN -> "55.454328"
 Parameter: ZMAX -> "25.4139591"
 Parameter: ZMIN -> "18.4139591"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      1 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
 5574 NEG      CL       25       CL      -1909 MEMB     DPPC     160      NC3           3.2836
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "78"
Evaluating: 78
 Parameter: J <- "78"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "78" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "78"
 Parameter: NPOS -> "53"
Evaluating: 78-53
 Parameter: J <- "25"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "25"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.729734909"
Evaluating: 120.112447*(0.729734909-0.5)
 Parameter: XPOS <- "27.5940221"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.563882707"
Evaluating: 120.112447*(0.563882707-0.5)
 Parameter: YPOS <- "7.67310826"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.506585661"
Evaluating: 85*(0.506585661-0.5)+0
 Parameter: ZPOS <- "0.559781185"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "0.559781185" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "0.559781185" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "78"
Evaluating: 78
 Parameter: J <- "78"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "78" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "78"
 Parameter: NPOS -> "53"
Evaluating: 78-53
 Parameter: J <- "25"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "25"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.486970863"
Evaluating: 120.112447*(0.486970863-0.5)
 Parameter: XPOS <- "-1.56496153"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.524801406"
Evaluating: 120.112447*(0.524801406-0.5)
 Parameter: YPOS <- "2.97895756"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.732557087"
Evaluating: 85*(0.732557087-0.5)+0
 Parameter: ZPOS <- "19.7673524"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "19.7673524" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "19.7673524" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   11.261385 XMAX =   11.261385 XAVE =   11.261385
    YMIN =   58.954328 YMAX =   58.954328 YAVE =   58.954328
    ZMIN =   21.913959 ZMAX =   21.913959 ZAVE =   21.913959
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-1.56496153"
 RDCMND substituted energy or value "?XAVE" to "11.261385"
Evaluating: -1.56496153-11.261385
 Parameter: XTRAN <- "-12.8263465"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "2.97895756"
 RDCMND substituted energy or value "?YAVE" to "58.954328"
Evaluating: 2.97895756-58.954328
 Parameter: YTRAN <- "-55.9753704"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "19.7673524"
 RDCMND substituted energy or value "?ZAVE" to "21.9139591"
Evaluating: 19.7673524-21.9139591
 Parameter: ZTRAN <- "-2.1466067"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-12.8263465"
 Parameter: YTRAN -> "-55.9753704"
 Parameter: ZTRAN -> "-2.1466067"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR   -12.826346  -55.975370   -2.146607
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.677882901"
Evaluating: 0.677882901*360.0
 Parameter: XPHI <- "244.037844"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.957362245"
Evaluating: 0.957362245*360.0
 Parameter: YPHI <- "344.650408"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.724263638"
Evaluating: 0.724263638*360.0
 Parameter: ZPHI <- "260.73491"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-1.56496153"
 Parameter: YPOS -> "2.97895756"
 Parameter: ZPOS -> "19.7673524"
 Parameter: XPHI -> "244.037844"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.437777   -0.899083
    0.000000    0.899083   -0.437777

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  115.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-1.56496153"
 Parameter: YPOS -> "2.97895756"
 Parameter: ZPOS -> "19.7673524"
 Parameter: YPHI -> "344.650408"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.964329    0.000000    0.264708
    0.000000    1.000000    0.000000
   -0.264708    0.000000    0.964329

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   15.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-1.56496153"
 Parameter: YPOS -> "2.97895756"
 Parameter: ZPOS -> "19.7673524"
 Parameter: ZPHI -> "260.73491"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.161003   -0.986954    0.000000
    0.986954   -0.161003    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   99.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -1.564962 XMAX =   -1.564962 XAVE =   -1.564962
    YMIN =    2.978958 YMAX =    2.978958 YAVE =    2.978958
    ZMIN =   19.767352 ZMAX =   19.767352 ZAVE =   19.767352
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-1.56496152"
Evaluating: -1.56496152+3.5
 Parameter: XMAX <- "1.93503848"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "2.9789576"
Evaluating: 2.9789576+3.5
 Parameter: YMAX <- "6.4789576"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "19.7673524"
Evaluating: 19.7673524+3.5
 Parameter: ZMAX <- "23.2673524"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-1.56496152"
Evaluating: -1.56496152-3.5
 Parameter: XMIN <- "-5.06496152"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "2.9789576"
Evaluating: 2.9789576-3.5
 Parameter: YMIN <- "-0.5210424"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "19.7673524"
Evaluating: 19.7673524-3.5
 Parameter: ZMIN <- "16.2673524"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "1.93503848"
 Parameter: XMIN -> "-5.06496152"
 Parameter: YMAX -> "6.4789576"
 Parameter: YMIN -> "-0.5210424"
 Parameter: ZMAX -> "23.2673524"
 Parameter: ZMIN -> "16.2673524"
 SELRPN>      2 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      2 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
 5574 NEG      CL       25       CL      -   1 MEMB     DPPC     1        NC3           3.1550
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "78"
Evaluating: 78
 Parameter: J <- "78"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "78" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "78"
 Parameter: NPOS -> "53"
Evaluating: 78-53
 Parameter: J <- "25"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "25"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.243802879"
Evaluating: 120.112447*(0.243802879-0.5)
 Parameter: XPOS <- "-30.7724631"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.47012067"
Evaluating: 120.112447*(0.47012067-0.5)
 Parameter: YPOS <- "-3.58887944"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.108587344"
Evaluating: 85*(0.108587344-0.5)+0
 Parameter: ZPOS <- "-33.2700758"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-33.2700758" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -1.564962 XMAX =   -1.564962 XAVE =   -1.564962
    YMIN =    2.978958 YMAX =    2.978958 YAVE =    2.978958
    ZMIN =   19.767352 ZMAX =   19.767352 ZAVE =   19.767352
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-30.7724631"
 RDCMND substituted energy or value "?XAVE" to "-1.56496152"
Evaluating: -30.7724631--1.56496152
 Parameter: XTRAN <- "-29.2075016"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-3.58887944"
 RDCMND substituted energy or value "?YAVE" to "2.9789576"
Evaluating: -3.58887944-2.9789576
 Parameter: YTRAN <- "-6.56783704"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-33.2700758"
 RDCMND substituted energy or value "?ZAVE" to "19.7673524"
Evaluating: -33.2700758-19.7673524
 Parameter: ZTRAN <- "-53.0374282"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-29.2075016"
 Parameter: YTRAN -> "-6.56783704"
 Parameter: ZTRAN -> "-53.0374282"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR   -29.207502   -6.567837  -53.037428
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.772954908"
Evaluating: 0.772954908*360.0
 Parameter: XPHI <- "278.263767"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.931314987"
Evaluating: 0.931314987*360.0
 Parameter: YPHI <- "335.273395"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.896649688"
Evaluating: 0.896649688*360.0
 Parameter: ZPHI <- "322.793888"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-30.7724631"
 Parameter: YPOS -> "-3.58887944"
 Parameter: ZPOS -> "-33.2700758"
 Parameter: XPHI -> "278.263767"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.143730   -0.989617
    0.000000    0.989617    0.143730

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   81.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-30.7724631"
 Parameter: YPOS -> "-3.58887944"
 Parameter: ZPOS -> "-33.2700758"
 Parameter: YPHI -> "335.273395"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.908314    0.000000    0.418289
    0.000000    1.000000    0.000000
   -0.418289    0.000000    0.908314

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   24.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-30.7724631"
 Parameter: YPOS -> "-3.58887944"
 Parameter: ZPOS -> "-33.2700758"
 Parameter: ZPHI -> "322.793888"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.796465   -0.604684    0.000000
    0.604684    0.796465    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   37.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -30.772463 XMAX =  -30.772463 XAVE =  -30.772463
    YMIN =   -3.588879 YMAX =   -3.588879 YAVE =   -3.588879
    ZMIN =  -33.270076 ZMAX =  -33.270076 ZAVE =  -33.270076
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-30.7724631"
Evaluating: -30.7724631+3.5
 Parameter: XMAX <- "-27.2724631"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-3.58887947"
Evaluating: -3.58887947+3.5
 Parameter: YMAX <- "-8.887947E-02"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-33.2700758"
Evaluating: -33.2700758+3.5
 Parameter: ZMAX <- "-29.7700758"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-30.7724631"
Evaluating: -30.7724631-3.5
 Parameter: XMIN <- "-34.2724631"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-3.58887947"
Evaluating: -3.58887947-3.5
 Parameter: YMIN <- "-7.08887947"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-33.2700758"
Evaluating: -33.2700758-3.5
 Parameter: ZMIN <- "-36.7700758"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-27.2724631"
 Parameter: XMIN -> "-34.2724631"
 Parameter: YMAX -> "-8.887947E-02"
 Parameter: YMIN -> "-7.08887947"
 Parameter: ZMAX -> "-29.7700758"
 Parameter: ZMIN -> "-36.7700758"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "79"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "79" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "79"
Evaluating: 79
 Parameter: J <- "79"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "79" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "79"
 Parameter: NPOS -> "53"
Evaluating: 79-53
 Parameter: J <- "26"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "26"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.706242048"
Evaluating: 120.112447*(0.706242048-0.5)
 Parameter: XPOS <- "24.7722371"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.9686626"
Evaluating: 120.112447*(0.9686626-0.5)
 Parameter: YPOS <- "56.2922117"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "6.441823582E-02"
Evaluating: 85*(6.441823582E-02-0.5)+0
 Parameter: ZPOS <- "-37.02445"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-37.02445" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "24.7722371"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 24.7722371-0
 Parameter: XTRAN <- "24.7722371"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "56.2922117"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 56.2922117-0
 Parameter: YTRAN <- "56.2922117"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-37.02445"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -37.02445-0
 Parameter: ZTRAN <- "-37.02445"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "24.7722371"
 Parameter: YTRAN -> "56.2922117"
 Parameter: ZTRAN -> "-37.02445"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    24.772237   56.292212  -37.024450
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.691201927"
Evaluating: 0.691201927*360.0
 Parameter: XPHI <- "248.832694"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.327311556"
Evaluating: 0.327311556*360.0
 Parameter: YPHI <- "117.83216"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.577305569E-02"
Evaluating: 4.577305569E-02*360.0
 Parameter: ZPHI <- "16.4783"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "24.7722371"
 Parameter: YPOS -> "56.2922117"
 Parameter: ZPOS -> "-37.02445"
 Parameter: XPHI -> "248.832694"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.361093   -0.932530
    0.000000    0.932530   -0.361093

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  111.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "24.7722371"
 Parameter: YPOS -> "56.2922117"
 Parameter: ZPOS -> "-37.02445"
 Parameter: YPHI -> "117.83216"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.466883    0.000000   -0.884319
    0.000000    1.000000    0.000000
    0.884319    0.000000   -0.466883

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  117.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "24.7722371"
 Parameter: YPOS -> "56.2922117"
 Parameter: ZPOS -> "-37.02445"
 Parameter: ZPHI -> "16.4783"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.958927    0.283652    0.000000
   -0.283652    0.958927    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   16.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   24.772237 XMAX =   24.772237 XAVE =   24.772237
    YMIN =   56.292212 YMAX =   56.292212 YAVE =   56.292212
    ZMIN =  -37.024450 ZMAX =  -37.024450 ZAVE =  -37.024450
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "24.7722371"
Evaluating: 24.7722371+3.5
 Parameter: XMAX <- "28.2722371"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "56.2922117"
Evaluating: 56.2922117+3.5
 Parameter: YMAX <- "59.7922117"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-37.02445"
Evaluating: -37.02445+3.5
 Parameter: ZMAX <- "-33.52445"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "24.7722371"
Evaluating: 24.7722371-3.5
 Parameter: XMIN <- "21.2722371"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "56.2922117"
Evaluating: 56.2922117-3.5
 Parameter: YMIN <- "52.7922117"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-37.02445"
Evaluating: -37.02445-3.5
 Parameter: ZMIN <- "-40.52445"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "28.2722371"
 Parameter: XMIN -> "21.2722371"
 Parameter: YMAX -> "59.7922117"
 Parameter: YMIN -> "52.7922117"
 Parameter: ZMAX -> "-33.52445"
 Parameter: ZMIN -> "-40.52445"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "80"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "80" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "80"
Evaluating: 80
 Parameter: J <- "80"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "80" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "80"
 Parameter: NPOS -> "53"
Evaluating: 80-53
 Parameter: J <- "27"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "27"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.492869888"
Evaluating: 120.112447*(0.492869888-0.5)
 Parameter: XPOS <- "-0.8564152"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.817232345"
Evaluating: 120.112447*(0.817232345-0.5)
 Parameter: YPOS <- "38.1035532"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.251480956"
Evaluating: 85*(0.251480956-0.5)+0
 Parameter: ZPOS <- "-21.1241187"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-21.1241187" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-0.8564152"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -0.8564152-0
 Parameter: XTRAN <- "-0.8564152"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "38.1035532"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 38.1035532-0
 Parameter: YTRAN <- "38.1035532"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-21.1241187"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -21.1241187-0
 Parameter: ZTRAN <- "-21.1241187"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-0.8564152"
 Parameter: YTRAN -> "38.1035532"
 Parameter: ZTRAN -> "-21.1241187"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    -0.856415   38.103553  -21.124119
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.7136571"
Evaluating: 0.7136571*360.0
 Parameter: XPHI <- "256.916556"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.208347567"
Evaluating: 0.208347567*360.0
 Parameter: YPHI <- "75.0051241"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.271896753"
Evaluating: 0.271896753*360.0
 Parameter: ZPHI <- "97.8828311"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-0.8564152"
 Parameter: YPOS -> "38.1035532"
 Parameter: ZPOS -> "-21.1241187"
 Parameter: XPHI -> "256.916556"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.226370   -0.974041
    0.000000    0.974041   -0.226370

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  103.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-0.8564152"
 Parameter: YPOS -> "38.1035532"
 Parameter: ZPOS -> "-21.1241187"
 Parameter: YPHI -> "75.0051241"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.258733    0.000000   -0.965949
    0.000000    1.000000    0.000000
    0.965949    0.000000    0.258733

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   75.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-0.8564152"
 Parameter: YPOS -> "38.1035532"
 Parameter: ZPOS -> "-21.1241187"
 Parameter: ZPHI -> "97.8828311"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.137148    0.990551    0.000000
   -0.990551   -0.137148    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   97.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -0.856415 XMAX =   -0.856415 XAVE =   -0.856415
    YMIN =   38.103553 YMAX =   38.103553 YAVE =   38.103553
    ZMIN =  -21.124119 ZMAX =  -21.124119 ZAVE =  -21.124119
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-0.8564152"
Evaluating: -0.8564152+3.5
 Parameter: XMAX <- "2.6435848"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "38.1035532"
Evaluating: 38.1035532+3.5
 Parameter: YMAX <- "41.6035532"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-21.1241187"
Evaluating: -21.1241187+3.5
 Parameter: ZMAX <- "-17.6241187"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-0.8564152"
Evaluating: -0.8564152-3.5
 Parameter: XMIN <- "-4.3564152"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "38.1035532"
Evaluating: 38.1035532-3.5
 Parameter: YMIN <- "34.6035532"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-21.1241187"
Evaluating: -21.1241187-3.5
 Parameter: ZMIN <- "-24.6241187"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "2.6435848"
 Parameter: XMIN -> "-4.3564152"
 Parameter: YMAX -> "41.6035532"
 Parameter: YMIN -> "34.6035532"
 Parameter: ZMAX -> "-17.6241187"
 Parameter: ZMIN -> "-24.6241187"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "81"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "81" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "81"
Evaluating: 81
 Parameter: J <- "81"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "81" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "81"
 Parameter: NPOS -> "53"
Evaluating: 81-53
 Parameter: J <- "28"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "28"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.372145641"
Evaluating: 120.112447*(0.372145641-0.5)
 Parameter: XPOS <- "-15.3568999"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.750498742"
Evaluating: 120.112447*(0.750498742-0.5)
 Parameter: YPOS <- "30.0880169"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.592142416"
Evaluating: 85*(0.592142416-0.5)+0
 Parameter: ZPOS <- "7.83210536"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "7.83210536" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "7.83210536" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "81"
Evaluating: 81
 Parameter: J <- "81"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "81" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "81"
 Parameter: NPOS -> "53"
Evaluating: 81-53
 Parameter: J <- "28"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "28"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.859258756"
Evaluating: 120.112447*(0.859258756-0.5)
 Parameter: XPOS <- "43.1514483"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.850064163"
Evaluating: 120.112447*(0.850064163-0.5)
 Parameter: YPOS <- "42.0470632"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "3.393552502E-02"
Evaluating: 85*(3.393552502E-02-0.5)+0
 Parameter: ZPOS <- "-39.6154804"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-39.6154804" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "43.1514483"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 43.1514483-0
 Parameter: XTRAN <- "43.1514483"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "42.0470632"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 42.0470632-0
 Parameter: YTRAN <- "42.0470632"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-39.6154804"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -39.6154804-0
 Parameter: ZTRAN <- "-39.6154804"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "43.1514483"
 Parameter: YTRAN -> "42.0470632"
 Parameter: ZTRAN -> "-39.6154804"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    43.151448   42.047063  -39.615480
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.652116933"
Evaluating: 0.652116933*360.0
 Parameter: XPHI <- "234.762096"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.701323347"
Evaluating: 0.701323347*360.0
 Parameter: YPHI <- "252.476405"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.607214445"
Evaluating: 0.607214445*360.0
 Parameter: ZPHI <- "218.5972"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "43.1514483"
 Parameter: YPOS -> "42.0470632"
 Parameter: ZPOS -> "-39.6154804"
 Parameter: XPHI -> "234.762096"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.576973   -0.816763
    0.000000    0.816763   -0.576973

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  125.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "43.1514483"
 Parameter: YPOS -> "42.0470632"
 Parameter: ZPOS -> "-39.6154804"
 Parameter: YPHI -> "252.476405"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.301099    0.000000    0.953593
    0.000000    1.000000    0.000000
   -0.953593    0.000000   -0.301099

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  107.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "43.1514483"
 Parameter: YPOS -> "42.0470632"
 Parameter: ZPOS -> "-39.6154804"
 Parameter: ZPHI -> "218.5972"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.781551   -0.623841    0.000000
    0.623841   -0.781551    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  141.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   43.151448 XMAX =   43.151448 XAVE =   43.151448
    YMIN =   42.047063 YMAX =   42.047063 YAVE =   42.047063
    ZMIN =  -39.615480 ZMAX =  -39.615480 ZAVE =  -39.615480
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "43.1514483"
Evaluating: 43.1514483+3.5
 Parameter: XMAX <- "46.6514483"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "42.0470632"
Evaluating: 42.0470632+3.5
 Parameter: YMAX <- "45.5470632"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-39.6154804"
Evaluating: -39.6154804+3.5
 Parameter: ZMAX <- "-36.1154804"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "43.1514483"
Evaluating: 43.1514483-3.5
 Parameter: XMIN <- "39.6514483"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "42.0470632"
Evaluating: 42.0470632-3.5
 Parameter: YMIN <- "38.5470632"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-39.6154804"
Evaluating: -39.6154804-3.5
 Parameter: ZMIN <- "-43.1154804"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "46.6514483"
 Parameter: XMIN -> "39.6514483"
 Parameter: YMAX -> "45.5470632"
 Parameter: YMIN -> "38.5470632"
 Parameter: ZMAX -> "-36.1154804"
 Parameter: ZMIN -> "-43.1154804"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "82"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "82" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "82"
Evaluating: 82
 Parameter: J <- "82"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "82" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "82"
 Parameter: NPOS -> "53"
Evaluating: 82-53
 Parameter: J <- "29"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "29"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.625496377"
Evaluating: 120.112447*(0.625496377-0.5)
 Parameter: XPOS <- "15.0736769"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "3.400990874E-02"
Evaluating: 120.112447*(3.400990874E-02-0.5)
 Parameter: YPOS <- "-55.9712101"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.846357492"
Evaluating: 85*(0.846357492-0.5)+0
 Parameter: ZPOS <- "29.4403868"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "29.4403868" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "29.4403868" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "15.0736769"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 15.0736769-0
 Parameter: XTRAN <- "15.0736769"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-55.9712101"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -55.9712101-0
 Parameter: YTRAN <- "-55.9712101"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "29.4403868"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 29.4403868-0
 Parameter: ZTRAN <- "29.4403868"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "15.0736769"
 Parameter: YTRAN -> "-55.9712101"
 Parameter: ZTRAN -> "29.4403868"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    15.073677  -55.971210   29.440387
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.915439312"
Evaluating: 0.915439312*360.0
 Parameter: XPHI <- "329.558152"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.574908186"
Evaluating: 0.574908186*360.0
 Parameter: YPHI <- "206.966947"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.969007056"
Evaluating: 0.969007056*360.0
 Parameter: ZPHI <- "348.84254"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "15.0736769"
 Parameter: YPOS -> "-55.9712101"
 Parameter: ZPOS -> "29.4403868"
 Parameter: XPHI -> "329.558152"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.862144   -0.506664
    0.000000    0.506664    0.862144

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   30.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "15.0736769"
 Parameter: YPOS -> "-55.9712101"
 Parameter: ZPOS -> "29.4403868"
 Parameter: YPHI -> "206.966947"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.891268    0.000000    0.453476
    0.000000    1.000000    0.000000
   -0.453476    0.000000   -0.891268

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  153.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "15.0736769"
 Parameter: YPOS -> "-55.9712101"
 Parameter: ZPOS -> "29.4403868"
 Parameter: ZPHI -> "348.84254"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.981099   -0.193506    0.000000
    0.193506    0.981099    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   11.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   15.073677 XMAX =   15.073677 XAVE =   15.073677
    YMIN =  -55.971210 YMAX =  -55.971210 YAVE =  -55.971210
    ZMIN =   29.440387 ZMAX =   29.440387 ZAVE =   29.440387
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "15.0736769"
Evaluating: 15.0736769+3.5
 Parameter: XMAX <- "18.5736769"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-55.9712101"
Evaluating: -55.9712101+3.5
 Parameter: YMAX <- "-52.4712101"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "29.4403868"
Evaluating: 29.4403868+3.5
 Parameter: ZMAX <- "32.9403868"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "15.0736769"
Evaluating: 15.0736769-3.5
 Parameter: XMIN <- "11.5736769"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-55.9712101"
Evaluating: -55.9712101-3.5
 Parameter: YMIN <- "-59.4712101"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "29.4403868"
Evaluating: 29.4403868-3.5
 Parameter: ZMIN <- "25.9403868"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "18.5736769"
 Parameter: XMIN -> "11.5736769"
 Parameter: YMAX -> "-52.4712101"
 Parameter: YMIN -> "-59.4712101"
 Parameter: ZMAX -> "32.9403868"
 Parameter: ZMIN -> "25.9403868"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "83"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "83" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "83"
Evaluating: 83
 Parameter: J <- "83"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "83" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "83"
 Parameter: NPOS -> "53"
Evaluating: 83-53
 Parameter: J <- "30"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "30"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.596726321"
Evaluating: 120.112447*(0.596726321-0.5)
 Parameter: XPOS <- "11.6180351"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "8.283942542E-03"
Evaluating: 120.112447*(8.283942542E-03-0.5)
 Parameter: YPOS <- "-59.0612189"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.798882608"
Evaluating: 85*(0.798882608-0.5)+0
 Parameter: ZPOS <- "25.4050217"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "25.4050217" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "25.4050217" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "11.6180351"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 11.6180351-0
 Parameter: XTRAN <- "11.6180351"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-59.0612189"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -59.0612189-0
 Parameter: YTRAN <- "-59.0612189"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "25.4050217"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 25.4050217-0
 Parameter: ZTRAN <- "25.4050217"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "11.6180351"
 Parameter: YTRAN -> "-59.0612189"
 Parameter: ZTRAN -> "25.4050217"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    11.618035  -59.061219   25.405022
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.384271234"
Evaluating: 0.384271234*360.0
 Parameter: XPHI <- "138.337644"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.416892813"
Evaluating: 0.416892813*360.0
 Parameter: YPHI <- "150.081413"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.48230734"
Evaluating: 0.48230734*360.0
 Parameter: ZPHI <- "173.630642"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "11.6180351"
 Parameter: YPOS -> "-59.0612189"
 Parameter: ZPOS -> "25.4050217"
 Parameter: XPHI -> "138.337644"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.747075    0.664740
    0.000000   -0.664740   -0.747075

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  138.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "11.6180351"
 Parameter: YPOS -> "-59.0612189"
 Parameter: ZPOS -> "25.4050217"
 Parameter: YPHI -> "150.081413"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.866735    0.000000   -0.498769
    0.000000    1.000000    0.000000
    0.498769    0.000000   -0.866735

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  150.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "11.6180351"
 Parameter: YPOS -> "-59.0612189"
 Parameter: ZPOS -> "25.4050217"
 Parameter: ZPHI -> "173.630642"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.993827    0.110937    0.000000
   -0.110937   -0.993827    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  173.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   11.618035 XMAX =   11.618035 XAVE =   11.618035
    YMIN =  -59.061219 YMAX =  -59.061219 YAVE =  -59.061219
    ZMIN =   25.405022 ZMAX =   25.405022 ZAVE =   25.405022
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "11.6180351"
Evaluating: 11.6180351+3.5
 Parameter: XMAX <- "15.1180351"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-59.0612189"
Evaluating: -59.0612189+3.5
 Parameter: YMAX <- "-55.5612189"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "25.4050217"
Evaluating: 25.4050217+3.5
 Parameter: ZMAX <- "28.9050217"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "11.6180351"
Evaluating: 11.6180351-3.5
 Parameter: XMIN <- "8.1180351"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-59.0612189"
Evaluating: -59.0612189-3.5
 Parameter: YMIN <- "-62.5612189"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "25.4050217"
Evaluating: 25.4050217-3.5
 Parameter: ZMIN <- "21.9050217"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "15.1180351"
 Parameter: XMIN -> "8.1180351"
 Parameter: YMAX -> "-55.5612189"
 Parameter: YMIN -> "-62.5612189"
 Parameter: ZMAX -> "28.9050217"
 Parameter: ZMIN -> "21.9050217"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "84"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "84" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "84"
Evaluating: 84
 Parameter: J <- "84"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "84" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "84"
 Parameter: NPOS -> "53"
Evaluating: 84-53
 Parameter: J <- "31"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "31"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.714427351"
Evaluating: 120.112447*(0.714427351-0.5)
 Parameter: XPOS <- "25.7553938"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.81182797"
Evaluating: 120.112447*(0.81182797-0.5)
 Parameter: YPOS <- "37.4544205"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.859631757"
Evaluating: 85*(0.859631757-0.5)+0
 Parameter: ZPOS <- "30.5686993"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "30.5686993" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "30.5686993" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "25.7553938"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 25.7553938-0
 Parameter: XTRAN <- "25.7553938"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "37.4544205"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 37.4544205-0
 Parameter: YTRAN <- "37.4544205"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "30.5686993"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 30.5686993-0
 Parameter: ZTRAN <- "30.5686993"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "25.7553938"
 Parameter: YTRAN -> "37.4544205"
 Parameter: ZTRAN -> "30.5686993"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    25.755394   37.454420   30.568699
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.103538258"
Evaluating: 0.103538258*360.0
 Parameter: XPHI <- "37.2737729"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.343887295"
Evaluating: 0.343887295*360.0
 Parameter: YPHI <- "123.799426"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.266851467"
Evaluating: 0.266851467*360.0
 Parameter: ZPHI <- "96.0665281"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "25.7553938"
 Parameter: YPOS -> "37.4544205"
 Parameter: ZPOS -> "30.5686993"
 Parameter: XPHI -> "37.2737729"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.795751    0.605624
    0.000000   -0.605624    0.795751

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   37.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "25.7553938"
 Parameter: YPOS -> "37.4544205"
 Parameter: ZPOS -> "30.5686993"
 Parameter: YPHI -> "123.799426"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.556287    0.000000   -0.830990
    0.000000    1.000000    0.000000
    0.830990    0.000000   -0.556287

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  123.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "25.7553938"
 Parameter: YPOS -> "37.4544205"
 Parameter: ZPOS -> "30.5686993"
 Parameter: ZPHI -> "96.0665281"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.105683    0.994400    0.000000
   -0.994400   -0.105683    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   96.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   25.755394 XMAX =   25.755394 XAVE =   25.755394
    YMIN =   37.454420 YMAX =   37.454420 YAVE =   37.454420
    ZMIN =   30.568699 ZMAX =   30.568699 ZAVE =   30.568699
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "25.7553938"
Evaluating: 25.7553938+3.5
 Parameter: XMAX <- "29.2553938"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "37.4544205"
Evaluating: 37.4544205+3.5
 Parameter: YMAX <- "40.9544205"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "30.5686993"
Evaluating: 30.5686993+3.5
 Parameter: ZMAX <- "34.0686993"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "25.7553938"
Evaluating: 25.7553938-3.5
 Parameter: XMIN <- "22.2553938"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "37.4544205"
Evaluating: 37.4544205-3.5
 Parameter: YMIN <- "33.9544205"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "30.5686993"
Evaluating: 30.5686993-3.5
 Parameter: ZMIN <- "27.0686993"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "29.2553938"
 Parameter: XMIN -> "22.2553938"
 Parameter: YMAX -> "40.9544205"
 Parameter: YMIN -> "33.9544205"
 Parameter: ZMAX -> "34.0686993"
 Parameter: ZMIN -> "27.0686993"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "85"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "85" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "85"
Evaluating: 85
 Parameter: J <- "85"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "85" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "85"
 Parameter: NPOS -> "53"
Evaluating: 85-53
 Parameter: J <- "32"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "32"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.450951093"
Evaluating: 120.112447*(0.450951093-0.5)
 Parameter: XPOS <- "-5.89138424"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.509414817"
Evaluating: 120.112447*(0.509414817-0.5)
 Parameter: YPOS <- "1.13083671"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.707116224"
Evaluating: 85*(0.707116224-0.5)+0
 Parameter: ZPOS <- "17.604879"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "17.604879" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "17.604879" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-5.89138424"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -5.89138424-0
 Parameter: XTRAN <- "-5.89138424"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "1.13083671"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 1.13083671-0
 Parameter: YTRAN <- "1.13083671"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "17.604879"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 17.604879-0
 Parameter: ZTRAN <- "17.604879"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-5.89138424"
 Parameter: YTRAN -> "1.13083671"
 Parameter: ZTRAN -> "17.604879"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    -5.891384    1.130837   17.604879
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.810509179"
Evaluating: 0.810509179*360.0
 Parameter: XPHI <- "291.783304"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.303526566"
Evaluating: 0.303526566*360.0
 Parameter: YPHI <- "109.269564"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.942052458"
Evaluating: 0.942052458*360.0
 Parameter: ZPHI <- "339.138885"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-5.89138424"
 Parameter: YPOS -> "1.13083671"
 Parameter: ZPOS -> "17.604879"
 Parameter: XPHI -> "291.783304"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.371097   -0.928594
    0.000000    0.928594    0.371097

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   68.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-5.89138424"
 Parameter: YPOS -> "1.13083671"
 Parameter: ZPOS -> "17.604879"
 Parameter: YPHI -> "109.269564"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.330013    0.000000   -0.943976
    0.000000    1.000000    0.000000
    0.943976    0.000000   -0.330013

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  109.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-5.89138424"
 Parameter: YPOS -> "1.13083671"
 Parameter: ZPOS -> "17.604879"
 Parameter: ZPHI -> "339.138885"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.934446   -0.356104    0.000000
    0.356104    0.934446    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   20.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -5.891384 XMAX =   -5.891384 XAVE =   -5.891384
    YMIN =    1.130837 YMAX =    1.130837 YAVE =    1.130837
    ZMIN =   17.604879 ZMAX =   17.604879 ZAVE =   17.604879
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-5.89138424"
Evaluating: -5.89138424+3.5
 Parameter: XMAX <- "-2.39138424"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "1.13083671"
Evaluating: 1.13083671+3.5
 Parameter: YMAX <- "4.63083671"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "17.604879"
Evaluating: 17.604879+3.5
 Parameter: ZMAX <- "21.104879"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-5.89138424"
Evaluating: -5.89138424-3.5
 Parameter: XMIN <- "-9.39138424"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "1.13083671"
Evaluating: 1.13083671-3.5
 Parameter: YMIN <- "-2.36916329"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "17.604879"
Evaluating: 17.604879-3.5
 Parameter: ZMIN <- "14.104879"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-2.39138424"
 Parameter: XMIN -> "-9.39138424"
 Parameter: YMAX -> "4.63083671"
 Parameter: YMIN -> "-2.36916329"
 Parameter: ZMAX -> "21.104879"
 Parameter: ZMIN -> "14.104879"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      1 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
 5581 NEG      CL       32       CL      -  25 MEMB     DPPC     3        NC3           3.2336
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "85"
Evaluating: 85
 Parameter: J <- "85"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "85" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "85"
 Parameter: NPOS -> "53"
Evaluating: 85-53
 Parameter: J <- "32"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "32"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.57862245"
Evaluating: 120.112447*(0.57862245-0.5)
 Parameter: XPOS <- "9.44353486"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.212919869"
Evaluating: 120.112447*(0.212919869-0.5)
 Parameter: YPOS <- "-34.481897"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.726971939"
Evaluating: 85*(0.726971939-0.5)+0
 Parameter: ZPOS <- "19.2926148"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "19.2926148" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "19.2926148" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -5.891384 XMAX =   -5.891384 XAVE =   -5.891384
    YMIN =    1.130837 YMAX =    1.130837 YAVE =    1.130837
    ZMIN =   17.604879 ZMAX =   17.604879 ZAVE =   17.604879
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "9.44353486"
 RDCMND substituted energy or value "?XAVE" to "-5.89138424"
Evaluating: 9.44353486--5.89138424
 Parameter: XTRAN <- "15.3349191"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-34.481897"
 RDCMND substituted energy or value "?YAVE" to "1.13083671"
Evaluating: -34.481897-1.13083671
 Parameter: YTRAN <- "-35.6127337"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "19.2926148"
 RDCMND substituted energy or value "?ZAVE" to "17.604879"
Evaluating: 19.2926148-17.604879
 Parameter: ZTRAN <- "1.6877358"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "15.3349191"
 Parameter: YTRAN -> "-35.6127337"
 Parameter: ZTRAN -> "1.6877358"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    15.334919  -35.612734    1.687736
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.424567724"
Evaluating: 0.424567724*360.0
 Parameter: XPHI <- "152.844381"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.889850755"
Evaluating: 0.889850755*360.0
 Parameter: YPHI <- "320.346272"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.598001481"
Evaluating: 0.598001481*360.0
 Parameter: ZPHI <- "215.280533"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "9.44353486"
 Parameter: YPOS -> "-34.481897"
 Parameter: ZPOS -> "19.2926148"
 Parameter: XPHI -> "152.844381"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.889770    0.456409
    0.000000   -0.456409   -0.889770

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  152.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "9.44353486"
 Parameter: YPOS -> "-34.481897"
 Parameter: ZPOS -> "19.2926148"
 Parameter: YPHI -> "320.346272"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.769915    0.000000    0.638146
    0.000000    1.000000    0.000000
   -0.638146    0.000000    0.769915

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   39.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "9.44353486"
 Parameter: YPOS -> "-34.481897"
 Parameter: ZPOS -> "19.2926148"
 Parameter: ZPHI -> "215.280533"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.816334   -0.577580    0.000000
    0.577580   -0.816334    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  144.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    9.443535 XMAX =    9.443535 XAVE =    9.443535
    YMIN =  -34.481897 YMAX =  -34.481897 YAVE =  -34.481897
    ZMIN =   19.292615 ZMAX =   19.292615 ZAVE =   19.292615
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "9.44353487"
Evaluating: 9.44353487+3.5
 Parameter: XMAX <- "12.9435349"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-34.481897"
Evaluating: -34.481897+3.5
 Parameter: YMAX <- "-30.981897"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "19.2926148"
Evaluating: 19.2926148+3.5
 Parameter: ZMAX <- "22.7926148"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "9.44353487"
Evaluating: 9.44353487-3.5
 Parameter: XMIN <- "5.94353487"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-34.481897"
Evaluating: -34.481897-3.5
 Parameter: YMIN <- "-37.981897"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "19.2926148"
Evaluating: 19.2926148-3.5
 Parameter: ZMIN <- "15.7926148"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "12.9435349"
 Parameter: XMIN -> "5.94353487"
 Parameter: YMAX -> "-30.981897"
 Parameter: YMIN -> "-37.981897"
 Parameter: ZMAX -> "22.7926148"
 Parameter: ZMIN -> "15.7926148"
 SELRPN>      2 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      2 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
 5581 NEG      CL       32       CL      - 709 MEMB     DPPC     60       NC3           3.2278
 5581 NEG      CL       32       CL      - 769 MEMB     DPPC     65       NC3           2.6072
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "85"
Evaluating: 85
 Parameter: J <- "85"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "85" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "85"
 Parameter: NPOS -> "53"
Evaluating: 85-53
 Parameter: J <- "32"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "32"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.883797957"
Evaluating: 120.112447*(0.883797957-0.5)
 Parameter: XPOS <- "46.0989118"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.621195531"
Evaluating: 120.112447*(0.621195531-0.5)
 Parameter: YPOS <- "14.5570918"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.661345926"
Evaluating: 85*(0.661345926-0.5)+0
 Parameter: ZPOS <- "13.7144037"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "13.7144037" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "13.7144037" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "85"
Evaluating: 85
 Parameter: J <- "85"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "85" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "85"
 Parameter: NPOS -> "53"
Evaluating: 85-53
 Parameter: J <- "32"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "32"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.629176144"
Evaluating: 120.112447*(0.629176144-0.5)
 Parameter: XPOS <- "15.5156627"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.400196946"
Evaluating: 120.112447*(0.400196946-0.5)
 Parameter: YPOS <- "-11.987589"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.711278403"
Evaluating: 85*(0.711278403-0.5)+0
 Parameter: ZPOS <- "17.9586643"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "17.9586643" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "17.9586643" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    9.443535 XMAX =    9.443535 XAVE =    9.443535
    YMIN =  -34.481897 YMAX =  -34.481897 YAVE =  -34.481897
    ZMIN =   19.292615 ZMAX =   19.292615 ZAVE =   19.292615
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "15.5156627"
 RDCMND substituted energy or value "?XAVE" to "9.44353487"
Evaluating: 15.5156627-9.44353487
 Parameter: XTRAN <- "6.07212783"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-11.987589"
 RDCMND substituted energy or value "?YAVE" to "-34.481897"
Evaluating: -11.987589--34.481897
 Parameter: YTRAN <- "22.494308"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "17.9586643"
 RDCMND substituted energy or value "?ZAVE" to "19.2926148"
Evaluating: 17.9586643-19.2926148
 Parameter: ZTRAN <- "-1.3339505"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "6.07212783"
 Parameter: YTRAN -> "22.494308"
 Parameter: ZTRAN -> "-1.3339505"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR     6.072128   22.494308   -1.333951
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.200938176"
Evaluating: 0.200938176*360.0
 Parameter: XPHI <- "72.3377434"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.790754938"
Evaluating: 0.790754938*360.0
 Parameter: YPHI <- "284.671778"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.412772765"
Evaluating: 0.412772765*360.0
 Parameter: ZPHI <- "148.598195"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "15.5156627"
 Parameter: YPOS -> "-11.987589"
 Parameter: ZPOS -> "17.9586643"
 Parameter: XPHI -> "72.3377434"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.303405    0.952862
    0.000000   -0.952862    0.303405

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   72.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "15.5156627"
 Parameter: YPOS -> "-11.987589"
 Parameter: ZPOS -> "17.9586643"
 Parameter: YPHI -> "284.671778"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.253281    0.000000    0.967393
    0.000000    1.000000    0.000000
   -0.967393    0.000000    0.253281

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   75.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "15.5156627"
 Parameter: YPOS -> "-11.987589"
 Parameter: ZPOS -> "17.9586643"
 Parameter: ZPHI -> "148.598195"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.853534    0.521037    0.000000
   -0.521037   -0.853534    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  148.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   15.515663 XMAX =   15.515663 XAVE =   15.515663
    YMIN =  -11.987589 YMAX =  -11.987589 YAVE =  -11.987589
    ZMIN =   17.958664 ZMAX =   17.958664 ZAVE =   17.958664
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "15.5156627"
Evaluating: 15.5156627+3.5
 Parameter: XMAX <- "19.0156627"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-11.987589"
Evaluating: -11.987589+3.5
 Parameter: YMAX <- "-8.487589"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "17.9586643"
Evaluating: 17.9586643+3.5
 Parameter: ZMAX <- "21.4586643"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "15.5156627"
Evaluating: 15.5156627-3.5
 Parameter: XMIN <- "12.0156627"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-11.987589"
Evaluating: -11.987589-3.5
 Parameter: YMIN <- "-15.487589"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "17.9586643"
Evaluating: 17.9586643-3.5
 Parameter: ZMIN <- "14.4586643"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "19.0156627"
 Parameter: XMIN -> "12.0156627"
 Parameter: YMAX -> "-8.487589"
 Parameter: YMIN -> "-15.487589"
 Parameter: ZMAX -> "21.4586643"
 Parameter: ZMIN -> "14.4586643"
 SELRPN>      2 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      2 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
 5581 NEG      CL       32       CL      - 254 MEMB     DPPC     22       PO4           1.6246
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "85"
Evaluating: 85
 Parameter: J <- "85"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "85" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "85"
 Parameter: NPOS -> "53"
Evaluating: 85-53
 Parameter: J <- "32"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "32"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.646548726"
Evaluating: 120.112447*(0.646548726-0.5)
 Parameter: XPOS <- "17.6023261"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.592649283"
Evaluating: 120.112447*(0.592649283-0.5)
 Parameter: YPOS <- "11.1283321"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.260385679"
Evaluating: 85*(0.260385679-0.5)+0
 Parameter: ZPOS <- "-20.3672173"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-20.3672173" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   15.515663 XMAX =   15.515663 XAVE =   15.515663
    YMIN =  -11.987589 YMAX =  -11.987589 YAVE =  -11.987589
    ZMIN =   17.958664 ZMAX =   17.958664 ZAVE =   17.958664
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "17.6023261"
 RDCMND substituted energy or value "?XAVE" to "15.5156627"
Evaluating: 17.6023261-15.5156627
 Parameter: XTRAN <- "2.0866634"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "11.1283321"
 RDCMND substituted energy or value "?YAVE" to "-11.987589"
Evaluating: 11.1283321--11.987589
 Parameter: YTRAN <- "23.1159211"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-20.3672173"
 RDCMND substituted energy or value "?ZAVE" to "17.9586643"
Evaluating: -20.3672173-17.9586643
 Parameter: ZTRAN <- "-38.3258816"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "2.0866634"
 Parameter: YTRAN -> "23.1159211"
 Parameter: ZTRAN -> "-38.3258816"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR     2.086663   23.115921  -38.325882
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.457685256"
Evaluating: 0.457685256*360.0
 Parameter: XPHI <- "164.766692"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.470933774"
Evaluating: 0.470933774*360.0
 Parameter: YPHI <- "169.536159"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.870888422"
Evaluating: 0.870888422*360.0
 Parameter: ZPHI <- "313.519832"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "17.6023261"
 Parameter: YPOS -> "11.1283321"
 Parameter: ZPOS -> "-20.3672173"
 Parameter: XPHI -> "164.766692"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.964864    0.262750
    0.000000   -0.262750   -0.964864

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  164.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "17.6023261"
 Parameter: YPOS -> "11.1283321"
 Parameter: ZPOS -> "-20.3672173"
 Parameter: YPHI -> "169.536159"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.983370    0.000000   -0.181615
    0.000000    1.000000    0.000000
    0.181615    0.000000   -0.983370

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  169.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "17.6023261"
 Parameter: YPOS -> "11.1283321"
 Parameter: ZPOS -> "-20.3672173"
 Parameter: ZPHI -> "313.519832"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.688606   -0.725136    0.000000
    0.725136    0.688606    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   46.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   17.602326 XMAX =   17.602326 XAVE =   17.602326
    YMIN =   11.128332 YMAX =   11.128332 YAVE =   11.128332
    ZMIN =  -20.367217 ZMAX =  -20.367217 ZAVE =  -20.367217
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "17.6023261"
Evaluating: 17.6023261+3.5
 Parameter: XMAX <- "21.1023261"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "11.1283321"
Evaluating: 11.1283321+3.5
 Parameter: YMAX <- "14.6283321"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-20.3672173"
Evaluating: -20.3672173+3.5
 Parameter: ZMAX <- "-16.8672173"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "17.6023261"
Evaluating: 17.6023261-3.5
 Parameter: XMIN <- "14.1023261"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "11.1283321"
Evaluating: 11.1283321-3.5
 Parameter: YMIN <- "7.6283321"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-20.3672173"
Evaluating: -20.3672173-3.5
 Parameter: ZMIN <- "-23.8672173"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "21.1023261"
 Parameter: XMIN -> "14.1023261"
 Parameter: YMAX -> "14.6283321"
 Parameter: YMIN -> "7.6283321"
 Parameter: ZMAX -> "-16.8672173"
 Parameter: ZMIN -> "-23.8672173"
 SELRPN>      3 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      3 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
 5581 NEG      CL       32       CL      -3025 MEMB     DPPC     253      NC3           3.0290
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "5"
Evaluating: 5+1
 Parameter: CNTRAND <- "6"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "6" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "85"
Evaluating: 85
 Parameter: J <- "85"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "85" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "85"
 Parameter: NPOS -> "53"
Evaluating: 85-53
 Parameter: J <- "32"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "32"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.575902686"
Evaluating: 120.112447*(0.575902686-0.5)
 Parameter: XPOS <- "9.11685735"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.42111099"
Evaluating: 120.112447*(0.42111099-0.5)
 Parameter: YPOS <- "-9.47555203"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.843528503"
Evaluating: 85*(0.843528503-0.5)+0
 Parameter: ZPOS <- "29.1999228"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "29.1999228" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "29.1999228" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   17.602326 XMAX =   17.602326 XAVE =   17.602326
    YMIN =   11.128332 YMAX =   11.128332 YAVE =   11.128332
    ZMIN =  -20.367217 ZMAX =  -20.367217 ZAVE =  -20.367217
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "9.11685735"
 RDCMND substituted energy or value "?XAVE" to "17.6023261"
Evaluating: 9.11685735-17.6023261
 Parameter: XTRAN <- "-8.48546875"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-9.47555203"
 RDCMND substituted energy or value "?YAVE" to "11.1283321"
Evaluating: -9.47555203-11.1283321
 Parameter: YTRAN <- "-20.6038841"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "29.1999228"
 RDCMND substituted energy or value "?ZAVE" to "-20.3672173"
Evaluating: 29.1999228--20.3672173
 Parameter: ZTRAN <- "49.5671401"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-8.48546875"
 Parameter: YTRAN -> "-20.6038841"
 Parameter: ZTRAN -> "49.5671401"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    -8.485469  -20.603884   49.567140
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.654053658"
Evaluating: 0.654053658*360.0
 Parameter: XPHI <- "235.459317"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.926733233"
Evaluating: 0.926733233*360.0
 Parameter: YPHI <- "333.623964"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.184683351"
Evaluating: 0.184683351*360.0
 Parameter: ZPHI <- "66.4860064"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "9.11685735"
 Parameter: YPOS -> "-9.47555203"
 Parameter: ZPOS -> "29.1999228"
 Parameter: XPHI -> "235.459317"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.566991   -0.823724
    0.000000    0.823724   -0.566991

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  124.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "9.11685735"
 Parameter: YPOS -> "-9.47555203"
 Parameter: ZPOS -> "29.1999228"
 Parameter: YPHI -> "333.623964"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.895898    0.000000    0.444261
    0.000000    1.000000    0.000000
   -0.444261    0.000000    0.895898

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   26.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "9.11685735"
 Parameter: YPOS -> "-9.47555203"
 Parameter: ZPOS -> "29.1999228"
 Parameter: ZPHI -> "66.4860064"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.398973    0.916963    0.000000
   -0.916963    0.398973    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   66.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    9.116857 XMAX =    9.116857 XAVE =    9.116857
    YMIN =   -9.475552 YMAX =   -9.475552 YAVE =   -9.475552
    ZMIN =   29.199923 ZMAX =   29.199923 ZAVE =   29.199923
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "9.11685734"
Evaluating: 9.11685734+3.5
 Parameter: XMAX <- "12.6168573"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-9.47555204"
Evaluating: -9.47555204+3.5
 Parameter: YMAX <- "-5.97555204"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "29.1999228"
Evaluating: 29.1999228+3.5
 Parameter: ZMAX <- "32.6999228"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "9.11685734"
Evaluating: 9.11685734-3.5
 Parameter: XMIN <- "5.61685734"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-9.47555204"
Evaluating: -9.47555204-3.5
 Parameter: YMIN <- "-12.975552"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "29.1999228"
Evaluating: 29.1999228-3.5
 Parameter: ZMIN <- "25.6999228"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "12.6168573"
 Parameter: XMIN -> "5.61685734"
 Parameter: YMAX -> "-5.97555204"
 Parameter: YMIN -> "-12.975552"
 Parameter: ZMAX -> "32.6999228"
 Parameter: ZMIN -> "25.6999228"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "86"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "86" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "86"
Evaluating: 86
 Parameter: J <- "86"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "86" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "86"
 Parameter: NPOS -> "53"
Evaluating: 86-53
 Parameter: J <- "33"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "33"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "1.932221527E-02"
Evaluating: 120.112447*(1.932221527E-02-0.5)
 Parameter: XPOS <- "-57.7353849"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.937401108"
Evaluating: 120.112447*(0.937401108-0.5)
 Parameter: YPOS <- "52.5373174"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.521676811"
Evaluating: 85*(0.521676811-0.5)+0
 Parameter: ZPOS <- "1.84252894"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "1.84252894" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "1.84252894" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "86"
Evaluating: 86
 Parameter: J <- "86"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "86" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "86"
 Parameter: NPOS -> "53"
Evaluating: 86-53
 Parameter: J <- "33"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "33"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.223506404"
Evaluating: 120.112447*(0.223506404-0.5)
 Parameter: XPOS <- "-33.2103224"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.386277218"
Evaluating: 120.112447*(0.386277218-0.5)
 Parameter: YPOS <- "-13.6595216"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "8.055116752E-03"
Evaluating: 85*(8.055116752E-03-0.5)+0
 Parameter: ZPOS <- "-41.8153151"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-41.8153151" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-33.2103224"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -33.2103224-0
 Parameter: XTRAN <- "-33.2103224"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-13.6595216"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -13.6595216-0
 Parameter: YTRAN <- "-13.6595216"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-41.8153151"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -41.8153151-0
 Parameter: ZTRAN <- "-41.8153151"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-33.2103224"
 Parameter: YTRAN -> "-13.6595216"
 Parameter: ZTRAN -> "-41.8153151"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR   -33.210322  -13.659522  -41.815315
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.366701508"
Evaluating: 0.366701508*360.0
 Parameter: XPHI <- "132.012543"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.672996052"
Evaluating: 0.672996052*360.0
 Parameter: YPHI <- "242.278579"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.791876796"
Evaluating: 0.791876796*360.0
 Parameter: ZPHI <- "285.075647"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-33.2103224"
 Parameter: YPOS -> "-13.6595216"
 Parameter: ZPOS -> "-41.8153151"
 Parameter: XPHI -> "132.012543"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.669293    0.742998
    0.000000   -0.742998   -0.669293

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  132.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-33.2103224"
 Parameter: YPOS -> "-13.6595216"
 Parameter: ZPOS -> "-41.8153151"
 Parameter: YPHI -> "242.278579"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.465173    0.000000    0.885220
    0.000000    1.000000    0.000000
   -0.885220    0.000000   -0.465173

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  117.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-33.2103224"
 Parameter: YPOS -> "-13.6595216"
 Parameter: ZPOS -> "-41.8153151"
 Parameter: ZPHI -> "285.075647"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.260094   -0.965583    0.000000
    0.965583    0.260094    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   74.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -33.210322 XMAX =  -33.210322 XAVE =  -33.210322
    YMIN =  -13.659522 YMAX =  -13.659522 YAVE =  -13.659522
    ZMIN =  -41.815315 ZMAX =  -41.815315 ZAVE =  -41.815315
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-33.2103224"
Evaluating: -33.2103224+3.5
 Parameter: XMAX <- "-29.7103224"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-13.6595216"
Evaluating: -13.6595216+3.5
 Parameter: YMAX <- "-10.1595216"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-41.8153151"
Evaluating: -41.8153151+3.5
 Parameter: ZMAX <- "-38.3153151"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-33.2103224"
Evaluating: -33.2103224-3.5
 Parameter: XMIN <- "-36.7103224"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-13.6595216"
Evaluating: -13.6595216-3.5
 Parameter: YMIN <- "-17.1595216"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-41.8153151"
Evaluating: -41.8153151-3.5
 Parameter: ZMIN <- "-45.3153151"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-29.7103224"
 Parameter: XMIN -> "-36.7103224"
 Parameter: YMAX -> "-10.1595216"
 Parameter: YMIN -> "-17.1595216"
 Parameter: ZMAX -> "-38.3153151"
 Parameter: ZMIN -> "-45.3153151"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "87"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "87" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "87"
Evaluating: 87
 Parameter: J <- "87"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "87" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "87"
 Parameter: NPOS -> "53"
Evaluating: 87-53
 Parameter: J <- "34"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "34"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.910794347"
Evaluating: 120.112447*(0.910794347-0.5)
 Parameter: XPOS <- "49.3415142"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.574577212"
Evaluating: 120.112447*(0.574577212-0.5)
 Parameter: YPOS <- "8.95765142"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.884673685"
Evaluating: 85*(0.884673685-0.5)+0
 Parameter: ZPOS <- "32.6972632"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "32.6972632" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "32.6972632" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "49.3415142"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 49.3415142-0
 Parameter: XTRAN <- "49.3415142"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "8.95765142"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 8.95765142-0
 Parameter: YTRAN <- "8.95765142"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "32.6972632"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 32.6972632-0
 Parameter: ZTRAN <- "32.6972632"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "49.3415142"
 Parameter: YTRAN -> "8.95765142"
 Parameter: ZTRAN -> "32.6972632"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    49.341514    8.957651   32.697263
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.851422061"
Evaluating: 0.851422061*360.0
 Parameter: XPHI <- "306.511942"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.262939137"
Evaluating: 0.262939137*360.0
 Parameter: YPHI <- "94.6580893"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.527656928"
Evaluating: 0.527656928*360.0
 Parameter: ZPHI <- "189.956494"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "49.3415142"
 Parameter: YPOS -> "8.95765142"
 Parameter: ZPOS -> "32.6972632"
 Parameter: XPHI -> "306.511942"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.594990   -0.803733
    0.000000    0.803733    0.594990

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   53.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "49.3415142"
 Parameter: YPOS -> "8.95765142"
 Parameter: ZPOS -> "32.6972632"
 Parameter: YPHI -> "94.6580893"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.081209    0.000000   -0.996697
    0.000000    1.000000    0.000000
    0.996697    0.000000   -0.081209

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   94.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "49.3415142"
 Parameter: YPOS -> "8.95765142"
 Parameter: ZPOS -> "32.6972632"
 Parameter: ZPHI -> "189.956494"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.984939   -0.172900    0.000000
    0.172900   -0.984939    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  170.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   49.341514 XMAX =   49.341514 XAVE =   49.341514
    YMIN =    8.957651 YMAX =    8.957651 YAVE =    8.957651
    ZMIN =   32.697263 ZMAX =   32.697263 ZAVE =   32.697263
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "49.3415142"
Evaluating: 49.3415142+3.5
 Parameter: XMAX <- "52.8415142"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "8.95765142"
Evaluating: 8.95765142+3.5
 Parameter: YMAX <- "12.4576514"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "32.6972632"
Evaluating: 32.6972632+3.5
 Parameter: ZMAX <- "36.1972632"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "49.3415142"
Evaluating: 49.3415142-3.5
 Parameter: XMIN <- "45.8415142"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "8.95765142"
Evaluating: 8.95765142-3.5
 Parameter: YMIN <- "5.45765142"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "32.6972632"
Evaluating: 32.6972632-3.5
 Parameter: ZMIN <- "29.1972632"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "52.8415142"
 Parameter: XMIN -> "45.8415142"
 Parameter: YMAX -> "12.4576514"
 Parameter: YMIN -> "5.45765142"
 Parameter: ZMAX -> "36.1972632"
 Parameter: ZMIN -> "29.1972632"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "88"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "88" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "88"
Evaluating: 88
 Parameter: J <- "88"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "88" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "88"
 Parameter: NPOS -> "53"
Evaluating: 88-53
 Parameter: J <- "35"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "35"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.851761382"
Evaluating: 120.112447*(0.851761382-0.5)
 Parameter: XPOS <- "42.2509204"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.920862553"
Evaluating: 120.112447*(0.920862553-0.5)
 Parameter: YPOS <- "50.5508311"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.62735976"
Evaluating: 85*(0.62735976-0.5)+0
 Parameter: ZPOS <- "10.8255796"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "10.8255796" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "10.8255796" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "88"
Evaluating: 88
 Parameter: J <- "88"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "88" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "88"
 Parameter: NPOS -> "53"
Evaluating: 88-53
 Parameter: J <- "35"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "35"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.771730316"
Evaluating: 120.112447*(0.771730316-0.5)
 Parameter: XPOS <- "32.6381932"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.892195173"
Evaluating: 120.112447*(0.892195173-0.5)
 Parameter: YPOS <- "47.1075219"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.846739415"
Evaluating: 85*(0.846739415-0.5)+0
 Parameter: ZPOS <- "29.4728503"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "29.4728503" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "29.4728503" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "32.6381932"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 32.6381932-0
 Parameter: XTRAN <- "32.6381932"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "47.1075219"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 47.1075219-0
 Parameter: YTRAN <- "47.1075219"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "29.4728503"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 29.4728503-0
 Parameter: ZTRAN <- "29.4728503"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "32.6381932"
 Parameter: YTRAN -> "47.1075219"
 Parameter: ZTRAN -> "29.4728503"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    32.638193   47.107522   29.472850
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.619111554"
Evaluating: 0.619111554*360.0
 Parameter: XPHI <- "222.880159"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.236614179"
Evaluating: 0.236614179*360.0
 Parameter: YPHI <- "85.1811044"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.661028761"
Evaluating: 0.661028761*360.0
 Parameter: ZPHI <- "237.970354"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "32.6381932"
 Parameter: YPOS -> "47.1075219"
 Parameter: ZPOS -> "29.4728503"
 Parameter: XPHI -> "222.880159"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.732779   -0.680467
    0.000000    0.680467   -0.732779

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  137.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "32.6381932"
 Parameter: YPOS -> "47.1075219"
 Parameter: ZPOS -> "29.4728503"
 Parameter: YPHI -> "85.1811044"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.084006    0.000000   -0.996465
    0.000000    1.000000    0.000000
    0.996465    0.000000    0.084006

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   85.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "32.6381932"
 Parameter: YPOS -> "47.1075219"
 Parameter: ZPOS -> "29.4728503"
 Parameter: ZPHI -> "237.970354"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.530358   -0.847774    0.000000
    0.847774   -0.530358    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  122.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   32.638193 XMAX =   32.638193 XAVE =   32.638193
    YMIN =   47.107522 YMAX =   47.107522 YAVE =   47.107522
    ZMIN =   29.472850 ZMAX =   29.472850 ZAVE =   29.472850
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "32.6381932"
Evaluating: 32.6381932+3.5
 Parameter: XMAX <- "36.1381932"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "47.1075219"
Evaluating: 47.1075219+3.5
 Parameter: YMAX <- "50.6075219"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "29.4728503"
Evaluating: 29.4728503+3.5
 Parameter: ZMAX <- "32.9728503"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "32.6381932"
Evaluating: 32.6381932-3.5
 Parameter: XMIN <- "29.1381932"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "47.1075219"
Evaluating: 47.1075219-3.5
 Parameter: YMIN <- "43.6075219"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "29.4728503"
Evaluating: 29.4728503-3.5
 Parameter: ZMIN <- "25.9728503"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "36.1381932"
 Parameter: XMIN -> "29.1381932"
 Parameter: YMAX -> "50.6075219"
 Parameter: YMIN -> "43.6075219"
 Parameter: ZMAX -> "32.9728503"
 Parameter: ZMIN -> "25.9728503"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "89"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "89" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "89"
Evaluating: 89
 Parameter: J <- "89"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "89" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "89"
 Parameter: NPOS -> "53"
Evaluating: 89-53
 Parameter: J <- "36"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "36"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.467956845"
Evaluating: 120.112447*(0.467956845-0.5)
 Parameter: XPOS <- "-3.84878176"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.257857226"
Evaluating: 120.112447*(0.257857226-0.5)
 Parameter: YPOS <- "-29.0843611"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "4.192729325E-02"
Evaluating: 85*(4.192729325E-02-0.5)+0
 Parameter: ZPOS <- "-38.9361801"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-38.9361801" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-3.84878176"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -3.84878176-0
 Parameter: XTRAN <- "-3.84878176"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-29.0843611"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -29.0843611-0
 Parameter: YTRAN <- "-29.0843611"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-38.9361801"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -38.9361801-0
 Parameter: ZTRAN <- "-38.9361801"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-3.84878176"
 Parameter: YTRAN -> "-29.0843611"
 Parameter: ZTRAN -> "-38.9361801"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    -3.848782  -29.084361  -38.936180
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.593546826"
Evaluating: 0.593546826*360.0
 Parameter: XPHI <- "213.676857"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.621336513"
Evaluating: 0.621336513*360.0
 Parameter: YPHI <- "223.681145"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.489726415"
Evaluating: 0.489726415*360.0
 Parameter: ZPHI <- "176.301509"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-3.84878176"
 Parameter: YPOS -> "-29.0843611"
 Parameter: ZPOS -> "-38.9361801"
 Parameter: XPHI -> "213.676857"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.832178   -0.554508
    0.000000    0.554508   -0.832178

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  146.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-3.84878176"
 Parameter: YPOS -> "-29.0843611"
 Parameter: ZPOS -> "-38.9361801"
 Parameter: YPHI -> "223.681145"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.723194    0.000000    0.690644
    0.000000    1.000000    0.000000
   -0.690644    0.000000   -0.723194

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  136.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-3.84878176"
 Parameter: YPOS -> "-29.0843611"
 Parameter: ZPOS -> "-38.9361801"
 Parameter: ZPHI -> "176.301509"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.997917    0.064506    0.000000
   -0.064506   -0.997917    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  176.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -3.848782 XMAX =   -3.848782 XAVE =   -3.848782
    YMIN =  -29.084361 YMAX =  -29.084361 YAVE =  -29.084361
    ZMIN =  -38.936180 ZMAX =  -38.936180 ZAVE =  -38.936180
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-3.84878176"
Evaluating: -3.84878176+3.5
 Parameter: XMAX <- "-0.34878176"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-29.0843611"
Evaluating: -29.0843611+3.5
 Parameter: YMAX <- "-25.5843611"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-38.9361801"
Evaluating: -38.9361801+3.5
 Parameter: ZMAX <- "-35.4361801"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-3.84878176"
Evaluating: -3.84878176-3.5
 Parameter: XMIN <- "-7.34878176"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-29.0843611"
Evaluating: -29.0843611-3.5
 Parameter: YMIN <- "-32.5843611"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-38.9361801"
Evaluating: -38.9361801-3.5
 Parameter: ZMIN <- "-42.4361801"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-0.34878176"
 Parameter: XMIN -> "-7.34878176"
 Parameter: YMAX -> "-25.5843611"
 Parameter: YMIN -> "-32.5843611"
 Parameter: ZMAX -> "-35.4361801"
 Parameter: ZMIN -> "-42.4361801"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "90"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "90" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "90"
Evaluating: 90
 Parameter: J <- "90"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "90" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "90"
 Parameter: NPOS -> "53"
Evaluating: 90-53
 Parameter: J <- "37"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "37"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.364948571"
Evaluating: 120.112447*(0.364948571-0.5)
 Parameter: XPOS <- "-16.2213576"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.826413325"
Evaluating: 120.112447*(0.826413325-0.5)
 Parameter: YPOS <- "39.2063032"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.49605825"
Evaluating: 85*(0.49605825-0.5)+0
 Parameter: ZPOS <- "-0.33504875"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-0.33504875" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-0.33504875" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "90"
Evaluating: 90
 Parameter: J <- "90"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "90" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "90"
 Parameter: NPOS -> "53"
Evaluating: 90-53
 Parameter: J <- "37"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "37"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "9.039583271E-02"
Evaluating: 120.112447*(9.039583271E-02-0.5)
 Parameter: XPOS <- "-49.1985588"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.583160802"
Evaluating: 120.112447*(0.583160802-0.5)
 Parameter: YPOS <- "9.98864742"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.320006381"
Evaluating: 85*(0.320006381-0.5)+0
 Parameter: ZPOS <- "-15.2994576"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-15.2994576" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-49.1985588"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -49.1985588-0
 Parameter: XTRAN <- "-49.1985588"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "9.98864742"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 9.98864742-0
 Parameter: YTRAN <- "9.98864742"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-15.2994576"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -15.2994576-0
 Parameter: ZTRAN <- "-15.2994576"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-49.1985588"
 Parameter: YTRAN -> "9.98864742"
 Parameter: ZTRAN -> "-15.2994576"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR   -49.198559    9.988647  -15.299458
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.368496856"
Evaluating: 0.368496856*360.0
 Parameter: XPHI <- "132.658868"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.996938845"
Evaluating: 0.996938845*360.0
 Parameter: YPHI <- "358.897984"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.903997169"
Evaluating: 0.903997169*360.0
 Parameter: ZPHI <- "325.438981"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-49.1985588"
 Parameter: YPOS -> "9.98864742"
 Parameter: ZPOS -> "-15.2994576"
 Parameter: XPHI -> "132.658868"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.677632    0.735401
    0.000000   -0.735401   -0.677632

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  132.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-49.1985588"
 Parameter: YPOS -> "9.98864742"
 Parameter: ZPOS -> "-15.2994576"
 Parameter: YPHI -> "358.897984"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.999815    0.000000    0.019233
    0.000000    1.000000    0.000000
   -0.019233    0.000000    0.999815

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    1.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-49.1985588"
 Parameter: YPOS -> "9.98864742"
 Parameter: ZPOS -> "-15.2994576"
 Parameter: ZPHI -> "325.438981"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.823523   -0.567284    0.000000
    0.567284    0.823523    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   34.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -49.198559 XMAX =  -49.198559 XAVE =  -49.198559
    YMIN =    9.988647 YMAX =    9.988647 YAVE =    9.988647
    ZMIN =  -15.299458 ZMAX =  -15.299458 ZAVE =  -15.299458
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-49.1985588"
Evaluating: -49.1985588+3.5
 Parameter: XMAX <- "-45.6985588"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "9.98864742"
Evaluating: 9.98864742+3.5
 Parameter: YMAX <- "13.4886474"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-15.2994576"
Evaluating: -15.2994576+3.5
 Parameter: ZMAX <- "-11.7994576"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-49.1985588"
Evaluating: -49.1985588-3.5
 Parameter: XMIN <- "-52.6985588"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "9.98864742"
Evaluating: 9.98864742-3.5
 Parameter: YMIN <- "6.48864742"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-15.2994576"
Evaluating: -15.2994576-3.5
 Parameter: ZMIN <- "-18.7994576"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-45.6985588"
 Parameter: XMIN -> "-52.6985588"
 Parameter: YMAX -> "13.4886474"
 Parameter: YMIN -> "6.48864742"
 Parameter: ZMAX -> "-11.7994576"
 Parameter: ZMIN -> "-18.7994576"
 SELRPN>      3 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      3 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
 5586 NEG      CL       37       CL      -4322 MEMB     DPPC     361      PO4           2.6189
 5586 NEG      CL       37       CL      -4323 MEMB     DPPC     361      GL1           2.0398
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "90"
Evaluating: 90
 Parameter: J <- "90"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "90" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "90"
 Parameter: NPOS -> "53"
Evaluating: 90-53
 Parameter: J <- "37"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "37"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.142868193"
Evaluating: 120.112447*(0.142868193-0.5)
 Parameter: XPOS <- "-42.8959752"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.475593175"
Evaluating: 120.112447*(0.475593175-0.5)
 Parameter: YPOS <- "-2.93156347"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.669141378"
Evaluating: 85*(0.669141378-0.5)+0
 Parameter: ZPOS <- "14.3770171"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "14.3770171" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "14.3770171" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "90"
Evaluating: 90
 Parameter: J <- "90"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "90" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "90"
 Parameter: NPOS -> "53"
Evaluating: 90-53
 Parameter: J <- "37"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "37"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.169914545"
Evaluating: 120.112447*(0.169914545-0.5)
 Parameter: XPOS <- "-39.6473717"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.47695286"
Evaluating: 120.112447*(0.47695286-0.5)
 Parameter: YPOS <- "-2.76824838"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.991987389"
Evaluating: 85*(0.991987389-0.5)+0
 Parameter: ZPOS <- "41.8189281"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "41.8189281" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "41.8189281" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -49.198559 XMAX =  -49.198559 XAVE =  -49.198559
    YMIN =    9.988647 YMAX =    9.988647 YAVE =    9.988647
    ZMIN =  -15.299458 ZMAX =  -15.299458 ZAVE =  -15.299458
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-39.6473717"
 RDCMND substituted energy or value "?XAVE" to "-49.1985588"
Evaluating: -39.6473717--49.1985588
 Parameter: XTRAN <- "9.5511871"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-2.76824838"
 RDCMND substituted energy or value "?YAVE" to "9.98864742"
Evaluating: -2.76824838-9.98864742
 Parameter: YTRAN <- "-12.7568958"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "41.8189281"
 RDCMND substituted energy or value "?ZAVE" to "-15.2994576"
Evaluating: 41.8189281--15.2994576
 Parameter: ZTRAN <- "57.1183857"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "9.5511871"
 Parameter: YTRAN -> "-12.7568958"
 Parameter: ZTRAN -> "57.1183857"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR     9.551187  -12.756896   57.118386
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.223650351"
Evaluating: 0.223650351*360.0
 Parameter: XPHI <- "80.5141264"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.891369734"
Evaluating: 0.891369734*360.0
 Parameter: YPHI <- "320.893104"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.416731541"
Evaluating: 0.416731541*360.0
 Parameter: ZPHI <- "150.023355"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-39.6473717"
 Parameter: YPOS -> "-2.76824838"
 Parameter: ZPOS -> "41.8189281"
 Parameter: XPHI -> "80.5141264"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.164804    0.986326
    0.000000   -0.986326    0.164804

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   80.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-39.6473717"
 Parameter: YPOS -> "-2.76824838"
 Parameter: ZPOS -> "41.8189281"
 Parameter: YPHI -> "320.893104"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.775970    0.000000    0.630769
    0.000000    1.000000    0.000000
   -0.630769    0.000000    0.775970

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   39.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-39.6473717"
 Parameter: YPOS -> "-2.76824838"
 Parameter: ZPOS -> "41.8189281"
 Parameter: ZPHI -> "150.023355"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.866229    0.499647    0.000000
   -0.499647   -0.866229    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  150.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -39.647372 XMAX =  -39.647372 XAVE =  -39.647372
    YMIN =   -2.768248 YMAX =   -2.768248 YAVE =   -2.768248
    ZMIN =   41.818928 ZMAX =   41.818928 ZAVE =   41.818928
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-39.6473717"
Evaluating: -39.6473717+3.5
 Parameter: XMAX <- "-36.1473717"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-2.76824838"
Evaluating: -2.76824838+3.5
 Parameter: YMAX <- "0.73175162"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "41.8189281"
Evaluating: 41.8189281+3.5
 Parameter: ZMAX <- "45.3189281"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-39.6473717"
Evaluating: -39.6473717-3.5
 Parameter: XMIN <- "-43.1473717"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-2.76824838"
Evaluating: -2.76824838-3.5
 Parameter: YMIN <- "-6.26824838"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "41.8189281"
Evaluating: 41.8189281-3.5
 Parameter: ZMIN <- "38.3189281"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-36.1473717"
 Parameter: XMIN -> "-43.1473717"
 Parameter: YMAX -> "0.73175162"
 Parameter: YMIN -> "-6.26824838"
 Parameter: ZMAX -> "45.3189281"
 Parameter: ZMIN -> "38.3189281"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "91"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "91" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "91"
Evaluating: 91
 Parameter: J <- "91"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "91" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "91"
 Parameter: NPOS -> "53"
Evaluating: 91-53
 Parameter: J <- "38"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "38"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "3.951057936E-02"
Evaluating: 120.112447*(3.951057936E-02-0.5)
 Parameter: XPOS <- "-55.3105111"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "3.538303484E-02"
Evaluating: 120.112447*(3.538303484E-02-0.5)
 Parameter: YPOS <- "-55.8062806"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.561776605"
Evaluating: 85*(0.561776605-0.5)+0
 Parameter: ZPOS <- "5.25101142"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "5.25101142" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "5.25101142" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "91"
Evaluating: 91
 Parameter: J <- "91"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "91" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "91"
 Parameter: NPOS -> "53"
Evaluating: 91-53
 Parameter: J <- "38"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "38"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.743027776"
Evaluating: 120.112447*(0.743027776-0.5)
 Parameter: XPOS <- "29.1906609"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.880817734"
Evaluating: 120.112447*(0.880817734-0.5)
 Parameter: YPOS <- "45.7409499"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.322551019"
Evaluating: 85*(0.322551019-0.5)+0
 Parameter: ZPOS <- "-15.0831634"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-15.0831634" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "29.1906609"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 29.1906609-0
 Parameter: XTRAN <- "29.1906609"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "45.7409499"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 45.7409499-0
 Parameter: YTRAN <- "45.7409499"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-15.0831634"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -15.0831634-0
 Parameter: ZTRAN <- "-15.0831634"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "29.1906609"
 Parameter: YTRAN -> "45.7409499"
 Parameter: ZTRAN -> "-15.0831634"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    29.190661   45.740950  -15.083163
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.644220754"
Evaluating: 0.644220754*360.0
 Parameter: XPHI <- "231.919471"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.208499476"
Evaluating: 0.208499476*360.0
 Parameter: YPHI <- "75.0598114"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.107888227"
Evaluating: 0.107888227*360.0
 Parameter: ZPHI <- "38.8397617"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "29.1906609"
 Parameter: YPOS -> "45.7409499"
 Parameter: ZPOS -> "-15.0831634"
 Parameter: XPHI -> "231.919471"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.616768   -0.787145
    0.000000    0.787145   -0.616768

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  128.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "29.1906609"
 Parameter: YPOS -> "45.7409499"
 Parameter: ZPOS -> "-15.0831634"
 Parameter: YPHI -> "75.0598114"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.257811    0.000000   -0.966195
    0.000000    1.000000    0.000000
    0.966195    0.000000    0.257811

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   75.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "29.1906609"
 Parameter: YPOS -> "45.7409499"
 Parameter: ZPOS -> "-15.0831634"
 Parameter: ZPHI -> "38.8397617"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.778903    0.627144    0.000000
   -0.627144    0.778903    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   38.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   29.190661 XMAX =   29.190661 XAVE =   29.190661
    YMIN =   45.740950 YMAX =   45.740950 YAVE =   45.740950
    ZMIN =  -15.083163 ZMAX =  -15.083163 ZAVE =  -15.083163
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "29.1906609"
Evaluating: 29.1906609+3.5
 Parameter: XMAX <- "32.6906609"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "45.7409499"
Evaluating: 45.7409499+3.5
 Parameter: YMAX <- "49.2409499"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-15.0831634"
Evaluating: -15.0831634+3.5
 Parameter: ZMAX <- "-11.5831634"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "29.1906609"
Evaluating: 29.1906609-3.5
 Parameter: XMIN <- "25.6906609"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "45.7409499"
Evaluating: 45.7409499-3.5
 Parameter: YMIN <- "42.2409499"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-15.0831634"
Evaluating: -15.0831634-3.5
 Parameter: ZMIN <- "-18.5831634"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "32.6906609"
 Parameter: XMIN -> "25.6906609"
 Parameter: YMAX -> "49.2409499"
 Parameter: YMIN -> "42.2409499"
 Parameter: ZMAX -> "-11.5831634"
 Parameter: ZMIN -> "-18.5831634"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      1 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "92"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "92" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "92"
Evaluating: 92
 Parameter: J <- "92"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "92" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "92"
 Parameter: NPOS -> "53"
Evaluating: 92-53
 Parameter: J <- "39"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "39"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.196085627"
Evaluating: 120.112447*(0.196085627-0.5)
 Parameter: XPOS <- "-36.503899"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.930082846"
Evaluating: 120.112447*(0.930082846-0.5)
 Parameter: YPOS <- "51.658303"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.565391558"
Evaluating: 85*(0.565391558-0.5)+0
 Parameter: ZPOS <- "5.55828243"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "5.55828243" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "5.55828243" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "92"
Evaluating: 92
 Parameter: J <- "92"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "92" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "92"
 Parameter: NPOS -> "53"
Evaluating: 92-53
 Parameter: J <- "39"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "39"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.56749176"
Evaluating: 120.112447*(0.56749176-0.5)
 Parameter: XPOS <- "8.10660045"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.202651097"
Evaluating: 120.112447*(0.202651097-0.5)
 Parameter: YPOS <- "-35.7153044"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.671019255"
Evaluating: 85*(0.671019255-0.5)+0
 Parameter: ZPOS <- "14.5366367"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "14.5366367" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "14.5366367" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "92"
Evaluating: 92
 Parameter: J <- "92"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "92" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "92"
 Parameter: NPOS -> "53"
Evaluating: 92-53
 Parameter: J <- "39"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "39"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.925040962"
Evaluating: 120.112447*(0.925040962-0.5)
 Parameter: XPOS <- "51.05271"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.411098298"
Evaluating: 120.112447*(0.411098298-0.5)
 Parameter: YPOS <- "-10.678201"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.782484613"
Evaluating: 85*(0.782484613-0.5)+0
 Parameter: ZPOS <- "24.0111921"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "24.0111921" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "24.0111921" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "51.05271"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 51.05271-0
 Parameter: XTRAN <- "51.05271"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-10.678201"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -10.678201-0
 Parameter: YTRAN <- "-10.678201"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "24.0111921"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 24.0111921-0
 Parameter: ZTRAN <- "24.0111921"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "51.05271"
 Parameter: YTRAN -> "-10.678201"
 Parameter: ZTRAN -> "24.0111921"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    51.052710  -10.678201   24.011192
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.885363997E-03"
Evaluating: 3.885363997E-03*360.0
 Parameter: XPHI <- "1.39873104"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.737026495"
Evaluating: 0.737026495*360.0
 Parameter: YPHI <- "265.329538"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.768093689"
Evaluating: 0.768093689*360.0
 Parameter: ZPHI <- "276.513728"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "51.05271"
 Parameter: YPOS -> "-10.678201"
 Parameter: ZPOS -> "24.0111921"
 Parameter: XPHI -> "1.39873104"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.999702    0.024410
    0.000000   -0.024410    0.999702

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    1.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "51.05271"
 Parameter: YPOS -> "-10.678201"
 Parameter: ZPOS -> "24.0111921"
 Parameter: YPHI -> "265.329538"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.081425    0.000000    0.996679
    0.000000    1.000000    0.000000
   -0.996679    0.000000   -0.081425

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   94.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "51.05271"
 Parameter: YPOS -> "-10.678201"
 Parameter: ZPOS -> "24.0111921"
 Parameter: ZPHI -> "276.513728"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.113441   -0.993545    0.000000
    0.993545    0.113441    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   83.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   51.052710 XMAX =   51.052710 XAVE =   51.052710
    YMIN =  -10.678201 YMAX =  -10.678201 YAVE =  -10.678201
    ZMIN =   24.011192 ZMAX =   24.011192 ZAVE =   24.011192
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "51.05271"
Evaluating: 51.05271+3.5
 Parameter: XMAX <- "54.55271"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-10.678201"
Evaluating: -10.678201+3.5
 Parameter: YMAX <- "-7.178201"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "24.0111921"
Evaluating: 24.0111921+3.5
 Parameter: ZMAX <- "27.5111921"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "51.05271"
Evaluating: 51.05271-3.5
 Parameter: XMIN <- "47.55271"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-10.678201"
Evaluating: -10.678201-3.5
 Parameter: YMIN <- "-14.178201"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "24.0111921"
Evaluating: 24.0111921-3.5
 Parameter: ZMIN <- "20.5111921"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "54.55271"
 Parameter: XMIN -> "47.55271"
 Parameter: YMAX -> "-7.178201"
 Parameter: YMIN -> "-14.178201"
 Parameter: ZMAX -> "27.5111921"
 Parameter: ZMIN -> "20.5111921"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "93"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "93" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "93"
Evaluating: 93
 Parameter: J <- "93"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "93" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "93"
 Parameter: NPOS -> "53"
Evaluating: 93-53
 Parameter: J <- "40"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "40"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.547029435"
Evaluating: 120.112447*(0.547029435-0.5)
 Parameter: XPOS <- "5.64882052"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.911965849"
Evaluating: 120.112447*(0.911965849-0.5)
 Parameter: YPOS <- "49.4822262"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.752844733"
Evaluating: 85*(0.752844733-0.5)+0
 Parameter: ZPOS <- "21.4918023"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "21.4918023" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "21.4918023" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "5.64882052"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 5.64882052-0
 Parameter: XTRAN <- "5.64882052"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "49.4822262"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 49.4822262-0
 Parameter: YTRAN <- "49.4822262"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "21.4918023"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 21.4918023-0
 Parameter: ZTRAN <- "21.4918023"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "5.64882052"
 Parameter: YTRAN -> "49.4822262"
 Parameter: ZTRAN -> "21.4918023"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR     5.648821   49.482226   21.491802
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.623939125"
Evaluating: 0.623939125*360.0
 Parameter: XPHI <- "224.618085"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.706475185"
Evaluating: 0.706475185*360.0
 Parameter: YPHI <- "254.331067"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.227674298"
Evaluating: 0.227674298*360.0
 Parameter: ZPHI <- "81.9627473"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "5.64882052"
 Parameter: YPOS -> "49.4822262"
 Parameter: ZPOS -> "21.4918023"
 Parameter: XPHI -> "224.618085"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.711804   -0.702378
    0.000000    0.702378   -0.711804

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  135.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "5.64882052"
 Parameter: YPOS -> "49.4822262"
 Parameter: ZPOS -> "21.4918023"
 Parameter: YPHI -> "254.331067"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.270078    0.000000    0.962838
    0.000000    1.000000    0.000000
   -0.962838    0.000000   -0.270078

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  105.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "5.64882052"
 Parameter: YPOS -> "49.4822262"
 Parameter: ZPOS -> "21.4918023"
 Parameter: ZPHI -> "81.9627473"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.139817    0.990177    0.000000
   -0.990177    0.139817    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   81.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    5.648821 XMAX =    5.648821 XAVE =    5.648821
    YMIN =   49.482226 YMAX =   49.482226 YAVE =   49.482226
    ZMIN =   21.491802 ZMAX =   21.491802 ZAVE =   21.491802
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "5.64882052"
Evaluating: 5.64882052+3.5
 Parameter: XMAX <- "9.14882052"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "49.4822262"
Evaluating: 49.4822262+3.5
 Parameter: YMAX <- "52.9822262"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "21.4918023"
Evaluating: 21.4918023+3.5
 Parameter: ZMAX <- "24.9918023"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "5.64882052"
Evaluating: 5.64882052-3.5
 Parameter: XMIN <- "2.14882052"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "49.4822262"
Evaluating: 49.4822262-3.5
 Parameter: YMIN <- "45.9822262"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "21.4918023"
Evaluating: 21.4918023-3.5
 Parameter: ZMIN <- "17.9918023"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "9.14882052"
 Parameter: XMIN -> "2.14882052"
 Parameter: YMAX -> "52.9822262"
 Parameter: YMIN -> "45.9822262"
 Parameter: ZMAX -> "24.9918023"
 Parameter: ZMIN -> "17.9918023"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      1 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
 5589 NEG      CL       40       CL      -1561 MEMB     DPPC     131      NC3           1.7620
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "93"
Evaluating: 93
 Parameter: J <- "93"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "93" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "93"
 Parameter: NPOS -> "53"
Evaluating: 93-53
 Parameter: J <- "40"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "40"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.137876562"
Evaluating: 120.112447*(0.137876562-0.5)
 Parameter: XPOS <- "-43.4955323"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.965155604"
Evaluating: 120.112447*(0.965155604-0.5)
 Parameter: YPOS <- "55.8709778"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.22726385"
Evaluating: 85*(0.22726385-0.5)+0
 Parameter: ZPOS <- "-23.1825728"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-23.1825728" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    5.648821 XMAX =    5.648821 XAVE =    5.648821
    YMIN =   49.482226 YMAX =   49.482226 YAVE =   49.482226
    ZMIN =   21.491802 ZMAX =   21.491802 ZAVE =   21.491802
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-43.4955323"
 RDCMND substituted energy or value "?XAVE" to "5.64882052"
Evaluating: -43.4955323-5.64882052
 Parameter: XTRAN <- "-49.1443528"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "55.8709778"
 RDCMND substituted energy or value "?YAVE" to "49.4822262"
Evaluating: 55.8709778-49.4822262
 Parameter: YTRAN <- "6.3887516"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-23.1825728"
 RDCMND substituted energy or value "?ZAVE" to "21.4918023"
Evaluating: -23.1825728-21.4918023
 Parameter: ZTRAN <- "-44.6743751"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-49.1443528"
 Parameter: YTRAN -> "6.3887516"
 Parameter: ZTRAN -> "-44.6743751"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR   -49.144353    6.388752  -44.674375
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.797488275"
Evaluating: 0.797488275*360.0
 Parameter: XPHI <- "287.095779"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.853702614"
Evaluating: 0.853702614*360.0
 Parameter: YPHI <- "307.332941"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.318851604"
Evaluating: 0.318851604*360.0
 Parameter: ZPHI <- "114.786577"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-43.4955323"
 Parameter: YPOS -> "55.8709778"
 Parameter: ZPOS -> "-23.1825728"
 Parameter: XPHI -> "287.095779"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.293970   -0.955815
    0.000000    0.955815    0.293970

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   72.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-43.4955323"
 Parameter: YPOS -> "55.8709778"
 Parameter: ZPOS -> "-23.1825728"
 Parameter: YPHI -> "307.332941"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.606446    0.000000    0.795125
    0.000000    1.000000    0.000000
   -0.795125    0.000000    0.606446

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   52.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-43.4955323"
 Parameter: YPOS -> "55.8709778"
 Parameter: ZPOS -> "-23.1825728"
 Parameter: ZPHI -> "114.786577"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.419239    0.907876    0.000000
   -0.907876   -0.419239    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  114.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -43.495532 XMAX =  -43.495532 XAVE =  -43.495532
    YMIN =   55.870978 YMAX =   55.870978 YAVE =   55.870978
    ZMIN =  -23.182573 ZMAX =  -23.182573 ZAVE =  -23.182573
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-43.4955323"
Evaluating: -43.4955323+3.5
 Parameter: XMAX <- "-39.9955323"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "55.8709778"
Evaluating: 55.8709778+3.5
 Parameter: YMAX <- "59.3709778"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-23.1825728"
Evaluating: -23.1825728+3.5
 Parameter: ZMAX <- "-19.6825728"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-43.4955323"
Evaluating: -43.4955323-3.5
 Parameter: XMIN <- "-46.9955323"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "55.8709778"
Evaluating: 55.8709778-3.5
 Parameter: YMIN <- "52.3709778"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-23.1825728"
Evaluating: -23.1825728-3.5
 Parameter: ZMIN <- "-26.6825728"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-39.9955323"
 Parameter: XMIN -> "-46.9955323"
 Parameter: YMAX -> "59.3709778"
 Parameter: YMIN -> "52.3709778"
 Parameter: ZMAX -> "-19.6825728"
 Parameter: ZMIN -> "-26.6825728"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      1 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
 5589 NEG      CL       40       CL      -5341 MEMB     DPPC     446      NC3           2.6211
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "93"
Evaluating: 93
 Parameter: J <- "93"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "93" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "93"
 Parameter: NPOS -> "53"
Evaluating: 93-53
 Parameter: J <- "40"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "40"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.372934176"
Evaluating: 120.112447*(0.372934176-0.5)
 Parameter: XPOS <- "-15.2621871"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.468857531"
Evaluating: 120.112447*(0.468857531-0.5)
 Parameter: YPOS <- "-3.74059816"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.414550953"
Evaluating: 85*(0.414550953-0.5)+0
 Parameter: ZPOS <- "-7.263169"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-7.263169" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-7.263169" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "93"
Evaluating: 93
 Parameter: J <- "93"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "93" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "93"
 Parameter: NPOS -> "53"
Evaluating: 93-53
 Parameter: J <- "40"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "40"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.202393919"
Evaluating: 120.112447*(0.202393919-0.5)
 Parameter: XPOS <- "-35.7461946"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.929860545"
Evaluating: 120.112447*(0.929860545-0.5)
 Parameter: YPOS <- "51.6316019"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.28009862"
Evaluating: 85*(0.28009862-0.5)+0
 Parameter: ZPOS <- "-18.6916173"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-18.6916173" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -43.495532 XMAX =  -43.495532 XAVE =  -43.495532
    YMIN =   55.870978 YMAX =   55.870978 YAVE =   55.870978
    ZMIN =  -23.182573 ZMAX =  -23.182573 ZAVE =  -23.182573
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-35.7461946"
 RDCMND substituted energy or value "?XAVE" to "-43.4955323"
Evaluating: -35.7461946--43.4955323
 Parameter: XTRAN <- "7.7493377"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "51.6316019"
 RDCMND substituted energy or value "?YAVE" to "55.8709778"
Evaluating: 51.6316019-55.8709778
 Parameter: YTRAN <- "-4.2393759"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-18.6916173"
 RDCMND substituted energy or value "?ZAVE" to "-23.1825728"
Evaluating: -18.6916173--23.1825728
 Parameter: ZTRAN <- "4.4909555"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "7.7493377"
 Parameter: YTRAN -> "-4.2393759"
 Parameter: ZTRAN -> "4.4909555"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR     7.749338   -4.239376    4.490956
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.19140418E-02"
Evaluating: 4.19140418E-02*360.0
 Parameter: XPHI <- "15.089055"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.844259575"
Evaluating: 0.844259575*360.0
 Parameter: YPHI <- "303.933447"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.099178295E-02"
Evaluating: 4.099178295E-02*360.0
 Parameter: ZPHI <- "14.7570419"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-35.7461946"
 Parameter: YPOS -> "51.6316019"
 Parameter: ZPOS -> "-18.6916173"
 Parameter: XPHI -> "15.089055"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.965522    0.260320
    0.000000   -0.260320    0.965522

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   15.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-35.7461946"
 Parameter: YPOS -> "51.6316019"
 Parameter: ZPOS -> "-18.6916173"
 Parameter: YPHI -> "303.933447"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.558230    0.000000    0.829687
    0.000000    1.000000    0.000000
   -0.829687    0.000000    0.558230

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   56.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-35.7461946"
 Parameter: YPOS -> "51.6316019"
 Parameter: ZPOS -> "-18.6916173"
 Parameter: ZPHI -> "14.7570419"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.967015    0.254721    0.000000
   -0.254721    0.967015    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   14.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -35.746195 XMAX =  -35.746195 XAVE =  -35.746195
    YMIN =   51.631602 YMAX =   51.631602 YAVE =   51.631602
    ZMIN =  -18.691617 ZMAX =  -18.691617 ZAVE =  -18.691617
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-35.7461946"
Evaluating: -35.7461946+3.5
 Parameter: XMAX <- "-32.2461946"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "51.6316019"
Evaluating: 51.6316019+3.5
 Parameter: YMAX <- "55.1316019"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-18.6916173"
Evaluating: -18.6916173+3.5
 Parameter: ZMAX <- "-15.1916173"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-35.7461946"
Evaluating: -35.7461946-3.5
 Parameter: XMIN <- "-39.2461946"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "51.6316019"
Evaluating: 51.6316019-3.5
 Parameter: YMIN <- "48.1316019"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-18.6916173"
Evaluating: -18.6916173-3.5
 Parameter: ZMIN <- "-22.1916173"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-32.2461946"
 Parameter: XMIN -> "-39.2461946"
 Parameter: YMAX -> "55.1316019"
 Parameter: YMIN -> "48.1316019"
 Parameter: ZMAX -> "-15.1916173"
 Parameter: ZMIN -> "-22.1916173"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      1 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
 5589 NEG      CL       40       CL      -5077 MEMB     DPPC     424      NC3           2.4320
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "93"
Evaluating: 93
 Parameter: J <- "93"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "93" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "93"
 Parameter: NPOS -> "53"
Evaluating: 93-53
 Parameter: J <- "40"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "40"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.659168934"
Evaluating: 120.112447*(0.659168934-0.5)
 Parameter: XPOS <- "19.1181701"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.537599163"
Evaluating: 120.112447*(0.537599163-0.5)
 Parameter: YPOS <- "4.51612747"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.520017056"
Evaluating: 85*(0.520017056-0.5)+0
 Parameter: ZPOS <- "1.70144976"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "1.70144976" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "1.70144976" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "5"
Evaluating: 5+1
 Parameter: CNTRAND <- "6"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "6" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "93"
Evaluating: 93
 Parameter: J <- "93"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "93" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "93"
 Parameter: NPOS -> "53"
Evaluating: 93-53
 Parameter: J <- "40"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "40"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.792837399"
Evaluating: 120.112447*(0.792837399-0.5)
 Parameter: XPOS <- "35.1734166"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "7.634696762E-02"
Evaluating: 120.112447*(7.634696762E-02-0.5)
 Parameter: YPOS <- "-50.8860024"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.327258978"
Evaluating: 85*(0.327258978-0.5)+0
 Parameter: ZPOS <- "-14.6829869"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-14.6829869" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-14.6829869" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "6"
Evaluating: 6+1
 Parameter: CNTRAND <- "7"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "7" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "93"
Evaluating: 93
 Parameter: J <- "93"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "93" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "93"
 Parameter: NPOS -> "53"
Evaluating: 93-53
 Parameter: J <- "40"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "40"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.495493865"
Evaluating: 120.112447*(0.495493865-0.5)
 Parameter: XPOS <- "-0.541242901"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.807421583"
Evaluating: 120.112447*(0.807421583-0.5)
 Parameter: YPOS <- "36.9251586"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.376170672"
Evaluating: 85*(0.376170672-0.5)+0
 Parameter: ZPOS <- "-10.5254929"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-10.5254929" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-10.5254929" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "7"
Evaluating: 7+1
 Parameter: CNTRAND <- "8"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "8" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "93"
Evaluating: 93
 Parameter: J <- "93"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "93" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "93"
 Parameter: NPOS -> "53"
Evaluating: 93-53
 Parameter: J <- "40"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "40"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.700921281"
Evaluating: 120.112447*(0.700921281-0.5)
 Parameter: XPOS <- "24.1331467"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.475459976"
Evaluating: 120.112447*(0.475459976-0.5)
 Parameter: YPOS <- "-2.94756233"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.669522925"
Evaluating: 85*(0.669522925-0.5)+0
 Parameter: ZPOS <- "14.4094486"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "14.4094486" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "14.4094486" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "8"
Evaluating: 8+1
 Parameter: CNTRAND <- "9"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "9" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "93"
Evaluating: 93
 Parameter: J <- "93"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "93" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "93"
 Parameter: NPOS -> "53"
Evaluating: 93-53
 Parameter: J <- "40"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "40"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.852157155"
Evaluating: 120.112447*(0.852157155-0.5)
 Parameter: XPOS <- "42.2984576"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.650812831"
Evaluating: 120.112447*(0.650812831-0.5)
 Parameter: YPOS <- "18.1144982"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.533499874"
Evaluating: 85*(0.533499874-0.5)+0
 Parameter: ZPOS <- "2.84748929"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "2.84748929" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "2.84748929" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "9"
Evaluating: 9+1
 Parameter: CNTRAND <- "10"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "10" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "93"
Evaluating: 93
 Parameter: J <- "93"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "93" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "93"
 Parameter: NPOS -> "53"
Evaluating: 93-53
 Parameter: J <- "40"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "40"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.362919312"
Evaluating: 120.112447*(0.362919312-0.5)
 Parameter: XPOS <- "-16.4650969"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.688301496"
Evaluating: 120.112447*(0.688301496-0.5)
 Parameter: YPOS <- "22.6173535"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "4.662509369E-02"
Evaluating: 85*(4.662509369E-02-0.5)+0
 Parameter: ZPOS <- "-38.536867"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-38.536867" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -35.746195 XMAX =  -35.746195 XAVE =  -35.746195
    YMIN =   51.631602 YMAX =   51.631602 YAVE =   51.631602
    ZMIN =  -18.691617 ZMAX =  -18.691617 ZAVE =  -18.691617
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-16.4650969"
 RDCMND substituted energy or value "?XAVE" to "-35.7461946"
Evaluating: -16.4650969--35.7461946
 Parameter: XTRAN <- "19.2810977"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "22.6173535"
 RDCMND substituted energy or value "?YAVE" to "51.6316019"
Evaluating: 22.6173535-51.6316019
 Parameter: YTRAN <- "-29.0142484"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-38.536867"
 RDCMND substituted energy or value "?ZAVE" to "-18.6916173"
Evaluating: -38.536867--18.6916173
 Parameter: ZTRAN <- "-19.8452497"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "19.2810977"
 Parameter: YTRAN -> "-29.0142484"
 Parameter: ZTRAN -> "-19.8452497"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    19.281098  -29.014248  -19.845250
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.278055734"
Evaluating: 0.278055734*360.0
 Parameter: XPHI <- "100.100064"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.330549717"
Evaluating: 0.330549717*360.0
 Parameter: YPHI <- "118.997898"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.813249724"
Evaluating: 0.813249724*360.0
 Parameter: ZPHI <- "292.769901"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-16.4650969"
 Parameter: YPOS -> "22.6173535"
 Parameter: ZPOS -> "-38.536867"
 Parameter: XPHI -> "100.100064"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.175368    0.984503
    0.000000   -0.984503   -0.175368

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  100.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-16.4650969"
 Parameter: YPOS -> "22.6173535"
 Parameter: ZPOS -> "-38.536867"
 Parameter: YPHI -> "118.997898"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.484778    0.000000   -0.874637
    0.000000    1.000000    0.000000
    0.874637    0.000000   -0.484778

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  119.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-16.4650969"
 Parameter: YPOS -> "22.6173535"
 Parameter: ZPOS -> "-38.536867"
 Parameter: ZPHI -> "292.769901"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.387031   -0.922067    0.000000
    0.922067    0.387031    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   67.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -16.465097 XMAX =  -16.465097 XAVE =  -16.465097
    YMIN =   22.617353 YMAX =   22.617353 YAVE =   22.617353
    ZMIN =  -38.536867 ZMAX =  -38.536867 ZAVE =  -38.536867
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-16.4650969"
Evaluating: -16.4650969+3.5
 Parameter: XMAX <- "-12.9650969"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "22.6173535"
Evaluating: 22.6173535+3.5
 Parameter: YMAX <- "26.1173535"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-38.536867"
Evaluating: -38.536867+3.5
 Parameter: ZMAX <- "-35.036867"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-16.4650969"
Evaluating: -16.4650969-3.5
 Parameter: XMIN <- "-19.9650969"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "22.6173535"
Evaluating: 22.6173535-3.5
 Parameter: YMIN <- "19.1173535"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-38.536867"
Evaluating: -38.536867-3.5
 Parameter: ZMIN <- "-42.036867"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-12.9650969"
 Parameter: XMIN -> "-19.9650969"
 Parameter: YMAX -> "26.1173535"
 Parameter: YMIN -> "19.1173535"
 Parameter: ZMAX -> "-35.036867"
 Parameter: ZMIN -> "-42.036867"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "94"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "94" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "94"
Evaluating: 94
 Parameter: J <- "94"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "94" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "94"
 Parameter: NPOS -> "53"
Evaluating: 94-53
 Parameter: J <- "41"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "41"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.522336662"
Evaluating: 120.112447*(0.522336662-0.5)
 Parameter: XPOS <- "2.68291113"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.12581953"
Evaluating: 120.112447*(0.12581953-0.5)
 Parameter: YPOS <- "-44.9437319"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.404474948"
Evaluating: 85*(0.404474948-0.5)+0
 Parameter: ZPOS <- "-8.11962942"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-8.11962942" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-8.11962942" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "94"
Evaluating: 94
 Parameter: J <- "94"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "94" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "94"
 Parameter: NPOS -> "53"
Evaluating: 94-53
 Parameter: J <- "41"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "41"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.67309067"
Evaluating: 120.112447*(0.67309067-0.5)
 Parameter: XPOS <- "20.7903439"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.288482521"
Evaluating: 120.112447*(0.288482521-0.5)
 Parameter: YPOS <- "-25.405882"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.526077891"
Evaluating: 85*(0.526077891-0.5)+0
 Parameter: ZPOS <- "2.21662073"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "2.21662073" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "2.21662073" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "94"
Evaluating: 94
 Parameter: J <- "94"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "94" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "94"
 Parameter: NPOS -> "53"
Evaluating: 94-53
 Parameter: J <- "41"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "41"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.642768686"
Evaluating: 120.112447*(0.642768686-0.5)
 Parameter: XPOS <- "17.1482962"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.25972528"
Evaluating: 120.112447*(0.25972528-0.5)
 Parameter: YPOS <- "-28.8599846"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.128510603"
Evaluating: 85*(0.128510603-0.5)+0
 Parameter: ZPOS <- "-31.5765987"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-31.5765987" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "17.1482962"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 17.1482962-0
 Parameter: XTRAN <- "17.1482962"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-28.8599846"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -28.8599846-0
 Parameter: YTRAN <- "-28.8599846"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-31.5765987"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -31.5765987-0
 Parameter: ZTRAN <- "-31.5765987"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "17.1482962"
 Parameter: YTRAN -> "-28.8599846"
 Parameter: ZTRAN -> "-31.5765987"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    17.148296  -28.859985  -31.576599
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.2679399E-02"
Evaluating: 8.2679399E-02*360.0
 Parameter: XPHI <- "29.7645836"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.848949708"
Evaluating: 0.848949708*360.0
 Parameter: YPHI <- "305.621895"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.382305765"
Evaluating: 0.382305765*360.0
 Parameter: ZPHI <- "137.630075"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "17.1482962"
 Parameter: YPOS -> "-28.8599846"
 Parameter: ZPOS -> "-31.5765987"
 Parameter: XPHI -> "29.7645836"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.868072    0.496437
    0.000000   -0.496437    0.868072

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   29.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "17.1482962"
 Parameter: YPOS -> "-28.8599846"
 Parameter: ZPOS -> "-31.5765987"
 Parameter: YPHI -> "305.621895"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.582434    0.000000    0.812878
    0.000000    1.000000    0.000000
   -0.812878    0.000000    0.582434

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   54.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "17.1482962"
 Parameter: YPOS -> "-28.8599846"
 Parameter: ZPOS -> "-31.5765987"
 Parameter: ZPHI -> "137.630075"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.738809    0.673915    0.000000
   -0.673915   -0.738809    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  137.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   17.148296 XMAX =   17.148296 XAVE =   17.148296
    YMIN =  -28.859985 YMAX =  -28.859985 YAVE =  -28.859985
    ZMIN =  -31.576599 ZMAX =  -31.576599 ZAVE =  -31.576599
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "17.1482962"
Evaluating: 17.1482962+3.5
 Parameter: XMAX <- "20.6482962"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-28.8599846"
Evaluating: -28.8599846+3.5
 Parameter: YMAX <- "-25.3599846"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-31.5765987"
Evaluating: -31.5765987+3.5
 Parameter: ZMAX <- "-28.0765987"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "17.1482962"
Evaluating: 17.1482962-3.5
 Parameter: XMIN <- "13.6482962"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-28.8599846"
Evaluating: -28.8599846-3.5
 Parameter: YMIN <- "-32.3599846"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-31.5765987"
Evaluating: -31.5765987-3.5
 Parameter: ZMIN <- "-35.0765987"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "20.6482962"
 Parameter: XMIN -> "13.6482962"
 Parameter: YMAX -> "-25.3599846"
 Parameter: YMIN -> "-32.3599846"
 Parameter: ZMAX -> "-28.0765987"
 Parameter: ZMIN -> "-35.0765987"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "95"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "95" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "95"
Evaluating: 95
 Parameter: J <- "95"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "95" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "95"
 Parameter: NPOS -> "53"
Evaluating: 95-53
 Parameter: J <- "42"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "42"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.944079353"
Evaluating: 120.112447*(0.944079353-0.5)
 Parameter: XPOS <- "53.3394578"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.343145917"
Evaluating: 120.112447*(0.343145917-0.5)
 Parameter: YPOS <- "-18.8401277"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.580226761"
Evaluating: 85*(0.580226761-0.5)+0
 Parameter: ZPOS <- "6.81927468"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "6.81927468" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "6.81927468" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "95"
Evaluating: 95
 Parameter: J <- "95"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "95" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "95"
 Parameter: NPOS -> "53"
Evaluating: 95-53
 Parameter: J <- "42"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "42"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.751031259"
Evaluating: 120.112447*(0.751031259-0.5)
 Parameter: XPOS <- "30.1519788"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.693336188"
Evaluating: 120.112447*(0.693336188-0.5)
 Parameter: YPOS <- "23.2220826"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.666921069"
Evaluating: 85*(0.666921069-0.5)+0
 Parameter: ZPOS <- "14.1882909"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "14.1882909" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "14.1882909" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "95"
Evaluating: 95
 Parameter: J <- "95"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "95" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "95"
 Parameter: NPOS -> "53"
Evaluating: 95-53
 Parameter: J <- "42"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "42"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.687680612"
Evaluating: 120.112447*(0.687680612-0.5)
 Parameter: XPOS <- "22.5427776"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.301306238"
Evaluating: 120.112447*(0.301306238-0.5)
 Parameter: YPOS <- "-23.865594"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.916160276"
Evaluating: 85*(0.916160276-0.5)+0
 Parameter: ZPOS <- "35.3736235"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "35.3736235" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "35.3736235" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "22.5427776"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 22.5427776-0
 Parameter: XTRAN <- "22.5427776"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-23.865594"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -23.865594-0
 Parameter: YTRAN <- "-23.865594"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "35.3736235"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 35.3736235-0
 Parameter: ZTRAN <- "35.3736235"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "22.5427776"
 Parameter: YTRAN -> "-23.865594"
 Parameter: ZTRAN -> "35.3736235"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    22.542778  -23.865594   35.373624
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.720343468"
Evaluating: 0.720343468*360.0
 Parameter: XPHI <- "259.323648"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.673167769"
Evaluating: 0.673167769*360.0
 Parameter: YPHI <- "242.340397"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.755463142E-02"
Evaluating: 3.755463142E-02*360.0
 Parameter: ZPHI <- "13.5196673"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "22.5427776"
 Parameter: YPOS -> "-23.865594"
 Parameter: ZPOS -> "35.3736235"
 Parameter: XPHI -> "259.323648"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.185261   -0.982689
    0.000000    0.982689   -0.185261

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  100.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "22.5427776"
 Parameter: YPOS -> "-23.865594"
 Parameter: ZPOS -> "35.3736235"
 Parameter: YPHI -> "242.340397"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.464218    0.000000    0.885721
    0.000000    1.000000    0.000000
   -0.885721    0.000000   -0.464218

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  117.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "22.5427776"
 Parameter: YPOS -> "-23.865594"
 Parameter: ZPOS -> "35.3736235"
 Parameter: ZPHI -> "13.5196673"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.972290    0.233779    0.000000
   -0.233779    0.972290    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   13.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   22.542778 XMAX =   22.542778 XAVE =   22.542778
    YMIN =  -23.865594 YMAX =  -23.865594 YAVE =  -23.865594
    ZMIN =   35.373624 ZMAX =   35.373624 ZAVE =   35.373624
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "22.5427776"
Evaluating: 22.5427776+3.5
 Parameter: XMAX <- "26.0427776"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-23.865594"
Evaluating: -23.865594+3.5
 Parameter: YMAX <- "-20.365594"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "35.3736235"
Evaluating: 35.3736235+3.5
 Parameter: ZMAX <- "38.8736235"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "22.5427776"
Evaluating: 22.5427776-3.5
 Parameter: XMIN <- "19.0427776"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-23.865594"
Evaluating: -23.865594-3.5
 Parameter: YMIN <- "-27.365594"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "35.3736235"
Evaluating: 35.3736235-3.5
 Parameter: ZMIN <- "31.8736235"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "26.0427776"
 Parameter: XMIN -> "19.0427776"
 Parameter: YMAX -> "-20.365594"
 Parameter: YMIN -> "-27.365594"
 Parameter: ZMAX -> "38.8736235"
 Parameter: ZMIN -> "31.8736235"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "96"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "96" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "96"
Evaluating: 96
 Parameter: J <- "96"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "96" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "96"
 Parameter: NPOS -> "53"
Evaluating: 96-53
 Parameter: J <- "43"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "43"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.486018682"
Evaluating: 120.112447*(0.486018682-0.5)
 Parameter: XPOS <- "-1.67933032"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.745694968"
Evaluating: 120.112447*(0.745694968-0.5)
 Parameter: YPOS <- "29.5110238"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.8853385"
Evaluating: 85*(0.8853385-0.5)+0
 Parameter: ZPOS <- "32.7537725"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "32.7537725" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "32.7537725" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-1.67933032"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -1.67933032-0
 Parameter: XTRAN <- "-1.67933032"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "29.5110238"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 29.5110238-0
 Parameter: YTRAN <- "29.5110238"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "32.7537725"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 32.7537725-0
 Parameter: ZTRAN <- "32.7537725"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-1.67933032"
 Parameter: YTRAN -> "29.5110238"
 Parameter: ZTRAN -> "32.7537725"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    -1.679330   29.511024   32.753772
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.667882285"
Evaluating: 0.667882285*360.0
 Parameter: XPHI <- "240.437623"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.335137737"
Evaluating: 0.335137737*360.0
 Parameter: YPHI <- "120.649585"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.460663229"
Evaluating: 0.460663229*360.0
 Parameter: ZPHI <- "165.838762"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-1.67933032"
 Parameter: YPOS -> "29.5110238"
 Parameter: ZPOS -> "32.7537725"
 Parameter: XPHI -> "240.437623"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.493371   -0.869819
    0.000000    0.869819   -0.493371

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  119.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-1.67933032"
 Parameter: YPOS -> "29.5110238"
 Parameter: ZPOS -> "32.7537725"
 Parameter: YPHI -> "120.649585"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.509786    0.000000   -0.860301
    0.000000    1.000000    0.000000
    0.860301    0.000000   -0.509786

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  120.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-1.67933032"
 Parameter: YPOS -> "29.5110238"
 Parameter: ZPOS -> "32.7537725"
 Parameter: ZPHI -> "165.838762"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.969611    0.244651    0.000000
   -0.244651   -0.969611    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  165.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -1.679330 XMAX =   -1.679330 XAVE =   -1.679330
    YMIN =   29.511024 YMAX =   29.511024 YAVE =   29.511024
    ZMIN =   32.753772 ZMAX =   32.753772 ZAVE =   32.753772
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-1.67933032"
Evaluating: -1.67933032+3.5
 Parameter: XMAX <- "1.82066968"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "29.5110238"
Evaluating: 29.5110238+3.5
 Parameter: YMAX <- "33.0110238"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "32.7537725"
Evaluating: 32.7537725+3.5
 Parameter: ZMAX <- "36.2537725"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-1.67933032"
Evaluating: -1.67933032-3.5
 Parameter: XMIN <- "-5.17933032"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "29.5110238"
Evaluating: 29.5110238-3.5
 Parameter: YMIN <- "26.0110238"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "32.7537725"
Evaluating: 32.7537725-3.5
 Parameter: ZMIN <- "29.2537725"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "1.82066968"
 Parameter: XMIN -> "-5.17933032"
 Parameter: YMAX -> "33.0110238"
 Parameter: YMIN -> "26.0110238"
 Parameter: ZMAX -> "36.2537725"
 Parameter: ZMIN -> "29.2537725"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "97"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "97" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "97"
Evaluating: 97
 Parameter: J <- "97"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "97" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "97"
 Parameter: NPOS -> "53"
Evaluating: 97-53
 Parameter: J <- "44"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "44"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.99937623"
Evaluating: 120.112447*(0.99937623-0.5)
 Parameter: XPOS <- "59.981301"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.985361995"
Evaluating: 120.112447*(0.985361995-0.5)
 Parameter: YPOS <- "58.2980169"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.255151488"
Evaluating: 85*(0.255151488-0.5)+0
 Parameter: ZPOS <- "-20.8121235"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-20.8121235" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "59.981301"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 59.981301-0
 Parameter: XTRAN <- "59.981301"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "58.2980169"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 58.2980169-0
 Parameter: YTRAN <- "58.2980169"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-20.8121235"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -20.8121235-0
 Parameter: ZTRAN <- "-20.8121235"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "59.981301"
 Parameter: YTRAN -> "58.2980169"
 Parameter: ZTRAN -> "-20.8121235"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    59.981301   58.298017  -20.812123
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.720319896"
Evaluating: 0.720319896*360.0
 Parameter: XPHI <- "259.315163"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.469197018"
Evaluating: 0.469197018*360.0
 Parameter: YPHI <- "168.910926"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.798668203"
Evaluating: 0.798668203*360.0
 Parameter: ZPHI <- "287.520553"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "59.981301"
 Parameter: YPOS -> "58.2980169"
 Parameter: ZPOS -> "-20.8121235"
 Parameter: XPHI -> "259.315163"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.185407   -0.982662
    0.000000    0.982662   -0.185407

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  100.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "59.981301"
 Parameter: YPOS -> "58.2980169"
 Parameter: ZPOS -> "-20.8121235"
 Parameter: YPHI -> "168.910926"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.981329    0.000000   -0.192335
    0.000000    1.000000    0.000000
    0.192335    0.000000   -0.981329

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  168.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "59.981301"
 Parameter: YPOS -> "58.2980169"
 Parameter: ZPOS -> "-20.8121235"
 Parameter: ZPHI -> "287.520553"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.301048   -0.953609    0.000000
    0.953609    0.301048    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   72.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   59.981301 XMAX =   59.981301 XAVE =   59.981301
    YMIN =   58.298017 YMAX =   58.298017 YAVE =   58.298017
    ZMIN =  -20.812123 ZMAX =  -20.812123 ZAVE =  -20.812123
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "59.981301"
Evaluating: 59.981301+3.5
 Parameter: XMAX <- "63.481301"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "58.2980169"
Evaluating: 58.2980169+3.5
 Parameter: YMAX <- "61.7980169"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-20.8121235"
Evaluating: -20.8121235+3.5
 Parameter: ZMAX <- "-17.3121235"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "59.981301"
Evaluating: 59.981301-3.5
 Parameter: XMIN <- "56.481301"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "58.2980169"
Evaluating: 58.2980169-3.5
 Parameter: YMIN <- "54.7980169"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-20.8121235"
Evaluating: -20.8121235-3.5
 Parameter: ZMIN <- "-24.3121235"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "63.481301"
 Parameter: XMIN -> "56.481301"
 Parameter: YMAX -> "61.7980169"
 Parameter: YMIN -> "54.7980169"
 Parameter: ZMAX -> "-17.3121235"
 Parameter: ZMIN -> "-24.3121235"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "98"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "98" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "98"
Evaluating: 98
 Parameter: J <- "98"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "98" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "98"
 Parameter: NPOS -> "53"
Evaluating: 98-53
 Parameter: J <- "45"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "45"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.41319809"
Evaluating: 120.112447*(0.41319809-0.5)
 Parameter: XPOS <- "-10.4259898"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.201381131"
Evaluating: 120.112447*(0.201381131-0.5)
 Parameter: YPOS <- "-35.8678431"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.169672704"
Evaluating: 85*(0.169672704-0.5)+0
 Parameter: ZPOS <- "-28.0778202"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-28.0778202" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-10.4259898"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -10.4259898-0
 Parameter: XTRAN <- "-10.4259898"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-35.8678431"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -35.8678431-0
 Parameter: YTRAN <- "-35.8678431"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-28.0778202"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -28.0778202-0
 Parameter: ZTRAN <- "-28.0778202"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-10.4259898"
 Parameter: YTRAN -> "-35.8678431"
 Parameter: ZTRAN -> "-28.0778202"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR   -10.425990  -35.867843  -28.077820
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.736798738"
Evaluating: 0.736798738*360.0
 Parameter: XPHI <- "265.247546"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.642385217"
Evaluating: 0.642385217*360.0
 Parameter: YPHI <- "231.258678"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.232519353"
Evaluating: 0.232519353*360.0
 Parameter: ZPHI <- "83.7069671"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-10.4259898"
 Parameter: YPOS -> "-35.8678431"
 Parameter: ZPOS -> "-28.0778202"
 Parameter: XPHI -> "265.247546"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.082851   -0.996562
    0.000000    0.996562   -0.082851

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   94.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-10.4259898"
 Parameter: YPOS -> "-35.8678431"
 Parameter: ZPOS -> "-28.0778202"
 Parameter: YPHI -> "231.258678"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.625805    0.000000    0.779979
    0.000000    1.000000    0.000000
   -0.779979    0.000000   -0.625805

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  128.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-10.4259898"
 Parameter: YPOS -> "-35.8678431"
 Parameter: ZPOS -> "-28.0778202"
 Parameter: ZPHI -> "83.7069671"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.109613    0.993974    0.000000
   -0.993974    0.109613    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   83.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -10.425990 XMAX =  -10.425990 XAVE =  -10.425990
    YMIN =  -35.867843 YMAX =  -35.867843 YAVE =  -35.867843
    ZMIN =  -28.077820 ZMAX =  -28.077820 ZAVE =  -28.077820
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-10.4259898"
Evaluating: -10.4259898+3.5
 Parameter: XMAX <- "-6.9259898"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-35.8678431"
Evaluating: -35.8678431+3.5
 Parameter: YMAX <- "-32.3678431"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-28.0778202"
Evaluating: -28.0778202+3.5
 Parameter: ZMAX <- "-24.5778202"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-10.4259898"
Evaluating: -10.4259898-3.5
 Parameter: XMIN <- "-13.9259898"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-35.8678431"
Evaluating: -35.8678431-3.5
 Parameter: YMIN <- "-39.3678431"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-28.0778202"
Evaluating: -28.0778202-3.5
 Parameter: ZMIN <- "-31.5778202"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-6.9259898"
 Parameter: XMIN -> "-13.9259898"
 Parameter: YMAX -> "-32.3678431"
 Parameter: YMIN -> "-39.3678431"
 Parameter: ZMAX -> "-24.5778202"
 Parameter: ZMIN -> "-31.5778202"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "99"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "99" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "99"
Evaluating: 99
 Parameter: J <- "99"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "99" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "99"
 Parameter: NPOS -> "53"
Evaluating: 99-53
 Parameter: J <- "46"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "46"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.564777319"
Evaluating: 120.112447*(0.564777319-0.5)
 Parameter: XPOS <- "7.7805623"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.845773538"
Evaluating: 120.112447*(0.845773538-0.5)
 Parameter: YPOS <- "41.5317058"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.19775491"
Evaluating: 85*(0.19775491-0.5)+0
 Parameter: ZPOS <- "-25.6908327"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-25.6908327" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "7.7805623"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 7.7805623-0
 Parameter: XTRAN <- "7.7805623"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "41.5317058"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 41.5317058-0
 Parameter: YTRAN <- "41.5317058"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-25.6908327"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -25.6908327-0
 Parameter: ZTRAN <- "-25.6908327"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "7.7805623"
 Parameter: YTRAN -> "41.5317058"
 Parameter: ZTRAN -> "-25.6908327"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR     7.780562   41.531706  -25.690833
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.610660702"
Evaluating: 0.610660702*360.0
 Parameter: XPHI <- "219.837853"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.338188496"
Evaluating: 0.338188496*360.0
 Parameter: YPHI <- "121.747859"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.725108269"
Evaluating: 0.725108269*360.0
 Parameter: ZPHI <- "261.038977"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "7.7805623"
 Parameter: YPOS -> "41.5317058"
 Parameter: ZPOS -> "-25.6908327"
 Parameter: XPHI -> "219.837853"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.767860   -0.640617
    0.000000    0.640617   -0.767860

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  140.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "7.7805623"
 Parameter: YPOS -> "41.5317058"
 Parameter: ZPOS -> "-25.6908327"
 Parameter: YPHI -> "121.747859"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.526182    0.000000   -0.850372
    0.000000    1.000000    0.000000
    0.850372    0.000000   -0.526182

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  121.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "7.7805623"
 Parameter: YPOS -> "41.5317058"
 Parameter: ZPOS -> "-25.6908327"
 Parameter: ZPHI -> "261.038977"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.155763   -0.987795    0.000000
    0.987795   -0.155763    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   98.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    7.780562 XMAX =    7.780562 XAVE =    7.780562
    YMIN =   41.531706 YMAX =   41.531706 YAVE =   41.531706
    ZMIN =  -25.690833 ZMAX =  -25.690833 ZAVE =  -25.690833
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "7.7805623"
Evaluating: 7.7805623+3.5
 Parameter: XMAX <- "11.2805623"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "41.5317058"
Evaluating: 41.5317058+3.5
 Parameter: YMAX <- "45.0317058"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-25.6908327"
Evaluating: -25.6908327+3.5
 Parameter: ZMAX <- "-22.1908327"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "7.7805623"
Evaluating: 7.7805623-3.5
 Parameter: XMIN <- "4.2805623"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "41.5317058"
Evaluating: 41.5317058-3.5
 Parameter: YMIN <- "38.0317058"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-25.6908327"
Evaluating: -25.6908327-3.5
 Parameter: ZMIN <- "-29.1908327"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "11.2805623"
 Parameter: XMIN -> "4.2805623"
 Parameter: YMAX -> "45.0317058"
 Parameter: YMIN -> "38.0317058"
 Parameter: ZMAX -> "-22.1908327"
 Parameter: ZMIN -> "-29.1908327"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "100"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "100" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "100"
Evaluating: 100
 Parameter: J <- "100"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "100" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "100"
 Parameter: NPOS -> "53"
Evaluating: 100-53
 Parameter: J <- "47"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "47"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.948334728"
Evaluating: 120.112447*(0.948334728-0.5)
 Parameter: XPOS <- "53.8505813"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.843107496"
Evaluating: 120.112447*(0.843107496-0.5)
 Parameter: YPOS <- "41.2114809"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.272481021"
Evaluating: 85*(0.272481021-0.5)+0
 Parameter: ZPOS <- "-19.3391132"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-19.3391132" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "53.8505813"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 53.8505813-0
 Parameter: XTRAN <- "53.8505813"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "41.2114809"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 41.2114809-0
 Parameter: YTRAN <- "41.2114809"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-19.3391132"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -19.3391132-0
 Parameter: ZTRAN <- "-19.3391132"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "53.8505813"
 Parameter: YTRAN -> "41.2114809"
 Parameter: ZTRAN -> "-19.3391132"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    53.850581   41.211481  -19.339113
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.588719145"
Evaluating: 0.588719145*360.0
 Parameter: XPHI <- "211.938892"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.194688972"
Evaluating: 0.194688972*360.0
 Parameter: YPHI <- "70.0880299"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.491637517"
Evaluating: 0.491637517*360.0
 Parameter: ZPHI <- "176.989506"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "53.8505813"
 Parameter: YPOS -> "41.2114809"
 Parameter: ZPOS -> "-19.3391132"
 Parameter: XPHI -> "211.938892"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.848613   -0.529014
    0.000000    0.529014   -0.848613

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  148.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "53.8505813"
 Parameter: YPOS -> "41.2114809"
 Parameter: ZPOS -> "-19.3391132"
 Parameter: YPHI -> "70.0880299"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.340576    0.000000   -0.940217
    0.000000    1.000000    0.000000
    0.940217    0.000000    0.340576

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   70.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "53.8505813"
 Parameter: YPOS -> "41.2114809"
 Parameter: ZPOS -> "-19.3391132"
 Parameter: ZPHI -> "176.989506"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.998620    0.052519    0.000000
   -0.052519   -0.998620    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  176.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   53.850581 XMAX =   53.850581 XAVE =   53.850581
    YMIN =   41.211481 YMAX =   41.211481 YAVE =   41.211481
    ZMIN =  -19.339113 ZMAX =  -19.339113 ZAVE =  -19.339113
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "53.8505813"
Evaluating: 53.8505813+3.5
 Parameter: XMAX <- "57.3505813"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "41.2114809"
Evaluating: 41.2114809+3.5
 Parameter: YMAX <- "44.7114809"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-19.3391132"
Evaluating: -19.3391132+3.5
 Parameter: ZMAX <- "-15.8391132"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "53.8505813"
Evaluating: 53.8505813-3.5
 Parameter: XMIN <- "50.3505813"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "41.2114809"
Evaluating: 41.2114809-3.5
 Parameter: YMIN <- "37.7114809"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-19.3391132"
Evaluating: -19.3391132-3.5
 Parameter: ZMIN <- "-22.8391132"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "57.3505813"
 Parameter: XMIN -> "50.3505813"
 Parameter: YMAX -> "44.7114809"
 Parameter: YMIN -> "37.7114809"
 Parameter: ZMAX -> "-15.8391132"
 Parameter: ZMIN -> "-22.8391132"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "101"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "101" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "101"
Evaluating: 101
 Parameter: J <- "101"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "101" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "101"
 Parameter: NPOS -> "53"
Evaluating: 101-53
 Parameter: J <- "48"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "48"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "2.711616431E-02"
Evaluating: 120.112447*(2.711616431E-02-0.5)
 Parameter: XPOS <- "-56.7992347"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "5.489176736E-03"
Evaluating: 120.112447*(5.489176736E-03-0.5)
 Parameter: YPOS <- "-59.3969051"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.169882023"
Evaluating: 85*(0.169882023-0.5)+0
 Parameter: ZPOS <- "-28.060028"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-28.060028" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-56.7992347"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -56.7992347-0
 Parameter: XTRAN <- "-56.7992347"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-59.3969051"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -59.3969051-0
 Parameter: YTRAN <- "-59.3969051"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-28.060028"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -28.060028-0
 Parameter: ZTRAN <- "-28.060028"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-56.7992347"
 Parameter: YTRAN -> "-59.3969051"
 Parameter: ZTRAN -> "-28.060028"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR   -56.799235  -59.396905  -28.060028
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.285475497E-02"
Evaluating: 7.285475497E-02*360.0
 Parameter: XPHI <- "26.2277118"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.879407534"
Evaluating: 0.879407534*360.0
 Parameter: YPHI <- "316.586712"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.290139988E-02"
Evaluating: 8.290139988E-02*360.0
 Parameter: ZPHI <- "29.844504"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-56.7992347"
 Parameter: YPOS -> "-59.3969051"
 Parameter: ZPOS -> "-28.060028"
 Parameter: XPHI -> "26.2277118"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.897045    0.441940
    0.000000   -0.441940    0.897045

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   26.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-56.7992347"
 Parameter: YPOS -> "-59.3969051"
 Parameter: ZPOS -> "-28.060028"
 Parameter: YPHI -> "316.586712"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.726415    0.000000    0.687256
    0.000000    1.000000    0.000000
   -0.687256    0.000000    0.726415

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   43.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-56.7992347"
 Parameter: YPOS -> "-59.3969051"
 Parameter: ZPOS -> "-28.060028"
 Parameter: ZPHI -> "29.844504"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.867379    0.497648    0.000000
   -0.497648    0.867379    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   29.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -56.799235 XMAX =  -56.799235 XAVE =  -56.799235
    YMIN =  -59.396905 YMAX =  -59.396905 YAVE =  -59.396905
    ZMIN =  -28.060028 ZMAX =  -28.060028 ZAVE =  -28.060028
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-56.7992347"
Evaluating: -56.7992347+3.5
 Parameter: XMAX <- "-53.2992347"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-59.3969051"
Evaluating: -59.3969051+3.5
 Parameter: YMAX <- "-55.8969051"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-28.060028"
Evaluating: -28.060028+3.5
 Parameter: ZMAX <- "-24.560028"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-56.7992347"
Evaluating: -56.7992347-3.5
 Parameter: XMIN <- "-60.2992347"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-59.3969051"
Evaluating: -59.3969051-3.5
 Parameter: YMIN <- "-62.8969051"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-28.060028"
Evaluating: -28.060028-3.5
 Parameter: ZMIN <- "-31.560028"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-53.2992347"
 Parameter: XMIN -> "-60.2992347"
 Parameter: YMAX -> "-55.8969051"
 Parameter: YMIN -> "-62.8969051"
 Parameter: ZMAX -> "-24.560028"
 Parameter: ZMIN -> "-31.560028"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "102"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "102" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "102"
Evaluating: 102
 Parameter: J <- "102"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "102" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "102"
 Parameter: NPOS -> "53"
Evaluating: 102-53
 Parameter: J <- "49"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "49"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.64547315"
Evaluating: 120.112447*(0.64547315-0.5)
 Parameter: XPOS <- "17.473136"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "9.203549355E-02"
Evaluating: 120.112447*(9.203549355E-02-0.5)
 Parameter: YPOS <- "-49.0016152"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "4.249902699E-02"
Evaluating: 85*(4.249902699E-02-0.5)+0
 Parameter: ZPOS <- "-38.8875827"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-38.8875827" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "17.473136"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 17.473136-0
 Parameter: XTRAN <- "17.473136"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-49.0016152"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -49.0016152-0
 Parameter: YTRAN <- "-49.0016152"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-38.8875827"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -38.8875827-0
 Parameter: ZTRAN <- "-38.8875827"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "17.473136"
 Parameter: YTRAN -> "-49.0016152"
 Parameter: ZTRAN -> "-38.8875827"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    17.473136  -49.001615  -38.887583
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.409966099E-02"
Evaluating: 2.409966099E-02*360.0
 Parameter: XPHI <- "8.67587796"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.3704096"
Evaluating: 0.3704096*360.0
 Parameter: YPHI <- "133.347456"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.314270353"
Evaluating: 0.314270353*360.0
 Parameter: ZPHI <- "113.137327"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "17.473136"
 Parameter: YPOS -> "-49.0016152"
 Parameter: ZPOS -> "-38.8875827"
 Parameter: XPHI -> "8.67587796"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.988557    0.150845
    0.000000   -0.150845    0.988557

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    8.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "17.473136"
 Parameter: YPOS -> "-49.0016152"
 Parameter: ZPOS -> "-38.8875827"
 Parameter: YPHI -> "133.347456"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.686421    0.000000   -0.727204
    0.000000    1.000000    0.000000
    0.727204    0.000000   -0.686421

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  133.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "17.473136"
 Parameter: YPOS -> "-49.0016152"
 Parameter: ZPOS -> "-38.8875827"
 Parameter: ZPHI -> "113.137327"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.392936    0.919566    0.000000
   -0.919566   -0.392936    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  113.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   17.473136 XMAX =   17.473136 XAVE =   17.473136
    YMIN =  -49.001615 YMAX =  -49.001615 YAVE =  -49.001615
    ZMIN =  -38.887583 ZMAX =  -38.887583 ZAVE =  -38.887583
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "17.473136"
Evaluating: 17.473136+3.5
 Parameter: XMAX <- "20.973136"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-49.0016152"
Evaluating: -49.0016152+3.5
 Parameter: YMAX <- "-45.5016152"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-38.8875827"
Evaluating: -38.8875827+3.5
 Parameter: ZMAX <- "-35.3875827"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "17.473136"
Evaluating: 17.473136-3.5
 Parameter: XMIN <- "13.973136"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-49.0016152"
Evaluating: -49.0016152-3.5
 Parameter: YMIN <- "-52.5016152"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-38.8875827"
Evaluating: -38.8875827-3.5
 Parameter: ZMIN <- "-42.3875827"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "20.973136"
 Parameter: XMIN -> "13.973136"
 Parameter: YMAX -> "-45.5016152"
 Parameter: YMIN -> "-52.5016152"
 Parameter: ZMAX -> "-35.3875827"
 Parameter: ZMIN -> "-42.3875827"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "103"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "103" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "103"
Evaluating: 103
 Parameter: J <- "103"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "103" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "103"
 Parameter: NPOS -> "53"
Evaluating: 103-53
 Parameter: J <- "50"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "50"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.634737308"
Evaluating: 120.112447*(0.634737308-0.5)
 Parameter: XPOS <- "16.1836278"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.247811718"
Evaluating: 120.112447*(0.247811718-0.5)
 Parameter: YPOS <- "-30.2909517"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.662078168"
Evaluating: 85*(0.662078168-0.5)+0
 Parameter: ZPOS <- "13.7766443"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "13.7766443" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "13.7766443" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "103"
Evaluating: 103
 Parameter: J <- "103"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "103" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "103"
 Parameter: NPOS -> "53"
Evaluating: 103-53
 Parameter: J <- "50"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "50"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.670831953"
Evaluating: 120.112447*(0.670831953-0.5)
 Parameter: XPOS <- "20.5190439"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.856065706"
Evaluating: 120.112447*(0.856065706-0.5)
 Parameter: YPOS <- "42.7679232"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "6.1401618E-02"
Evaluating: 85*(6.1401618E-02-0.5)+0
 Parameter: ZPOS <- "-37.2808625"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-37.2808625" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "20.5190439"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 20.5190439-0
 Parameter: XTRAN <- "20.5190439"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "42.7679232"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 42.7679232-0
 Parameter: YTRAN <- "42.7679232"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-37.2808625"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -37.2808625-0
 Parameter: ZTRAN <- "-37.2808625"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "20.5190439"
 Parameter: YTRAN -> "42.7679232"
 Parameter: ZTRAN -> "-37.2808625"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    20.519044   42.767923  -37.280862
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.295653968"
Evaluating: 0.295653968*360.0
 Parameter: XPHI <- "106.435428"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.564103761"
Evaluating: 0.564103761*360.0
 Parameter: YPHI <- "203.077354"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.821115704"
Evaluating: 0.821115704*360.0
 Parameter: ZPHI <- "295.601653"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "20.5190439"
 Parameter: YPOS -> "42.7679232"
 Parameter: ZPOS -> "-37.2808625"
 Parameter: XPHI -> "106.435428"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.282935    0.959139
    0.000000   -0.959139   -0.282935

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  106.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "20.5190439"
 Parameter: YPOS -> "42.7679232"
 Parameter: ZPOS -> "-37.2808625"
 Parameter: YPHI -> "203.077354"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.919976    0.000000    0.391974
    0.000000    1.000000    0.000000
   -0.391974    0.000000   -0.919976

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  156.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "20.5190439"
 Parameter: YPOS -> "42.7679232"
 Parameter: ZPOS -> "-37.2808625"
 Parameter: ZPHI -> "295.601653"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.432112   -0.901820    0.000000
    0.901820    0.432112    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   64.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   20.519044 XMAX =   20.519044 XAVE =   20.519044
    YMIN =   42.767923 YMAX =   42.767923 YAVE =   42.767923
    ZMIN =  -37.280862 ZMAX =  -37.280862 ZAVE =  -37.280862
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "20.5190439"
Evaluating: 20.5190439+3.5
 Parameter: XMAX <- "24.0190439"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "42.7679232"
Evaluating: 42.7679232+3.5
 Parameter: YMAX <- "46.2679232"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-37.2808625"
Evaluating: -37.2808625+3.5
 Parameter: ZMAX <- "-33.7808625"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "20.5190439"
Evaluating: 20.5190439-3.5
 Parameter: XMIN <- "17.0190439"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "42.7679232"
Evaluating: 42.7679232-3.5
 Parameter: YMIN <- "39.2679232"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-37.2808625"
Evaluating: -37.2808625-3.5
 Parameter: ZMIN <- "-40.7808625"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "24.0190439"
 Parameter: XMIN -> "17.0190439"
 Parameter: YMAX -> "46.2679232"
 Parameter: YMIN -> "39.2679232"
 Parameter: ZMAX -> "-33.7808625"
 Parameter: ZMIN -> "-40.7808625"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "104"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "104" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "104"
Evaluating: 104
 Parameter: J <- "104"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "104" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "104"
 Parameter: NPOS -> "53"
Evaluating: 104-53
 Parameter: J <- "51"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "51"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.880672672"
Evaluating: 120.112447*(0.880672672-0.5)
 Parameter: XPOS <- "45.7235261"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.944452275"
Evaluating: 120.112447*(0.944452275-0.5)
 Parameter: YPOS <- "53.3842503"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.863622623"
Evaluating: 85*(0.863622623-0.5)+0
 Parameter: ZPOS <- "30.907923"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "30.907923" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "30.907923" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "45.7235261"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 45.7235261-0
 Parameter: XTRAN <- "45.7235261"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "53.3842503"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 53.3842503-0
 Parameter: YTRAN <- "53.3842503"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "30.907923"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 30.907923-0
 Parameter: ZTRAN <- "30.907923"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "45.7235261"
 Parameter: YTRAN -> "53.3842503"
 Parameter: ZTRAN -> "30.907923"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    45.723526   53.384250   30.907923
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.683983173"
Evaluating: 0.683983173*360.0
 Parameter: XPHI <- "246.233942"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.872993951"
Evaluating: 0.872993951*360.0
 Parameter: YPHI <- "314.277822"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.457183937"
Evaluating: 0.457183937*360.0
 Parameter: ZPHI <- "164.586217"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "45.7235261"
 Parameter: YPOS -> "53.3842503"
 Parameter: ZPOS -> "30.907923"
 Parameter: XPHI -> "246.233942"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.403003   -0.915199
    0.000000    0.915199   -0.403003

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  113.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "45.7235261"
 Parameter: YPOS -> "53.3842503"
 Parameter: ZPOS -> "30.907923"
 Parameter: YPHI -> "314.277822"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.698138    0.000000    0.715963
    0.000000    1.000000    0.000000
   -0.715963    0.000000    0.698138

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   45.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "45.7235261"
 Parameter: YPOS -> "53.3842503"
 Parameter: ZPOS -> "30.907923"
 Parameter: ZPHI -> "164.586217"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.964031    0.265788    0.000000
   -0.265788   -0.964031    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  164.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   45.723526 XMAX =   45.723526 XAVE =   45.723526
    YMIN =   53.384250 YMAX =   53.384250 YAVE =   53.384250
    ZMIN =   30.907923 ZMAX =   30.907923 ZAVE =   30.907923
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "45.7235261"
Evaluating: 45.7235261+3.5
 Parameter: XMAX <- "49.2235261"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "53.3842503"
Evaluating: 53.3842503+3.5
 Parameter: YMAX <- "56.8842503"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "30.907923"
Evaluating: 30.907923+3.5
 Parameter: ZMAX <- "34.407923"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "45.7235261"
Evaluating: 45.7235261-3.5
 Parameter: XMIN <- "42.2235261"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "53.3842503"
Evaluating: 53.3842503-3.5
 Parameter: YMIN <- "49.8842503"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "30.907923"
Evaluating: 30.907923-3.5
 Parameter: ZMIN <- "27.407923"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "49.2235261"
 Parameter: XMIN -> "42.2235261"
 Parameter: YMAX -> "56.8842503"
 Parameter: YMIN -> "49.8842503"
 Parameter: ZMAX -> "34.407923"
 Parameter: ZMIN -> "27.407923"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "105"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "105" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "105"
Evaluating: 105
 Parameter: J <- "105"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "105" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "105"
 Parameter: NPOS -> "53"
Evaluating: 105-53
 Parameter: J <- "52"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "52"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.690288036"
Evaluating: 120.112447*(0.690288036-0.5)
 Parameter: XPOS <- "22.8559616"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.109886572"
Evaluating: 120.112447*(0.109886572-0.5)
 Parameter: YPOS <- "-46.8574784"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.23110447"
Evaluating: 85*(0.23110447-0.5)+0
 Parameter: ZPOS <- "-22.8561201"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-22.8561201" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "22.8559616"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 22.8559616-0
 Parameter: XTRAN <- "22.8559616"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-46.8574784"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -46.8574784-0
 Parameter: YTRAN <- "-46.8574784"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-22.8561201"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -22.8561201-0
 Parameter: ZTRAN <- "-22.8561201"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "22.8559616"
 Parameter: YTRAN -> "-46.8574784"
 Parameter: ZTRAN -> "-22.8561201"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    22.855962  -46.857478  -22.856120
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.429261479"
Evaluating: 0.429261479*360.0
 Parameter: XPHI <- "154.534132"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.345259261"
Evaluating: 0.345259261*360.0
 Parameter: YPHI <- "124.293334"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.782735205"
Evaluating: 0.782735205*360.0
 Parameter: ZPHI <- "281.784674"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "22.8559616"
 Parameter: YPOS -> "-46.8574784"
 Parameter: ZPOS -> "-22.8561201"
 Parameter: XPHI -> "154.534132"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.902842    0.429973
    0.000000   -0.429973   -0.902842

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  154.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "22.8559616"
 Parameter: YPOS -> "-46.8574784"
 Parameter: ZPOS -> "-22.8561201"
 Parameter: YPHI -> "124.293334"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.563430    0.000000   -0.826164
    0.000000    1.000000    0.000000
    0.826164    0.000000   -0.563430

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  124.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "22.8559616"
 Parameter: YPOS -> "-46.8574784"
 Parameter: ZPOS -> "-22.8561201"
 Parameter: ZPHI -> "281.784674"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.204234   -0.978922    0.000000
    0.978922    0.204234    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   78.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   22.855962 XMAX =   22.855962 XAVE =   22.855962
    YMIN =  -46.857478 YMAX =  -46.857478 YAVE =  -46.857478
    ZMIN =  -22.856120 ZMAX =  -22.856120 ZAVE =  -22.856120
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "22.8559616"
Evaluating: 22.8559616+3.5
 Parameter: XMAX <- "26.3559616"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-46.8574784"
Evaluating: -46.8574784+3.5
 Parameter: YMAX <- "-43.3574784"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-22.8561201"
Evaluating: -22.8561201+3.5
 Parameter: ZMAX <- "-19.3561201"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "22.8559616"
Evaluating: 22.8559616-3.5
 Parameter: XMIN <- "19.3559616"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-46.8574784"
Evaluating: -46.8574784-3.5
 Parameter: YMIN <- "-50.3574784"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-22.8561201"
Evaluating: -22.8561201-3.5
 Parameter: ZMIN <- "-26.3561201"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "26.3559616"
 Parameter: XMIN -> "19.3559616"
 Parameter: YMAX -> "-43.3574784"
 Parameter: YMIN -> "-50.3574784"
 Parameter: ZMAX -> "-19.3561201"
 Parameter: ZMIN -> "-26.3561201"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "106"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "106" and "106".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "106"
Evaluating: 106
 Parameter: J <- "106"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "106" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "106"
 Parameter: NPOS -> "53"
Evaluating: 106-53
 Parameter: J <- "53"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "53"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "4.745195064E-02"
Evaluating: 120.112447*(4.745195064E-02-0.5)
 Parameter: XPOS <- "-54.3566536"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.263028066"
Evaluating: 120.112447*(0.263028066-0.5)
 Parameter: YPOS <- "-28.4632789"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.38542979"
Evaluating: 85*(0.38542979-0.5)+0
 Parameter: ZPOS <- "-9.73846785"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-9.73846785" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-9.73846785" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "106"
Evaluating: 106
 Parameter: J <- "106"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "106" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "106"
 Parameter: NPOS -> "53"
Evaluating: 106-53
 Parameter: J <- "53"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "53"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.991034132"
Evaluating: 120.112447*(0.991034132-0.5)
 Parameter: XPOS <- "58.9793112"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.869387649"
Evaluating: 120.112447*(0.869387649-0.5)
 Parameter: YPOS <- "44.3680544"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.132455747"
Evaluating: 85*(0.132455747-0.5)+0
 Parameter: ZPOS <- "-31.2412615"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-31.2412615" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "58.9793112"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 58.9793112-0
 Parameter: XTRAN <- "58.9793112"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "44.3680544"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 44.3680544-0
 Parameter: YTRAN <- "44.3680544"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-31.2412615"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -31.2412615-0
 Parameter: ZTRAN <- "-31.2412615"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "58.9793112"
 Parameter: YTRAN -> "44.3680544"
 Parameter: ZTRAN -> "-31.2412615"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR    58.979311   44.368054  -31.241262
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.274903897"
Evaluating: 0.274903897*360.0
 Parameter: XPHI <- "98.9654029"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.353280227"
Evaluating: 0.353280227*360.0
 Parameter: YPHI <- "127.180882"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.658986452"
Evaluating: 0.658986452*360.0
 Parameter: ZPHI <- "237.235123"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "58.9793112"
 Parameter: YPOS -> "44.3680544"
 Parameter: ZPOS -> "-31.2412615"
 Parameter: XPHI -> "98.9654029"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.155838    0.987783
    0.000000   -0.987783   -0.155838

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   98.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "58.9793112"
 Parameter: YPOS -> "44.3680544"
 Parameter: ZPOS -> "-31.2412615"
 Parameter: YPHI -> "127.180882"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.604333    0.000000   -0.796732
    0.000000    1.000000    0.000000
    0.796732    0.000000   -0.604333

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  127.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "58.9793112"
 Parameter: YPOS -> "44.3680544"
 Parameter: ZPOS -> "-31.2412615"
 Parameter: ZPHI -> "237.235123"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.541193   -0.840899    0.000000
    0.840899   -0.541193    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  122.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   58.979311 XMAX =   58.979311 XAVE =   58.979311
    YMIN =   44.368054 YMAX =   44.368054 YAVE =   44.368054
    ZMIN =  -31.241262 ZMAX =  -31.241262 ZAVE =  -31.241262
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "58.9793112"
Evaluating: 58.9793112+3.5
 Parameter: XMAX <- "62.4793112"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "44.3680544"
Evaluating: 44.3680544+3.5
 Parameter: YMAX <- "47.8680544"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-31.2412615"
Evaluating: -31.2412615+3.5
 Parameter: ZMAX <- "-27.7412615"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "58.9793112"
Evaluating: 58.9793112-3.5
 Parameter: XMIN <- "55.4793112"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "44.3680544"
Evaluating: 44.3680544-3.5
 Parameter: YMIN <- "40.8680544"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-31.2412615"
Evaluating: -31.2412615-3.5
 Parameter: ZMIN <- "-34.7412615"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "62.4793112"
 Parameter: XMIN -> "55.4793112"
 Parameter: YMAX -> "47.8680544"
 Parameter: YMIN -> "40.8680544"
 Parameter: ZMAX -> "-27.7412615"
 Parameter: ZMIN -> "-34.7412615"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      1 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
 5602 NEG      CL       53       CL      -5501 POS      NA       5        NA            2.3728
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "106"
Evaluating: 106
 Parameter: J <- "106"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "53"
 Comparing "106" and "53".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "106"
 Parameter: NPOS -> "53"
Evaluating: 106-53
 Parameter: J <- "53"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "53"
 SELRPN>      1 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.476843218"
Evaluating: 120.112447*(0.476843218-0.5)
 Parameter: XPOS <- "-2.78141775"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "120.112447"
 RDCMND substituted energy or value "?RANDOM" to "0.232983464"
Evaluating: 120.112447*(0.232983464-0.5)
 Parameter: YPOS <- "-32.0720095"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.151998917"
Evaluating: 85*(0.151998917-0.5)+0
 Parameter: ZPOS <- "-29.5800921"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-29.5800921" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   58.979311 XMAX =   58.979311 XAVE =   58.979311
    YMIN =   44.368054 YMAX =   44.368054 YAVE =   44.368054
    ZMIN =  -31.241262 ZMAX =  -31.241262 ZAVE =  -31.241262
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-2.78141775"
 RDCMND substituted energy or value "?XAVE" to "58.9793112"
Evaluating: -2.78141775-58.9793112
 Parameter: XTRAN <- "-61.760729"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-32.0720095"
 RDCMND substituted energy or value "?YAVE" to "44.3680544"
Evaluating: -32.0720095-44.3680544
 Parameter: YTRAN <- "-76.4400639"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-29.5800921"
 RDCMND substituted energy or value "?ZAVE" to "-31.2412615"
Evaluating: -29.5800921--31.2412615
 Parameter: ZTRAN <- "1.6611694"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-61.760729"
 Parameter: YTRAN -> "-76.4400639"
 Parameter: ZTRAN -> "1.6611694"
 SELRPN>      1 atoms have been selected out of   5602
 TRANSLATION VECTOR   -61.760729  -76.440064    1.661169
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.368942733"
Evaluating: 0.368942733*360.0
 Parameter: XPHI <- "132.819384"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.27498014E-02"
Evaluating: 4.27498014E-02*360.0
 Parameter: YPHI <- "15.3899285"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.367801119"
Evaluating: 0.367801119*360.0
 Parameter: ZPHI <- "132.408403"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-2.78141775"
 Parameter: YPOS -> "-32.0720095"
 Parameter: ZPOS -> "-29.5800921"
 Parameter: XPHI -> "132.819384"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.679689    0.733500
    0.000000   -0.733500   -0.679689

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  132.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-2.78141775"
 Parameter: YPOS -> "-32.0720095"
 Parameter: ZPOS -> "-29.5800921"
 Parameter: YPHI -> "15.3899285"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
    0.964142    0.000000   -0.265387
    0.000000    1.000000    0.000000
    0.265387    0.000000    0.964142

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   15.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-2.78141775"
 Parameter: YPOS -> "-32.0720095"
 Parameter: ZPOS -> "-29.5800921"
 Parameter: ZPHI -> "132.408403"
 SELRPN>      1 atoms have been selected out of   5602
 ROTATION MATRIX
   -0.674411    0.738356    0.000000
   -0.738356   -0.674411    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  132.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   5602
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -2.781418 XMAX =   -2.781418 XAVE =   -2.781418
    YMIN =  -32.072009 YMAX =  -32.072009 YAVE =  -32.072009
    ZMIN =  -29.580092 ZMAX =  -29.580092 ZAVE =  -29.580092
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-2.78141772"
Evaluating: -2.78141772+3.5
 Parameter: XMAX <- "0.71858228"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-32.0720095"
Evaluating: -32.0720095+3.5
 Parameter: YMAX <- "-28.5720095"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-29.5800921"
Evaluating: -29.5800921+3.5
 Parameter: ZMAX <- "-26.0800921"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-2.78141772"
Evaluating: -2.78141772-3.5
 Parameter: XMIN <- "-6.28141772"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-32.0720095"
Evaluating: -32.0720095-3.5
 Parameter: YMIN <- "-35.5720095"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-29.5800921"
Evaluating: -29.5800921-3.5
 Parameter: ZMIN <- "-33.0800921"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "0.71858228"
 Parameter: XMIN -> "-6.28141772"
 Parameter: YMAX -> "-28.5720095"
 Parameter: YMIN -> "-35.5720095"
 Parameter: ZMAX -> "-26.0800921"
 Parameter: ZMIN -> "-33.0800921"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   5602
 SELRPN>      0 atoms have been selected out of   5602

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "107"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "106"
 Comparing "107" and "106".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>        label continue
  
 CHARMM>     
  
 CHARMM>        CRYSTAL FREE
  
 CHARMM>     
  
 CHARMM>        ! get the number of @pos residues to reorder
  
 CHARMM>        define JUNK sele ( segid IONS .or. LPSION ) .and. resname @pos end
 Parameter: POS -> "NA"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>        set natoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "0"
 Parameter: NATOMS <- "0"
  
 CHARMM>        calc nresi = @natoms / @natompos
 Parameter: NATOMS -> "0"
 Parameter: NATOMPOS -> "1"
Evaluating: 0/1
 Parameter: NRESI <- "0"
  
 CHARMM>        incr npos by @nresi
 Parameter: NRESI -> "0"
 Parameter: NPOS <- "53"
  
 CHARMM>     
  
 CHARMM>        ! join POS to @pos via reordering
  
 CHARMM>        if nresi .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>        ! update LPS selection
  
 CHARMM>        define LPSION sele segid LION .or. segid CION .or. segid OION end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>        ! get the number of @neg residues to reorder
  
 CHARMM>        define JUNK sele ( segid IONS .or. LPSION ) .and. resname @neg end
 Parameter: NEG -> "CL"
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>        set natoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "0"
 Parameter: NATOMS <- "0"
  
 CHARMM>        calc nresi = @natoms / @natomneg
 Parameter: NATOMS -> "0"
 Parameter: NATOMNEG -> "1"
Evaluating: 0/1
 Parameter: NRESI <- "0"
  
 CHARMM>        incr nneg by @nresi
 Parameter: NRESI -> "0"
 Parameter: NNEG <- "53"
  
 CHARMM>     
  
 CHARMM>        ! join NEG to @neg via reordering
  
 CHARMM>        if nresi .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>            ! if POS was reordered, NEG may still need to be reordered
  
 CHARMM>            define POS sele segid POS end
 SELRPN>     53 atoms have been selected out of   5602
  
 CHARMM>            set posat = ?selatom
 RDCMND substituted energy or value "?SELATOM" to "5497"
 Parameter: POSAT <- "5497"
  
 CHARMM>     
  
 CHARMM>            define NEG sele segid NEG end
 SELRPN>     53 atoms have been selected out of   5602
  
 CHARMM>            set negat = ?selatom
 RDCMND substituted energy or value "?SELATOM" to "5550"
 Parameter: NEGAT <- "5550"
  
 CHARMM>     
  
 CHARMM>            if negat .eq. 0 goto skipreorder
 Comparing "5550" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            if posat .gt. @negat then
 Parameter: NEGAT -> "5550"
 Comparing "5497" and "5550".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        label skipreorder
  
 CHARMM>     
  
 CHARMM>        ! update LPS selection
  
 CHARMM>        define LPSION sele segid LION .or. segid CION .or. segid OION end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>     
  
 CHARMM>        !
  
 CHARMM>        ! join everything to IONS segment
  
 CHARMM>        !
  
 CHARMM>        define IONS sele segid IONS end
 SELRPN>      0 atoms have been selected out of   5602
  
 CHARMM>        set nionatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "0"
 Parameter: NIONATOMS <- "0"
  
 CHARMM>     
  
 CHARMM>        define POS sele segid POS end
 SELRPN>     53 atoms have been selected out of   5602
  
 CHARMM>        set nposatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "53"
 Parameter: NPOSATOMS <- "53"
  
 CHARMM>     
  
 CHARMM>        define NEG sele segid NEG end
 SELRPN>     53 atoms have been selected out of   5602
  
 CHARMM>        set nnegatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "53"
 Parameter: NNEGATOMS <- "53"
  
 CHARMM>     
  
 CHARMM>        if nionatoms .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>            rename segid IONS sele segid POS end
 SELRPN>     53 atoms have been selected out of   5602
 SEGMENT 'POS     ' IS RENAMED TO 'IONS    '
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        define IONS sele segid IONS end
 SELRPN>     53 atoms have been selected out of   5602
  
 CHARMM>        set nionatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "53"
 Parameter: NIONATOMS <- "53"
  
 CHARMM>     
  
 CHARMM>        if nionatoms .gt. 0 then
 Comparing "53" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>            if nnegatoms .gt. 0 join IONS NEG renumber
 Comparing "53" and "0".
 IF test evaluated as true.  Performing command
 SEGMENTS "IONS    " AND "NEG     " HAVE BEEN JOINED.
 THE RESIDUE IDENTIFIERS HAVE BEEN RENUMBERED
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        2   Number of residues   =      564
         Number of atoms         =     5602   Number of groups     =      564
         Number of bonds         =     5038   Number of angles     =     3664
         Number of dihedrals     =        0   Number of impropers  =        0
         Number of cross-terms   =        0   Number of autogens   =     3664
         Number of HB acceptors  =        0   Number of HB donors  =        0
         Number of NB exclusions =        0   Total charge =    0.00000
  
 CHARMM>        else
 Skip commands until next ENDIF
  
 CHARMM>     
  
 CHARMM>        incr ionind
 Parameter: IONIND <- "2"
  
 CHARMM>        if ionind le @niontypes goto do_ion
 Parameter: NIONTYPES -> "1"
 Comparing "2" and "1".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    write coor pdb name step4.3_ion.pdb
 VOPEN> Attempting to open::step4.3_ion.pdb::
 RDTITL>  
 RDTITL> No title read.
  Write CHARMM-pdb format
 VCLOSE: Closing unit   90 with status "KEEP"
  
 CHARMM>     
  
 CHARMM>    calc cgtotinit = ?cgtot
 RDCMND substituted energy or value "?CGTOT" to "0"
Evaluating: 0
 Parameter: CGTOTINIT <- "0"
  
 CHARMM>    calc cgtot = int( ?cgtot )
 RDCMND substituted energy or value "?CGTOT" to "0"
Evaluating: INT(0)
 Parameter: CGTOT <- "0"
  
 CHARMM>    if cgtot .ne. 0 stop ! ABNORMAL TERMINATION: failure to neutralize system
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>    calc cgdiff = abs(@cgtot - @cgtotinit)
 Parameter: CGTOT -> "0"
 Parameter: CGTOTINIT -> "0"
Evaluating: ABS(0-0)
 Parameter: CGDIFF <- "0"
  
 CHARMM>    if cgdiff .gt. 0.0001 stop ! ABNORMAL TERMINATION: failure to neutralize system
 Comparing "0" and "0.0001".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    delete atom sele .not. ( segid IONS ) end
 SELRPN>   5496 atoms have been selected out of   5602

 Message from MAPIC: Atom numbers are changed.

 Message from MAPIC:        458 residues deleted.

 Message from MAPIC:          1 segments deleted.
 DELTIC:      5038 bonds deleted
 DELTIC:      3664 angles deleted
 DELTIC:      3664 autogen elements deleted
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        1   Number of residues   =      106
         Number of atoms         =      106   Number of groups     =      106
         Number of bonds         =        0   Number of angles     =        0
         Number of dihedrals     =        0   Number of impropers  =        0
         Number of cross-terms   =        0   Number of autogens   =        0
         Number of HB acceptors  =        0   Number of HB donors  =        0
         Number of NB exclusions =        0   Total charge =    0.00000
  
 CHARMM>     
  
 CHARMM>    bomlev 2 ! force error if no atoms written
  
 CHARMM>     
  
 CHARMM>    write psf  card name step4.3_ion.psf
 VOPEN> Attempting to open::step4.3_ion.psf::
 RDTITL> WRITE COOR CARD NAME STEP4.3_ION.CRD
 RDTITL> No title read.
 VCLOSE: Closing unit   90 with status "KEEP"
 VCLOSE: Closing unit   90 with status "KEEP"
  
 CHARMM>    write coor card name step4.3_ion.crd
 VOPEN> Attempting to open::step4.3_ion.crd::
 RDTITL>  
 RDTITL> No title read.
 VCLOSE: Closing unit   90 with status "KEEP"
 VCLOSE: Closing unit   90 with status "KEEP"
  
 CHARMM>     
  
 CHARMM>    write title card name step4.3_ion.str
 VOPEN> Attempting to open::step4.3_ion.str::
 RDTITL> * SET NIONTYPES = 1
 RDTITL> * SET NPOSTOT = 53
 RDTITL> * SET NNEGTOT = 53
 RDTITL> * SET NIONTOT = 106
 RDTITL> *
 VCLOSE: Closing unit   90 with status "KEEP"
 **** Warning ****  The following extraneous characters
 were found while command processing in CHARMM
 CARD
  
 CHARMM>     
  
 CHARMM>    stop
 VCLOSE: Closing unit   10 with status "KEEP"
 VCLOSE: Closing unit   20 with status "KEEP"
$$$$$$  New timer profile $$$$$
 Total time                      4.71 Other:            0.00

                    NORMAL TERMINATION BY NORMAL STOP
                    NO WARNINGS WERE ISSUED

                    $$$$$ JOB ACCOUNTING INFORMATION $$$$$
                     ELAPSED TIME:     4.71  SECONDS 
                         CPU TIME:     4.70  SECONDS 
